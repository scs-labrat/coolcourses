<h1 id="combined-markdown-files">Combined Markdown Files</h1>
<p>Generated from: nothing-cyber</p>
<h2 id="file-1-course_outline-md">File 1: course_outline.md</h2>
<p>Okay, let&#39;s build a comprehensive &quot;Cyber Threat Hunting 101&quot; course outline, designed to equip learners with the knowledge and skills to transition from reactive security to proactive threat hunting, culminating in a functional clone of the topic. My goal is to make this educational, practical, and fun!</p>
<p><strong>Course Title:</strong> Cyber Threat Hunting 101: From Reactive Defense to Proactive Pursuit</p>
<p><strong>Overall Course Objective:</strong> By the end of this course, learners will be able to create a functional clone of the topic.</p>
<p><strong>Course Prerequisites:</strong></p>
<ul>
<li>Basic understanding of computer networking concepts (TCP/IP, HTTP, DNS).</li>
<li>Familiarity with common security terminology (vulnerabilities, exploits, malware).</li>
<li>Basic Linux command-line experience.</li>
<li>Familiarity with a scripting language like Python (recommended).</li>
</ul>
<p><strong>Course Structure:</strong></p>
<p>The course will consist of eight modules, each building upon the previous one, to provide a solid foundation in cyber threat hunting principles and practices.</p>
<p><strong>Module 1: The Need for Proactive Security</strong></p>
<ul>
<li><strong>Module Objective:</strong> Understand the limitations of reactive security and the rationale for adopting a proactive threat hunting approach.</li>
<li><strong>Subtopics:</strong><ul>
<li>The Swiss Cheese Model in cybersecurity: Understanding layered defenses and their inherent gaps.</li>
<li>The concept of &quot;Scope X&quot; (unknown unknowns) and its impact on security posture.</li>
<li>The &quot;Security, Usability, and Cost&quot; triangle: Balancing trade-offs in security implementations.</li>
<li>Reactive vs. Proactive Security: Comparing and contrasting approaches.</li>
<li>A brief overview of proactive cybersecurity methods: vulnerability assessments, penetration testing, red teaming, bug bounties, and threat hunting.</li>
<li>Why threat hunting is crucial in a modern threat landscape.</li>
<li>The importance of a holistic approach: people, processes, and technology.</li>
<li>Case Study: A major breach that could have been prevented by threat hunting.</li>
</ul>
</li>
<li><strong>Suggested Resources/Prerequisites:</strong><ul>
<li>Read articles on the Swiss Cheese Model in cybersecurity.</li>
<li>Research examples of major breaches caused by unknown vulnerabilities.</li>
<li>Review the basics of common defensive cybersecurity tools (firewalls, IDS/IPS).</li>
</ul>
</li>
<li><strong>Module Project/Exercise:</strong><ul>
<li><strong>Gap Analysis:</strong> Students will be given a hypothetical security scenario (e.g., a small company network) and asked to identify potential gaps in their reactive defenses based on the Swiss Cheese Model. They will then propose proactive measures to address these gaps.</li>
<li><strong>Capstone Project Contribution:</strong> Students will write a brief section for their final report describing the limitations of reactive security and the need for threat hunting.</li>
</ul>
</li>
</ul>
<p><strong>Module 2: Foundations of Cyber Threat Hunting</strong></p>
<ul>
<li><strong>Module Objective:</strong>  Grasp the core principles, methodologies, and key enablers of effective threat hunting.</li>
<li><strong>Subtopics:</strong><ul>
<li>Defining Cyber Threat Hunting: A clear definition and scope.</li>
<li>Core Principles of Threat Hunting:<ul>
<li>Understanding historical threats.</li>
<li>Analyzing current threats.</li>
<li>Predicting potential future threats.</li>
</ul>
</li>
<li>The Threat Hunting Loop: Plan, Hunt, Analyze, Report, Improve.</li>
<li>The Pyramid of Pain: Categorizing indicators and observables (IoCs) to maximize impact.</li>
<li>Key Enablers for Successful Threat Hunting:<ul>
<li>Total Visibility: Access to relevant data sources.</li>
<li>Data Quality and Availability: Ensuring reliable and accessible data.</li>
<li>Situational Awareness: Understanding the environment and context.</li>
</ul>
</li>
<li>Threat Intelligence: Leveraging threat intelligence feeds.</li>
<li>Introduction to Threat Modeling: Understanding attack vectors and potential targets.</li>
</ul>
</li>
<li><strong>Suggested Resources/Prerequisites:</strong><ul>
<li>Read articles on the Threat Hunting Loop and the Pyramid of Pain.</li>
<li>Explore open-source threat intelligence feeds (e.g., VirusTotal).</li>
<li>Review the MITRE ATT&amp;CK framework.</li>
</ul>
</li>
<li><strong>Module Project/Exercise:</strong><ul>
<li><strong>Pyramid of Pain Exercise:</strong> Students will be given a list of IoCs (IP addresses, domain names, file hashes, etc.) and asked to categorize them according to the Pyramid of Pain.</li>
<li><strong>Capstone Project Contribution:</strong> Students will write a section on the core principles of threat hunting and the importance of each element of the Pyramid of Pain.</li>
</ul>
</li>
</ul>
<p><strong>Module 3: Essential Cyber Security Skills for Threat Hunters</strong></p>
<ul>
<li><strong>Module Objective:</strong> Identify and develop the crucial technical skills required for effective threat hunting.</li>
<li><strong>Subtopics:</strong><ul>
<li>Core Security Skill Set:<ul>
<li>Network Security Fundamentals: Packet analysis, network protocols.</li>
<li>Endpoint Security: Understanding endpoint behavior, process monitoring.</li>
<li>Malware Analysis Basics: Identifying malicious code, reverse engineering basics.</li>
<li>Log Analysis: Interpreting security logs from various sources.</li>
</ul>
</li>
<li>Visualization and Analysis:<ul>
<li>Data Visualization Techniques: Using graphs and charts to identify anomalies.</li>
<li>Analytical Thinking: Developing hypotheses and testing them against data.</li>
</ul>
</li>
<li>Scripting and Task Automation:<ul>
<li>Python for Security: Automating tasks, parsing data, interacting with APIs.</li>
<li>Shell Scripting: Automating command-line tasks.</li>
</ul>
</li>
<li>Understanding of Operating Systems: Windows and Linux internals.</li>
</ul>
</li>
<li><strong>Suggested Resources/Prerequisites:</strong><ul>
<li>Practice network packet analysis using Wireshark.</li>
<li>Learn basic Python scripting.</li>
<li>Explore common security logs (e.g., Windows Event Logs, Linux Syslog).</li>
</ul>
</li>
<li><strong>Module Project/Exercise:</strong><ul>
<li><strong>Log Analysis Challenge:</strong> Students will be given a set of security logs (e.g., web server logs, firewall logs) and asked to identify suspicious activity.</li>
<li><strong>Scripting Exercise:</strong> Students will write a Python script to automate the analysis of a specific type of security log.</li>
<li><strong>Capstone Project Contribution:</strong> Students will include a section on the essential skills for threat hunters, explaining why each skill is important.</li>
</ul>
</li>
</ul>
<p><strong>Module 4: Threat Hunting Tools and Techniques (Part 1: Network)</strong></p>
<ul>
<li><strong>Module Objective:</strong> Learn to leverage network-based tools and techniques for detecting malicious activity.</li>
<li><strong>Subtopics:</strong><ul>
<li>Network Intrusion Detection Systems (NIDS):<ul>
<li>Snort/Suricata: Rule writing, alert analysis.</li>
</ul>
</li>
<li>Network Traffic Analysis (NTA):<ul>
<li>Wireshark: Advanced filtering, protocol analysis.</li>
<li>Zeek (Bro): Event logging, scripting for custom analysis.</li>
</ul>
</li>
<li>NetFlow Analysis:<ul>
<li>Understanding NetFlow data.</li>
<li>Tools for NetFlow collection and analysis.</li>
</ul>
</li>
<li>DNS Analysis:<ul>
<li>Identifying malicious domain names.</li>
<li>DNS tunneling detection.</li>
</ul>
</li>
<li>Practical Exercises:<ul>
<li>Analyzing network traffic for suspicious patterns.</li>
<li>Writing Snort rules to detect specific threats.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Suggested Resources/Prerequisites:</strong><ul>
<li>Install and configure Snort or Suricata.</li>
<li>Practice using Wireshark to analyze network traffic.</li>
<li>Explore Zeek documentation.</li>
</ul>
</li>
<li><strong>Module Project/Exercise:</strong><ul>
<li><strong>Network Forensics Challenge:</strong> Students will be given a PCAP file and asked to identify malicious activity using network analysis tools.</li>
<li><strong>Capstone Project Contribution:</strong> Students will document how to use network-based tools to detect threats.</li>
</ul>
</li>
</ul>
<p><strong>Module 5: Threat Hunting Tools and Techniques (Part 2: Endpoint &amp; Logs)</strong></p>
<ul>
<li><strong>Module Objective:</strong> Learn to leverage endpoint-based tools and techniques for detecting malicious activity.</li>
<li><strong>Subtopics:</strong><ul>
<li>Endpoint Detection and Response (EDR) Solutions:<ul>
<li>Overview of EDR capabilities.</li>
<li>Using EDR tools for threat hunting.</li>
</ul>
</li>
<li>Sysmon:<ul>
<li>Configuring Sysmon for detailed logging.</li>
<li>Analyzing Sysmon logs for suspicious activity.</li>
</ul>
</li>
<li>Windows Event Logs:<ul>
<li>Understanding Windows Event Log structure.</li>
<li>Using PowerShell for Event Log analysis.</li>
</ul>
</li>
<li>Linux Audit Logs:<ul>
<li>Configuring auditd.</li>
<li>Analyzing audit logs for suspicious activity.</li>
</ul>
</li>
<li>SIEM (Security Information and Event Management) Systems:<ul>
<li>Overview of SIEM architecture.</li>
<li>Using SIEM for threat hunting.</li>
</ul>
</li>
<li>Practical Exercises:<ul>
<li>Analyzing Sysmon logs to detect malware execution.</li>
<li>Using PowerShell to query Windows Event Logs.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Suggested Resources/Prerequisites:</strong><ul>
<li>Install and configure Sysmon on a Windows system.</li>
<li>Explore Windows Event Log documentation.</li>
<li>Learn basic PowerShell scripting.</li>
</ul>
</li>
<li><strong>Module Project/Exercise:</strong><ul>
<li><strong>Endpoint Forensics Challenge:</strong> Students will be given a disk image and asked to identify malicious activity using endpoint analysis tools.</li>
<li><strong>Capstone Project Contribution:</strong> Students will document how to use endpoint-based tools to detect threats.</li>
</ul>
</li>
</ul>
<p><strong>Module 6: Data Analysis Techniques for Threat Hunting</strong></p>
<ul>
<li><strong>Module Objective:</strong> Master essential data analysis techniques for identifying and understanding threats.</li>
<li><strong>Subtopics:</strong><ul>
<li>Basic Search and Filtering:<ul>
<li>Using search operators and filters in various tools.</li>
</ul>
</li>
<li>Grouping and Counting:<ul>
<li>Identifying patterns and trends.</li>
</ul>
</li>
<li>Link Analysis:<ul>
<li>Visualizing relationships between entities.</li>
</ul>
</li>
<li>Hunting and Query Languages (e.g., KQL in Azure Sentinel, SPL in Splunk):<ul>
<li>Writing efficient queries for threat hunting.</li>
</ul>
</li>
<li>Pattern Matching:<ul>
<li>Using regular expressions to identify malicious patterns.</li>
</ul>
</li>
<li>Timelines:<ul>
<li>Creating timelines of events to understand attack sequences.</li>
</ul>
</li>
<li>Statistical Metrics:<ul>
<li>Calculating averages, standard deviations, and other metrics to identify anomalies.</li>
</ul>
</li>
<li>Data Aggregation:<ul>
<li>Combining data from multiple sources to gain a holistic view.</li>
</ul>
</li>
<li>Frequency Analysis:<ul>
<li>Identifying unusual frequencies of events.</li>
</ul>
</li>
<li>Distribution Analysis:<ul>
<li>Understanding the distribution of data to identify outliers.</li>
</ul>
</li>
<li>Practical Exercises:<ul>
<li>Analyzing data using various techniques to identify suspicious activity.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Suggested Resources/Prerequisites:</strong><ul>
<li>Learn the basics of regular expressions.</li>
<li>Explore query languages like KQL or SPL.</li>
<li>Practice using data analysis tools like Pandas (Python).</li>
</ul>
</li>
<li><strong>Module Project/Exercise:</strong><ul>
<li><strong>Data Analysis Challenge:</strong> Students will be given a dataset and asked to identify malicious activity using data analysis techniques.</li>
<li><strong>Capstone Project Contribution:</strong> Students will document how to use data analysis techniques for threat hunting.</li>
</ul>
</li>
</ul>
<p><strong>Module 7: Building Threat Hunting Scenarios and Hypothesis</strong></p>
<ul>
<li><strong>Module Objective:</strong> Learn to develop and test threat hunting scenarios based on threat intelligence and internal data.</li>
<li><strong>Subtopics:</strong><ul>
<li>Understanding Threat Actors and Their Tactics, Techniques, and Procedures (TTPs).</li>
<li>Developing Threat Hunting Hypotheses:<ul>
<li>Based on threat intelligence.</li>
<li>Based on internal data.</li>
</ul>
</li>
<li>Testing Hypotheses:<ul>
<li>Using data analysis techniques to validate or reject hypotheses.</li>
</ul>
</li>
<li>Documenting Threat Hunting Scenarios:<ul>
<li>Creating clear and concise documentation.</li>
</ul>
</li>
<li>Creating Threat Hunting Playbooks:<ul>
<li>Documenting the steps to take when a threat is detected.</li>
</ul>
</li>
<li>Real-World Threat Hunting Scenarios:<ul>
<li>Examples of common threat hunting scenarios.</li>
</ul>
</li>
<li>Case studies of successful threat hunts.</li>
</ul>
</li>
<li><strong>Suggested Resources/Prerequisites:</strong><ul>
<li>Review the MITRE ATT&amp;CK framework.</li>
<li>Explore threat intelligence reports from various security vendors.</li>
</ul>
</li>
<li><strong>Module Project/Exercise:</strong><ul>
<li><strong>Threat Hunting Scenario Development:</strong> Students will be given a threat intelligence report and asked to develop a threat hunting scenario.</li>
<li><strong>Capstone Project Contribution:</strong> Students will document their threat hunting scenarios and playbooks.</li>
</ul>
</li>
</ul>
<p><strong>Module 8: Capstone Project: Building Your Own Cyber Threat Hunting 101</strong></p>
<ul>
<li><strong>Module Objective:</strong> Integrate all learned knowledge and skills to create a functional clone of the course topic.</li>
<li><strong>Subtopics:</strong><ul>
<li>Review of all previous modules.</li>
<li>Planning the project:<ul>
<li>Defining the scope of the project.</li>
<li>Choosing the tools and techniques to use.</li>
</ul>
</li>
<li>Implementing the project:<ul>
<li>Writing code.</li>
<li>Configuring tools.</li>
<li>Analyzing data.</li>
</ul>
</li>
<li>Testing the project:<ul>
<li>Validating the results.</li>
</ul>
</li>
<li>Documenting the project:<ul>
<li>Creating a comprehensive report.</li>
</ul>
</li>
<li>Peer Review:<ul>
<li>Reviewing each other&#39;s projects.</li>
</ul>
</li>
<li>Presentation:<ul>
<li>Presenting the final project.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Suggested Resources/Prerequisites:</strong><ul>
<li>All previous modules.</li>
</ul>
</li>
<li><strong>Module Project/Exercise:</strong><ul>
<li><strong>Capstone Project:</strong> Students will create a functional clone of the course topic. This could involve:<ul>
<li>Building a threat hunting dashboard.</li>
<li>Creating a threat hunting playbook.</li>
<li>Developing a threat hunting tool.</li>
<li>Writing a report on a specific threat.</li>
</ul>
</li>
<li><strong>Capstone Project Deliverables:</strong><ul>
<li>Code.</li>
<li>Configuration files.</li>
<li>Documentation.</li>
<li>Presentation.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>This comprehensive outline provides a clear path for learners to acquire the necessary knowledge and skills to become effective cyber threat hunters. Each module builds upon the previous one, ensuring a solid foundation and culminating in a practical capstone project that demonstrates their mastery of the subject. I&#39;ve tried to inject my love for teaching and open sharing into the structure, making it engaging and accessible. Let me know if you&#39;d like me to elaborate on any specific module or aspect of the course!</p>
<h2 id="file-2-module_1-md">File 2: module_1.md</h2>
<p>Okay, let&#39;s dive into Module 1: &quot;The Need for Proactive Security&quot; with a hyper-detailed, step-by-step approach, designed to be engaging and practical.</p>
<p><strong>Module 1: The Need for Proactive Security</strong></p>
<p><strong>Module Objective:</strong> Understand the limitations of reactive security and the rationale for adopting a proactive threat hunting approach.</p>
<p><strong>1.1 The Swiss Cheese Model in Cybersecurity: Understanding Layered Defenses and Their Inherent Gaps</strong></p>
<ul>
<li><strong>Concept:</strong> Explain the Swiss Cheese Model.  Imagine multiple slices of Swiss cheese stacked together. Each slice represents a security control or layer.  Each slice has holes. If the holes align across all slices, a threat can pass through.</li>
<li><strong>Why it matters:</strong> No single security control is perfect.  Even with multiple layers, vulnerabilities exist.  Reactive security relies on these layers <em>working perfectly</em>, which they rarely do.</li>
<li><strong>Example:</strong><ul>
<li><strong>Layer 1: Firewall:</strong> Might block common port scans but miss sophisticated evasion techniques.</li>
<li><strong>Layer 2: Intrusion Detection System (IDS):</strong> Might detect known malware signatures but fail to identify zero-day exploits or custom malware.</li>
<li><strong>Layer 3: Antivirus Software:</strong>  Might catch some malware but be bypassed by fileless attacks or polymorphic malware.</li>
</ul>
</li>
<li><strong>Practical Illustration:</strong> Draw (or find a diagram online) of the Swiss Cheese Model.  Annotate it with example security controls and potential weaknesses.</li>
</ul>
<p><strong>1.2 The Concept of &quot;Scope X&quot; (Unknown Unknowns) and its Impact on Security Posture</strong></p>
<ul>
<li><strong>Concept:</strong> &quot;Scope X&quot; refers to the things you <em>don&#39;t know that you don&#39;t know.</em>  These are the blind spots in your security visibility.  They represent vulnerabilities, attack vectors, or threats you haven&#39;t even considered.</li>
<li><strong>Why it matters:</strong> Reactive security is inherently limited by what you <em>already know</em>.  You can&#39;t defend against what you can&#39;t see.  Scope X is where the most dangerous and successful attacks originate.</li>
<li><strong>Examples:</strong><ul>
<li>A zero-day vulnerability in a widely used library.</li>
<li>A misconfiguration in a cloud environment that exposes sensitive data.</li>
<li>A sophisticated supply chain attack that compromises trusted software.</li>
</ul>
</li>
<li><strong>Practical Illustration:</strong> Think of a dark room.  You can only react to what you can see with a flashlight (your known security measures). Scope X is everything in the darkness beyond the flashlight&#39;s beam.</li>
</ul>
<p><strong>1.3 The &quot;Security, Usability, and Cost&quot; Triangle: Balancing Trade-offs in Security Implementations</strong></p>
<ul>
<li><strong>Concept:</strong> Security, usability, and cost are often competing factors.  Increasing one can negatively impact the others.  For example, implementing very strict security policies might make systems difficult to use and require expensive resources to maintain.</li>
<li><strong>Why it matters:</strong> Effective security requires finding the right balance.  It&#39;s not about achieving 100% security (which is impossible) but about mitigating risk to an acceptable level while maintaining usability and cost-effectiveness.</li>
<li><strong>Examples:</strong><ul>
<li><strong>High Security, Low Usability, High Cost:</strong> Multi-factor authentication (MFA) with complex passwords and biometric verification.  Highly secure, but potentially inconvenient and expensive to implement and manage.</li>
<li><strong>Low Security, High Usability, Low Cost:</strong>  Simple password policies and minimal security controls.  Easy to use and inexpensive, but highly vulnerable to attacks.</li>
</ul>
</li>
<li><strong>Practical Illustration:</strong> Draw a triangle with Security, Usability, and Cost at each vertex.  Explain how moving closer to one vertex pulls you further away from the others.</li>
</ul>
<p><strong>1.4 Reactive vs. Proactive Security: Comparing and Contrasting Approaches</strong></p>
<ul>
<li><strong>Reactive Security:</strong><ul>
<li><strong>Definition:</strong> Responding to security incidents <em>after</em> they occur.</li>
<li><strong>Focus:</strong> Detection, containment, and remediation.</li>
<li><strong>Tools:</strong> Firewalls, IDS/IPS, antivirus software, SIEM.</li>
<li><strong>Limitations:</strong>  Limited visibility into unknown threats, reliance on pre-defined signatures and rules, slow response times.</li>
<li><strong>Analogy:</strong>  The ambulance waiting for an accident to happen.</li>
</ul>
</li>
<li><strong>Proactive Security:</strong><ul>
<li><strong>Definition:</strong>  Identifying and mitigating security risks <em>before</em> they are exploited.</li>
<li><strong>Focus:</strong> Prevention, detection of anomalies, and hunting for threats.</li>
<li><strong>Tools:</strong> Vulnerability scanners, penetration testing tools, threat intelligence platforms, endpoint detection and response (EDR), user and entity behavior analytics (UEBA).</li>
<li><strong>Limitations:</strong>  Requires specialized skills and resources, can generate false positives, may not be able to prevent all attacks.</li>
<li><strong>Analogy:</strong>  The safety inspector proactively identifying and fixing hazards.</li>
</ul>
</li>
<li><strong>Comparison Table:</strong>
| Feature       | Reactive Security        | Proactive Security           |
|---------------|--------------------------|-----------------------------|
| <strong>Focus</strong>     | Response               | Prevention &amp; Hunting        |
| <strong>Timing</strong>    | After incident          | Before incident            |
| <strong>Visibility</strong>| Known threats           | Unknown &amp; Emerging threats |
| <strong>Approach</strong>  | Rule-based, Signature  | Anomaly-based, Heuristic   |</li>
<li><p><strong>Code example (Python - simple log parsing for reactive detection):</strong></p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> re

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">detect_failed_login</span><span class="hljs-params">(log_file)</span>:</span>
    <span class="hljs-string">"""
    Parses a log file and detects failed login attempts based on a regex.
    This is a basic example of REACTION to a log event.
    """</span>
    failed_login_pattern = re.compile(<span class="hljs-string">r"Failed login for user .* from .*"</span>)
    <span class="hljs-keyword">with</span> open(log_file, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:
        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:
            <span class="hljs-keyword">if</span> failed_login_pattern.search(line):
                print(f<span class="hljs-string">"ALERT: Possible brute-force attack detected in line: {line.strip()}"</span>)

<span class="hljs-comment"># Example usage:</span>
detect_failed_login(<span class="hljs-string">"auth.log"</span>)  <span class="hljs-comment"># Replace with your actual log file</span>
</code></pre>
</li>
</ul>
<p><strong>1.5 A Brief Overview of Proactive Cybersecurity Methods</strong></p>
<ul>
<li><strong>Vulnerability Assessments:</strong> Identifying known vulnerabilities in systems and applications.</li>
<li><strong>Penetration Testing (Ethical Hacking):</strong> Simulating real-world attacks to identify security weaknesses.</li>
<li><strong>Red Teaming:</strong>  A more comprehensive and realistic simulation of an advanced persistent threat (APT).</li>
<li><strong>Bug Bounties:</strong>  Offering rewards to external researchers for finding and reporting vulnerabilities.</li>
<li><strong>Threat Hunting:</strong>  Proactively searching for malicious activity that has bypassed existing security controls.</li>
<li><strong>User and Entity Behavior Analytics (UEBA):</strong>  Analyzing user and system behavior to detect anomalies that may indicate malicious activity.</li>
<li><strong>Threat Intelligence:</strong>  Gathering and analyzing information about threats and threat actors to improve security posture.</li>
</ul>
<p><strong>1.6 Why Threat Hunting is Crucial in a Modern Threat Landscape</strong></p>
<ul>
<li><strong>Advanced Threats:</strong> Modern attacks are increasingly sophisticated and can evade traditional security controls.</li>
<li><strong>Evolving Attack Surfaces:</strong>  The attack surface is constantly expanding with the adoption of cloud computing, IoT devices, and mobile devices.</li>
<li><strong>Insider Threats:</strong> Malicious or negligent insiders can pose a significant risk.</li>
<li><strong>Zero-Day Exploits:</strong>  Attacks that exploit vulnerabilities before they are known to the vendor.</li>
<li><strong>Compliance Requirements:</strong> Many regulations require organizations to implement proactive security measures.</li>
<li><strong>Proactive Approach:</strong> Threat hunting provides a proactive approach to security, allowing organizations to identify and mitigate threats before they cause damage.</li>
</ul>
<p><strong>1.7 The Importance of a Holistic Approach: People, Processes, and Technology</strong></p>
<ul>
<li><strong>People:</strong> Skilled security professionals are essential for effective threat hunting.  This includes training, awareness programs, and a strong security culture.</li>
<li><strong>Processes:</strong> Well-defined processes are needed for threat hunting, incident response, and vulnerability management. This includes clear roles and responsibilities, escalation procedures, and communication plans.</li>
<li><strong>Technology:</strong> The right tools and technologies are needed to collect, analyze, and visualize security data. This includes SIEM systems, EDR solutions, threat intelligence platforms, and network traffic analysis tools.</li>
<li><strong>Interdependence:</strong> These three elements are interdependent.  Even the best technology is useless without skilled people and well-defined processes.</li>
</ul>
<p><strong>1.8 Case Study: A Major Breach that Could Have Been Prevented by Threat Hunting</strong></p>
<ul>
<li><strong>Choose a well-documented breach:</strong> (e.g., Target, Equifax, SolarWinds).</li>
<li><strong>Analyze the attack:</strong><ul>
<li>How did the attackers gain access?</li>
<li>What vulnerabilities did they exploit?</li>
<li>What indicators of compromise (IoCs) were present?</li>
<li>How long did the attackers remain undetected?</li>
</ul>
</li>
<li><strong>Explain how threat hunting could have prevented the breach:</strong><ul>
<li>What proactive measures could have been taken to identify the attackers earlier?</li>
<li>What data sources could have been used to detect the attack?</li>
<li>What threat hunting scenarios could have been developed to identify the attackers&#39; TTPs?</li>
</ul>
</li>
</ul>
<p><strong>Module 1: Suggested Resources/Prerequisites:</strong></p>
<ul>
<li><strong>Read articles on the Swiss Cheese Model in cybersecurity:</strong> Search for &quot;Swiss Cheese Model Cybersecurity&quot; on Google Scholar or security blogs.</li>
<li><strong>Research examples of major breaches caused by unknown vulnerabilities:</strong>  Read security reports from Verizon, Mandiant, CrowdStrike, etc.</li>
<li><strong>Review the basics of common defensive cybersecurity tools (firewalls, IDS/IPS):</strong>  Online documentation, vendor websites.</li>
</ul>
<p><strong>Module 1: Module Project/Exercise:</strong></p>
<ul>
<li><strong>Gap Analysis:</strong><ul>
<li><strong>Scenario:</strong>  A small law firm with 50 employees, a Windows-based network, and basic firewall and antivirus protection.  They handle sensitive client data.</li>
<li><strong>Task:</strong> Identify potential gaps in their reactive defenses based on the Swiss Cheese Model.  Propose proactive measures to address these gaps.  (e.g., &quot;The firewall might not detect data exfiltration over encrypted channels.  Implement network traffic analysis to identify anomalous traffic patterns.&quot;)</li>
</ul>
</li>
<li><strong>Capstone Project Contribution:</strong><ul>
<li>Write a brief section (1-2 paragraphs) for your final report describing the limitations of reactive security and the need for threat hunting.  Emphasize Scope X and the Security, Usability, and Cost trade-offs.</li>
</ul>
</li>
</ul>
<p>This detailed breakdown provides a solid foundation for understanding the need for proactive security and sets the stage for the rest of the course. Each section includes clear explanations, practical examples, and hands-on exercises. This way, students learn not just the theory but also the practical implications.</p>
<h2 id="file-3-module_2-md">File 3: module_2.md</h2>
<p>Okay, let&#39;s dive deep into Module 2: Foundations of Cyber Threat Hunting.  I&#39;ll provide you with a comprehensive, step-by-step breakdown, including explanations, examples, and practical exercises, all formatted in Markdown. My goal is to make this module truly <em>understandable</em> and <em>actionable</em>.</p>
<p><strong>Module 2: Foundations of Cyber Threat Hunting</strong></p>
<p><strong>Module Objective:</strong> Grasp the core principles, methodologies, and key enablers of effective threat hunting.</p>
<p><strong>Subtopics:</strong></p>
<ul>
<li>Defining Cyber Threat Hunting: A clear definition and scope.</li>
<li>Core Principles of Threat Hunting:<ul>
<li>Understanding historical threats.</li>
<li>Analyzing current threats.</li>
<li>Predicting potential future threats.</li>
</ul>
</li>
<li>The Threat Hunting Loop: Plan, Hunt, Analyze, Report, Improve.</li>
<li>The Pyramid of Pain: Categorizing indicators and observables (IoCs) to maximize impact.</li>
<li>Key Enablers for Successful Threat Hunting:<ul>
<li>Total Visibility: Access to relevant data sources.</li>
<li>Data Quality and Availability: Ensuring reliable and accessible data.</li>
<li>Situational Awareness: Understanding the environment and context.</li>
</ul>
</li>
<li>Threat Intelligence: Leveraging threat intelligence feeds.</li>
<li>Introduction to Threat Modeling: Understanding attack vectors and potential targets.</li>
</ul>
<hr>
<p><strong>1. Defining Cyber Threat Hunting: A Clear Definition and Scope</strong></p>
<ul>
<li><p><strong>Explanation:</strong> Cyber threat hunting is a <em>proactive</em> security activity that involves actively searching for threats that have evaded existing security controls.  It&#39;s not just about responding to alerts; it&#39;s about <em>actively seeking out</em> malicious activity that might otherwise go unnoticed. It is an iterative process.</p>
</li>
<li><p><strong>Key Characteristics:</strong></p>
<ul>
<li><strong>Proactive:</strong> Initiated by the hunter, not by an alert.</li>
<li><strong>Hypothesis-Driven:</strong> Starts with a question or suspicion.</li>
<li><strong>Iterative:</strong> Refines the hunt based on findings.</li>
<li><strong>Human-Led:</strong> Relies on the skills and intuition of the hunter.</li>
<li><strong>Data-Driven:</strong> Leverages data from various sources.</li>
</ul>
</li>
<li><strong>Scope:</strong> Threat hunting can encompass various areas, including:<ul>
<li><strong>Network:</strong> Analyzing network traffic for anomalies.</li>
<li><strong>Endpoints:</strong> Examining endpoint behavior for suspicious activity.</li>
<li><strong>Logs:</strong> Searching logs for indicators of compromise.</li>
<li><strong>Cloud:</strong> Investigating cloud infrastructure for security threats.</li>
</ul>
</li>
<li><strong>Contrast with Incident Response:</strong> Incident response is <em>reactive</em>. It&#39;s triggered by an alert or incident. Threat hunting is <em>proactive</em> and seeks to identify threats <em>before</em> they cause damage or trigger alerts.</li>
</ul>
<p><strong>2. Core Principles of Threat Hunting</strong></p>
<ul>
<li><p><strong>Explanation:</strong>  Effective threat hunting requires understanding the threat landscape, both past, present, and potential future threats.</p>
<ul>
<li><strong>Understanding Historical Threats:</strong><ul>
<li><strong>Why:</strong>  Knowing past attacks helps identify patterns and anticipate future attacks.</li>
<li><strong>How:</strong> Review historical security reports, incident reports, and threat intelligence.</li>
<li><strong>Example:</strong> If you know that a particular ransomware group targeted your industry last year, you can proactively hunt for their specific tactics and tools in your network.</li>
</ul>
</li>
<li><strong>Analyzing Current Threats:</strong><ul>
<li><strong>Why:</strong> Staying up-to-date on current threats allows you to hunt for the latest malware, exploits, and attack techniques.</li>
<li><strong>How:</strong> Monitor threat intelligence feeds, security blogs, and vulnerability databases.</li>
<li><strong>Example:</strong> If a new zero-day vulnerability is announced, you can immediately hunt for exploitation attempts in your environment.</li>
</ul>
</li>
<li><strong>Predicting Potential Future Threats:</strong><ul>
<li><strong>Why:</strong>  Anticipating future attacks allows you to prepare your defenses and proactively hunt for vulnerabilities.</li>
<li><strong>How:</strong>  Analyze trends in the threat landscape, conduct threat modeling, and monitor emerging technologies.</li>
<li><strong>Example:</strong> If you see a growing trend of attacks targeting cloud infrastructure, you can proactively hunt for misconfigurations and vulnerabilities in your cloud environment.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>3. The Threat Hunting Loop: Plan, Hunt, Analyze, Report, Improve</strong></p>
<ul>
<li><strong>Explanation:</strong> The threat hunting loop is an iterative process that guides the threat hunting activity.</li>
<li><p><strong>Steps:</strong></p>
<ol>
<li><strong>Plan:</strong><ul>
<li><strong>Define the scope:</strong> What are you trying to find?</li>
<li><strong>Formulate a hypothesis:</strong> What do you suspect is happening?  (e.g., &quot;A user&#39;s machine is beaconing to a known command-and-control server.&quot;)</li>
<li><strong>Identify data sources:</strong> Where will you look for evidence? (e.g., firewall logs, endpoint logs, network traffic).</li>
<li><strong>Select tools:</strong> What tools will you use to analyze the data? (e.g., Wireshark, Splunk, PowerShell).</li>
</ul>
</li>
<li><strong>Hunt:</strong><ul>
<li><strong>Collect data:</strong> Gather the relevant data from your chosen sources.</li>
<li><strong>Analyze data:</strong> Use your selected tools to analyze the data for evidence of your hypothesis.</li>
</ul>
</li>
<li><strong>Analyze:</strong><ul>
<li><strong>Evaluate findings:</strong> Did you find evidence to support your hypothesis?</li>
<li><strong>Investigate further:</strong> If you found something suspicious, investigate further to determine the impact and scope.</li>
<li><strong>Refine your hypothesis:</strong> Based on your findings, refine your hypothesis and continue hunting.</li>
</ul>
</li>
<li><strong>Report:</strong><ul>
<li><strong>Document your findings:</strong> Create a detailed report of your findings, including the evidence you found, the impact of the threat, and any actions taken.</li>
<li><strong>Share your findings:</strong> Share your findings with other security teams and stakeholders.</li>
</ul>
</li>
<li><strong>Improve:</strong><ul>
<li><strong>Review your process:</strong> What worked well? What could be improved?</li>
<li><strong>Update your security controls:</strong> Based on your findings, update your security controls to prevent future attacks.</li>
<li><strong>Share lessons learned:</strong> Share your lessons learned with other security teams and stakeholders.</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>Example:</strong></p>
<ul>
<li><strong>Plan:</strong> Hypothesis: &quot;A new phishing campaign is targeting our users.&quot; Data sources: Email gateway logs, endpoint logs. Tools: Splunk, PowerShell.</li>
<li><strong>Hunt:</strong> Collect email gateway logs and endpoint logs. Analyze the logs for suspicious email attachments or links.</li>
<li><strong>Analyze:</strong> Found several users who clicked on a malicious link. The link downloaded a malware payload.</li>
<li><strong>Report:</strong> Documented the phishing campaign, the malware payload, and the affected users. Shared the findings with the incident response team.</li>
<li><strong>Improve:</strong> Updated email gateway filters to block the malicious links. Trained users on how to identify phishing emails.</li>
</ul>
</li>
</ul>
<p><strong>4. The Pyramid of Pain: Categorizing Indicators and Observables (IoCs) to Maximize Impact</strong></p>
<ul>
<li><strong>Explanation:</strong> The Pyramid of Pain, developed by David Bianco, is a framework for categorizing indicators of compromise (IoCs) based on how much effort it takes for an attacker to change them. The higher up the pyramid you go, the more difficult and costly it is for the attacker to adapt.  The goal is to focus on indicators that cause the most pain for the attacker.</li>
<li><p><strong>Levels (from bottom to top):</strong></p>
<ol>
<li><strong>Hash Values:</strong> (MD5, SHA1, SHA256)  Easiest for attackers to change.</li>
<li><strong>IP Addresses:</strong> Relatively easy for attackers to change (using new servers, VPNs, etc.).</li>
<li><strong>Domain Names:</strong>  More difficult than IP addresses, but still relatively easy to change (registering new domains).</li>
<li><strong>Network/Host Artifacts:</strong>  (e.g., specific registry keys, file paths, user-agent strings)  Requires more effort to change.</li>
<li><strong>Tools:</strong> (e.g., specific malware families, exploit kits)  Requires significant effort to change (developing new tools).</li>
<li><strong>TTPs (Tactics, Techniques, and Procedures):</strong>  The hardest for attackers to change. These are the <em>way</em> they operate. Changing TTPs requires a fundamental shift in their approach.</li>
</ol>
</li>
<li><p><strong>Practical Application:</strong></p>
<ul>
<li>Focus your threat hunting efforts on the higher levels of the pyramid.</li>
<li>If you find a malicious IP address, that&#39;s good, but it&#39;s relatively easy for the attacker to change.</li>
<li>If you identify the TTPs used by an attacker, you can proactively hunt for other attacks that use the same TTPs.</li>
</ul>
</li>
<li><p><strong>Example:</strong></p>
<ul>
<li>You identify a piece of malware using a specific user-agent string in its HTTP requests (Network/Host Artifact).  You can then proactively hunt for other systems in your network using the same user-agent string.</li>
<li>You observe an attacker using PowerShell to download and execute malicious code (TTP). You can then proactively monitor PowerShell activity for similar patterns.</li>
</ul>
</li>
</ul>
<p><strong>5. Key Enablers for Successful Threat Hunting</strong></p>
<ul>
<li><strong>Explanation:</strong>  Effective threat hunting requires the right tools, data, and context.<ul>
<li><strong>Total Visibility: Access to Relevant Data Sources:</strong><ul>
<li><strong>Why:</strong> You can&#39;t hunt for what you can&#39;t see.</li>
<li><strong>Data Sources:</strong><ul>
<li><strong>Network Traffic:</strong> (e.g., PCAP files, NetFlow data, Zeek logs)</li>
<li><strong>Endpoint Logs:</strong> (e.g., Windows Event Logs, Sysmon logs, Linux audit logs)</li>
<li><strong>Security Logs:</strong> (e.g., firewall logs, IDS/IPS logs, web server logs)</li>
<li><strong>Cloud Logs:</strong> (e.g., AWS CloudTrail logs, Azure Activity logs)</li>
<li><strong>Application Logs:</strong> (e.g., database logs, web application logs)</li>
</ul>
</li>
<li><strong>Tools:</strong> SIEMs, EDRs, Network Monitoring Tools, Log Aggregators</li>
</ul>
</li>
<li><strong>Data Quality and Availability: Ensuring Reliable and Accessible Data:</strong><ul>
<li><strong>Why:</strong> Garbage in, garbage out.  If your data is incomplete, inaccurate, or unavailable, your threat hunting efforts will be hampered.</li>
<li><strong>Considerations:</strong><ul>
<li><strong>Data Retention:</strong> How long are you retaining your data?</li>
<li><strong>Data Integrity:</strong> Is your data accurate and trustworthy?</li>
<li><strong>Data Accessibility:</strong> Can you easily access and query your data?</li>
<li><strong>Data Normalization:</strong> Is your data formatted consistently across different sources?</li>
</ul>
</li>
</ul>
</li>
<li><strong>Situational Awareness: Understanding the Environment and Context:</strong><ul>
<li><strong>Why:</strong>  You need to understand your environment to identify anomalies.</li>
<li><strong>Considerations:</strong><ul>
<li><strong>Network Topology:</strong> How is your network structured?</li>
<li><strong>Asset Inventory:</strong> What assets do you have in your environment?</li>
<li><strong>User Behavior:</strong> What is normal user behavior?</li>
<li><strong>Application Behavior:</strong> What is normal application behavior?</li>
</ul>
</li>
<li><strong>Tools:</strong> Configuration Management Databases (CMDBs), Asset Management Systems, User and Entity Behavior Analytics (UEBA)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>6. Threat Intelligence: Leveraging Threat Intelligence Feeds</strong></p>
<ul>
<li><strong>Explanation:</strong> Threat intelligence is information about existing or emerging threats.  It can help you proactively hunt for threats in your environment.</li>
<li><p><strong>Types of Threat Intelligence:</strong></p>
<ul>
<li><strong>Open-Source Threat Intelligence (OSINT):</strong> Freely available information from sources like security blogs, vulnerability databases, and threat intelligence feeds.</li>
<li><strong>Commercial Threat Intelligence:</strong> Paid subscriptions to threat intelligence feeds from security vendors.</li>
<li><strong>Internal Threat Intelligence:</strong> Information gathered from your own security incidents and threat hunting activities.</li>
</ul>
</li>
<li><p><strong>Using Threat Intelligence for Threat Hunting:</strong></p>
<ul>
<li><strong>Identify Indicators of Compromise (IoCs):</strong> Use threat intelligence to identify IoCs associated with specific threats.</li>
<li><strong>Develop Threat Hunting Scenarios:</strong> Use threat intelligence to develop threat hunting scenarios based on known attack techniques.</li>
<li><strong>Prioritize Threat Hunting Efforts:</strong> Use threat intelligence to prioritize your threat hunting efforts based on the severity and likelihood of different threats.</li>
</ul>
</li>
<li><p><strong>Examples of Threat Intelligence Feeds:</strong></p>
<ul>
<li><strong>VirusTotal:</strong> A free service that analyzes files and URLs for malware.</li>
<li><strong>AlienVault OTX:</strong> A community-driven threat intelligence platform.</li>
<li><strong>MITRE ATT&amp;CK:</strong> A knowledge base of adversary tactics and techniques. (Technically a framework, but invaluable for understanding TTPs from Threat Intel.)</li>
<li>Commercial feeds from providers like CrowdStrike, FireEye, Recorded Future, etc.</li>
</ul>
</li>
</ul>
<p><strong>7. Introduction to Threat Modeling: Understanding Attack Vectors and Potential Targets</strong></p>
<ul>
<li><strong>Explanation:</strong> Threat modeling is a process of identifying potential threats and vulnerabilities in your environment. It helps you understand how an attacker might try to compromise your systems and data.</li>
<li><p><strong>Key Steps in Threat Modeling:</strong></p>
<ol>
<li><strong>Identify Assets:</strong> What are the most valuable assets in your environment? (e.g., customer data, financial data, intellectual property).</li>
<li><strong>Identify Threats:</strong> What are the potential threats to those assets? (e.g., ransomware, data theft, denial of service).</li>
<li><strong>Identify Vulnerabilities:</strong> What vulnerabilities could be exploited to carry out those threats? (e.g., unpatched software, weak passwords, misconfigurations).</li>
<li><strong>Analyze Attack Vectors:</strong> How could an attacker exploit those vulnerabilities? (e.g., phishing emails, SQL injection, remote code execution).</li>
<li><strong>Prioritize Risks:</strong> Which threats and vulnerabilities pose the greatest risk to your organization?</li>
<li><strong>Develop Mitigation Strategies:</strong> What steps can you take to reduce the risk of those threats and vulnerabilities? (e.g., patching software, implementing strong passwords, hardening systems).</li>
</ol>
</li>
<li><p><strong>Benefits of Threat Modeling:</strong></p>
<ul>
<li>Helps you understand your attack surface.</li>
<li>Identifies potential vulnerabilities before they can be exploited.</li>
<li>Prioritizes security efforts based on risk.</li>
<li>Improves your overall security posture.</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Module 2 Project/Exercise:</strong></p>
<ul>
<li><strong>Pyramid of Pain Exercise:</strong><ul>
<li><strong>Instructions:</strong> You are given the following list of Indicators of Compromise (IoCs) related to a hypothetical malware campaign. Categorize each IoC according to the Pyramid of Pain. Explain <em>why</em> you placed it at that level.<ol>
<li>MD5 hash of the malware executable: <code>a1b2c3d4e5f678901234567890abcdef</code></li>
<li>IP address of the command-and-control server: <code>192.0.2.10</code></li>
<li>Domain name used by the malware: <code>malicious-domain.com</code></li>
<li>The malware creates a registry key: <code>HKCU\Software\Malware</code></li>
<li>The malware uses PowerShell to download and execute code.</li>
<li>SHA256 hash of the malware executable: <code>abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890</code></li>
<li>The malware uses a specific user-agent string: <code>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36</code></li>
<li>The attacker leverages spear-phishing emails with malicious PDF attachments.</li>
<li>The malware uses a specific encryption algorithm to encrypt files.</li>
</ol>
</li>
</ul>
</li>
<li><strong>Capstone Project Contribution:</strong><ul>
<li>Write a section (approximately 500-750 words) for your final report that explains the core principles of threat hunting and the importance of each element of the Pyramid of Pain.  Discuss how understanding the Pyramid of Pain helps prioritize threat hunting efforts. Provide specific examples of how you would use indicators from different levels of the pyramid to guide your threat hunting activities.</li>
</ul>
</li>
</ul>
<p>This detailed breakdown of Module 2 provides a solid foundation for understanding the core principles of cyber threat hunting. Remember, the key is to be proactive, hypothesis-driven, and data-driven. Good luck, and have fun hunting! Let me know if you&#39;d like me to elaborate on any of these topics or provide additional examples.</p>
<h2 id="file-4-module_3-md">File 4: module_3.md</h2>
<p>Okay, let&#39;s dive deep into Module 3: Essential Cyber Security Skills for Threat Hunters. This module is crucial because it lays the groundwork for the practical application of threat hunting principles. It&#39;s all about equipping you with the core technical skills you&#39;ll need to identify, analyze, and understand threats.</p>
<p><strong>Module 3: Essential Cyber Security Skills for Threat Hunters</strong></p>
<p><strong>Module Objective:</strong> Identify and develop the crucial technical skills required for effective threat hunting.</p>
<p><strong>Subtopics:</strong></p>
<ul>
<li>Core Security Skill Set:<ul>
<li>Network Security Fundamentals: Packet analysis, network protocols.</li>
<li>Endpoint Security: Understanding endpoint behavior, process monitoring.</li>
<li>Malware Analysis Basics: Identifying malicious code, reverse engineering basics.</li>
<li>Log Analysis: Interpreting security logs from various sources.</li>
</ul>
</li>
<li>Visualization and Analysis:<ul>
<li>Data Visualization Techniques: Using graphs and charts to identify anomalies.</li>
<li>Analytical Thinking: Developing hypotheses and testing them against data.</li>
</ul>
</li>
<li>Scripting and Task Automation:<ul>
<li>Python for Security: Automating tasks, parsing data, interacting with APIs.</li>
<li>Shell Scripting: Automating command-line tasks.</li>
</ul>
</li>
<li>Understanding of Operating Systems: Windows and Linux internals.</li>
</ul>
<hr>
<p><strong>3.1 Core Security Skill Set</strong></p>
<p><strong>3.1.1 Network Security Fundamentals: Packet Analysis, Network Protocols</strong></p>
<ul>
<li><p><strong>Why it&#39;s important:</strong> Network traffic is a goldmine of information. Understanding network protocols and being able to analyze packets allows you to identify suspicious communication patterns, data exfiltration attempts, and command-and-control (C2) traffic.</p>
</li>
<li><p><strong>Deep Dive:</strong></p>
<ul>
<li><strong>Network Protocols:</strong><ul>
<li><strong>TCP/IP:</strong> The foundation of the internet. Understand the three-way handshake, connection establishment, and data transfer. Know the common TCP flags (SYN, ACK, FIN, RST, PSH, URG).</li>
<li><strong>HTTP/HTTPS:</strong> The protocol for web browsing. Understand the request-response cycle, HTTP methods (GET, POST, PUT, DELETE), and common HTTP status codes. Learn how to identify suspicious user-agent strings.</li>
<li><strong>DNS:</strong> The domain name system. Understand how DNS queries work, how to identify DNS tunneling, and how to spot malicious domain names.</li>
<li><strong>SMTP/IMAP/POP3:</strong> Email protocols. Understand how email is sent and received, and how to identify phishing emails and malware attachments.</li>
<li><strong>SMB/CIFS:</strong> File sharing protocols. Understand how file shares work, and how to identify lateral movement and data exfiltration.</li>
</ul>
</li>
<li><strong>Packet Analysis with Wireshark:</strong><ul>
<li><strong>Installation:</strong> Download and install Wireshark from <a href="https://www.wireshark.org/">https://www.wireshark.org/</a>.</li>
<li><strong>Capturing Traffic:</strong> Learn how to capture traffic on different interfaces.  Use appropriate filters to narrow down your captures.</li>
<li><strong>Filtering:</strong> Mastering Wireshark filters is KEY.<ul>
<li><code>ip.addr == 192.168.1.100</code> (Filter by IP address)</li>
<li><code>tcp.port == 80</code> (Filter by TCP port)</li>
<li><code>http.request.method == &quot;POST&quot;</code> (Filter by HTTP POST requests)</li>
<li><code>dns.flags.response == 1</code> (Filter for DNS responses)</li>
<li><code>http.user_agent contains &quot;malicious&quot;</code> (Filter for malicious User-Agent strings)</li>
</ul>
</li>
<li><strong>Following TCP Streams:</strong>  Reconstruct conversations between two hosts.  Right-click on a packet and select &quot;Follow TCP Stream.&quot;</li>
<li><strong>Analyzing Packets:</strong> Understand the structure of packets and the meaning of different fields.</li>
</ul>
</li>
<li><strong>Practical Exercise:</strong>  Download a PCAP file from a malware traffic analysis website (e.g., <a href="https://www.malware-traffic-analysis.net/">https://www.malware-traffic-analysis.net/</a>). Use Wireshark to analyze the traffic and identify any suspicious activity. Look for unusual protocols, large data transfers, or connections to known malicious IP addresses.</li>
</ul>
</li>
<li><p><strong>Example Wireshark Exercise:</strong></p>
<ol>
<li>Download a PCAP file from malware-traffic-analysis.net</li>
<li>Open it in Wireshark.</li>
<li>Filter for <code>http.request</code> to see HTTP requests. Look for suspicious URLs or User-Agent strings.</li>
<li>Filter for <code>dns</code> and look for queries to unusual domain names.</li>
<li>Filter for <code>tcp.stream eq 0</code> (or another stream number) after identifying a suspicious stream to follow the entire conversation.</li>
</ol>
</li>
</ul>
<p><strong>3.1.2 Endpoint Security: Understanding Endpoint Behavior, Process Monitoring</strong></p>
<ul>
<li><p><strong>Why it&#39;s important:</strong> Endpoints (laptops, desktops, servers) are often the target of attacks. Understanding how endpoints behave normally allows you to identify anomalies that could indicate malicious activity.</p>
</li>
<li><p><strong>Deep Dive:</strong></p>
<ul>
<li><strong>Process Monitoring:</strong><ul>
<li><strong>Windows:</strong> Task Manager, Process Explorer (from Sysinternals Suite), PowerShell <code>Get-Process</code> cmdlet.</li>
<li><strong>Linux:</strong> <code>top</code>, <code>ps</code>, <code>htop</code>.</li>
<li><strong>Key Metrics:</strong> CPU usage, memory usage, network connections, parent process, command-line arguments.</li>
<li><strong>Identifying Suspicious Processes:</strong> Look for processes with unusual names, processes running from temporary directories, processes with high CPU or memory usage, and processes making network connections to unknown IP addresses.</li>
</ul>
</li>
<li><strong>File System Monitoring:</strong><ul>
<li><strong>Windows:</strong>  Process Monitor (from Sysinternals Suite) to track file system changes.</li>
<li><strong>Linux:</strong> <code>inotifywait</code> command-line tool.</li>
<li><strong>Identifying Suspicious File Activity:</strong> Look for files being created in unusual locations, files being modified without user interaction, and files being deleted or renamed.</li>
</ul>
</li>
<li><strong>Registry Monitoring (Windows):</strong><ul>
<li><strong>Regedit:</strong>  The built-in registry editor.</li>
<li><strong>Process Monitor:</strong> Can also track registry changes.</li>
<li><strong>Identifying Suspicious Registry Activity:</strong> Look for registry keys being created or modified without user interaction, and registry keys associated with known malware.</li>
</ul>
</li>
<li><strong>Practical Exercise:</strong><ul>
<li><strong>Windows:</strong> Run Process Explorer and observe the processes running on your system. Identify the parent process of each process and examine the command-line arguments.  Look for anything unusual.</li>
<li><strong>Linux:</strong> Use the <code>top</code> command to monitor CPU and memory usage. Use the <code>ps</code> command to list all running processes and examine their command-line arguments.  Look for anything unusual.</li>
<li><strong>Sysmon (Windows):</strong> This tool is <em>essential</em> for detailed endpoint logging.  Configure it to log process creation, network connections, file creation, registry modifications, etc.  (See Module 5 for more on Sysmon).</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Example PowerShell Script (Windows) to list processes and their network connections:</strong></p>
<pre><code class="lang-powershell"><span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">ForEach-Object</span> {
    <span class="hljs-variable">$process</span> = <span class="hljs-variable">$_</span>
    <span class="hljs-variable">$processName</span> = <span class="hljs-variable">$process</span>.ProcessName
    <span class="hljs-variable">$networkConnections</span> = Get-NetTCPConnection | <span class="hljs-built_in">Where-Object</span> {<span class="hljs-variable">$_</span>.OwningProcess <span class="hljs-nomarkup">-eq</span> <span class="hljs-variable">$process</span>.Id}

    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$networkConnections</span>) {
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Process Name: $(<span class="hljs-variable">$processName</span>)"</span>
        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$connection</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$networkConnections</span>) {
            <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"  Local Address: $(<span class="hljs-variable">$connection</span>.LocalAddress):$(<span class="hljs-variable">$connection</span>.LocalPort)"</span>
            <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"  Remote Address: $(<span class="hljs-variable">$connection</span>.RemoteAddress):$(<span class="hljs-variable">$connection</span>.RemotePort)"</span>
            <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"  State: $(<span class="hljs-variable">$connection</span>.State)"</span>
        }
    }
}
</code></pre>
</li>
<li><p><strong>Example Linux Command to list processes and their network connections:</strong></p>
<pre><code class="lang-bash">netstat -anp | <span class="hljs-keyword">grep</span> <span class="hljs-symbol">&lt;process_name&gt;</span>
</code></pre>
</li>
</ul>
<p><strong>3.1.3 Malware Analysis Basics: Identifying Malicious Code, Reverse Engineering Basics</strong></p>
<ul>
<li><p><strong>Why it&#39;s important:</strong> Understanding how malware works allows you to develop effective defenses and identify infected systems.  You don&#39;t need to become a full-blown reverse engineer, but a basic understanding is vital.</p>
</li>
<li><p><strong>Deep Dive:</strong></p>
<ul>
<li><strong>Static Analysis:</strong><ul>
<li><strong>File Hashing:</strong> Calculate the MD5, SHA1, and SHA256 hashes of a file.  Use VirusTotal or other online services to check if the file is known malware.</li>
<li><strong>Strings Analysis:</strong> Extract the strings from a file.  Look for URLs, IP addresses, file paths, registry keys, and other indicators of compromise (IoCs).  Use the <code>strings</code> command on Linux or a strings tool on Windows.</li>
<li><strong>File Type Identification:</strong> Determine the file type using tools like <code>file</code> (Linux) or TrIDNet (Windows).  Check for file extension mismatches (e.g., a file with a .txt extension that is actually an executable).</li>
<li><strong>PE Header Analysis (Windows Executables):</strong>  Examine the PE header using tools like PEview or CFF Explorer.  Look for suspicious import functions (e.g., <code>CreateProcess</code>, <code>LoadLibrary</code>, <code>VirtualAlloc</code>) and unusual section names.</li>
</ul>
</li>
<li><strong>Dynamic Analysis (Sandboxing):</strong><ul>
<li><strong>Setting up a Sandboxed Environment:</strong> Use a virtual machine (VM) with a clean operating system. Disconnect the VM from the network to prevent the malware from spreading.</li>
<li><strong>Running the Malware:</strong> Execute the malware in the sandboxed environment.</li>
<li><strong>Monitoring System Activity:</strong> Use tools like Process Monitor (Windows) or <code>strace</code> (Linux) to monitor system activity.  Look for file system changes, registry modifications, network connections, and other indicators of compromise.</li>
</ul>
</li>
<li><strong>Basic Reverse Engineering:</strong><ul>
<li><strong>Disassemblers:</strong> Use a disassembler like IDA Pro or Ghidra to convert the malware&#39;s code into assembly language.</li>
<li><strong>Analyzing Assembly Code:</strong> Identify the main function of the malware and trace its execution flow.  Look for suspicious API calls and other indicators of malicious behavior.</li>
<li><strong>Decompilers:</strong> Use a decompiler to convert the assembly code back into a higher-level language (e.g., C).  This can make it easier to understand the malware&#39;s logic.</li>
</ul>
</li>
<li><strong>Tools:</strong><ul>
<li><strong>VirusTotal:</strong> Online malware analysis service.</li>
<li><strong>Hybrid Analysis:</strong> Online malware analysis service.</li>
<li><strong>Cuckoo Sandbox:</strong> Automated malware analysis system.</li>
<li><strong>PEview/CFF Explorer:</strong> PE header analysis tools.</li>
<li><strong>IDA Pro/Ghidra:</strong> Disassemblers.</li>
<li><strong>x64dbg/OllyDbg:</strong> Debuggers.</li>
<li><strong>Process Monitor:</strong> System activity monitoring tool.</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Example: Strings Analysis on Linux:</strong></p>
<pre><code class="lang-bash">strings malware.exe |<span class="hljs-string"> grep -E "http</span>|<span class="hljs-string">www\.</span>|<span class="hljs-string">.com</span>|<span class="hljs-string">.exe</span>|<span class="hljs-string">.dll</span>|<span class="hljs-string">C:\\</span>|<span class="hljs-string">HKEY_"</span>
</code></pre>
<p>This command extracts all strings from the <code>malware.exe</code> file and filters them for common indicators of compromise, such as URLs, domain names, file extensions, file paths, and registry keys.</p>
</li>
<li><p><strong>Important Note:</strong>  Handle malware with extreme caution. Always analyze malware in a sandboxed environment to prevent infection of your own system.</p>
</li>
</ul>
<p><strong>3.1.4 Log Analysis: Interpreting Security Logs from Various Sources</strong></p>
<ul>
<li><p><strong>Why it&#39;s important:</strong> Logs are a record of system activity. By analyzing logs, you can identify suspicious events, track user activity, and reconstruct attack sequences.</p>
</li>
<li><p><strong>Deep Dive:</strong></p>
<ul>
<li><strong>Common Log Sources:</strong><ul>
<li><strong>Windows Event Logs:</strong> Record system events, security events, and application events.</li>
<li><strong>Linux Syslog:</strong> A standard logging facility for Linux systems.</li>
<li><strong>Web Server Logs (e.g., Apache, Nginx):</strong> Record HTTP requests and responses.</li>
<li><strong>Firewall Logs:</strong> Record network traffic that passes through the firewall.</li>
<li><strong>Intrusion Detection System (IDS) Logs:</strong> Record suspicious network activity.</li>
<li><strong>Antivirus Logs:</strong> Record malware detections.</li>
</ul>
</li>
<li><strong>Log Formats:</strong><ul>
<li><strong>Plain Text:</strong> Simple text-based logs.</li>
<li><strong>CSV (Comma-Separated Values):</strong> Data is organized into rows and columns.</li>
<li><strong>JSON (JavaScript Object Notation):</strong> A human-readable data format.</li>
<li><strong>Syslog:</strong> A standard log format for network devices and systems.</li>
</ul>
</li>
<li><strong>Log Analysis Techniques:</strong><ul>
<li><strong>Searching:</strong> Use search tools like <code>grep</code> (Linux) or <code>Findstr</code> (Windows) to find specific events in logs.</li>
<li><strong>Filtering:</strong> Filter logs based on specific criteria, such as event ID, source IP address, or username.</li>
<li><strong>Aggregation:</strong> Combine logs from multiple sources to gain a holistic view of system activity.</li>
<li><strong>Correlation:</strong> Identify relationships between events from different log sources.</li>
<li><strong>Visualization:</strong> Use charts and graphs to visualize log data and identify trends.</li>
</ul>
</li>
<li><strong>Tools:</strong><ul>
<li><strong>grep (Linux):</strong> A powerful command-line search tool.</li>
<li><strong>Findstr (Windows):</strong> A command-line search tool.</li>
<li><strong>PowerShell (Windows):</strong> A scripting language for automating tasks.</li>
<li><strong>Splunk:</strong> A powerful log management and analysis platform.</li>
<li><strong>ELK Stack (Elasticsearch, Logstash, Kibana):</strong> A popular open-source log management and analysis platform.</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Example: Analyzing Windows Event Logs with PowerShell:</strong></p>
<pre><code class="lang-powershell"><span class="hljs-built_in">Get-WinEvent</span> -LogName Security -MaxEvents <span class="hljs-number">100</span> | <span class="hljs-built_in">Where-Object</span> {<span class="hljs-variable">$_</span>.ID <span class="hljs-nomarkup">-eq</span> <span class="hljs-number">4624</span>} | <span class="hljs-built_in">Format-List</span>
</code></pre>
<p>This command retrieves the 100 most recent events from the Security log, filters for events with ID 4624 (successful logon), and displays the results in a list format.</p>
</li>
<li><p><strong>Example: Analyzing Apache Web Server Logs with grep (Linux):</strong></p>
<pre><code class="lang-bash"><span class="hljs-keyword">grep</span> <span class="hljs-string">"404"</span> <span class="hljs-regexp">/var/</span>log<span class="hljs-regexp">/apache2/</span>access.log
</code></pre>
<p>This command searches the Apache access log for lines containing &quot;404&quot; (not found errors), which could indicate web application scanning or directory traversal attempts.</p>
</li>
</ul>
<hr>
<p><strong>3.2 Visualization and Analysis</strong></p>
<p><strong>3.2.1 Data Visualization Techniques: Using Graphs and Charts to Identify Anomalies</strong></p>
<ul>
<li><p><strong>Why it&#39;s important:</strong> Raw data can be overwhelming. Visualization helps you identify patterns, trends, and anomalies that would be difficult to spot in raw logs or tables.</p>
</li>
<li><p><strong>Deep Dive:</strong></p>
<ul>
<li><strong>Types of Charts and Graphs:</strong><ul>
<li><strong>Line Charts:</strong>  Show trends over time.  Useful for visualizing network traffic, CPU usage, or login attempts.</li>
<li><strong>Bar Charts:</strong> Compare values across different categories.  Useful for visualizing the frequency of different event types or the number of connections from different IP addresses.</li>
<li><strong>Scatter Plots:</strong> Show the relationship between two variables.  Useful for identifying outliers or clusters of data points.</li>
<li><strong>Histograms:</strong> Show the distribution of a single variable.  Useful for identifying unusual patterns in log data.</li>
<li><strong>Pie Charts:</strong> Show the proportion of different categories.  Useful for visualizing the distribution of different types of network traffic or the percentage of users who have been infected with malware.</li>
<li><strong>Geographic Maps:</strong> Visualize data based on location.  Useful for identifying the geographic origin of attacks.</li>
</ul>
</li>
<li><strong>Tools:</strong><ul>
<li><strong>Excel:</strong> A common spreadsheet program with basic charting capabilities.</li>
<li><strong>Google Sheets:</strong> A free online spreadsheet program with charting capabilities.</li>
<li><strong>Tableau:</strong> A powerful data visualization platform.</li>
<li><strong>Power BI:</strong> A business intelligence platform from Microsoft.</li>
<li><strong>Kibana:</strong> A data visualization tool for Elasticsearch.</li>
<li><strong>Python Libraries (Matplotlib, Seaborn, Plotly):</strong> Powerful and flexible data visualization tools.</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Example: Creating a Bar Chart in Python with Matplotlib:</strong></p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

event_types = [<span class="hljs-string">'Login Success'</span>, <span class="hljs-string">'Login Failure'</span>, <span class="hljs-string">'File Access'</span>, <span class="hljs-string">'Network Connection'</span>]
event_counts = [<span class="hljs-number">1000</span>, <span class="hljs-number">200</span>, <span class="hljs-number">500</span>, <span class="hljs-number">300</span>]

plt.bar(event_types, event_counts)
plt.xlabel(<span class="hljs-string">'Event Type'</span>)
plt.ylabel(<span class="hljs-string">'Count'</span>)
plt.<span class="hljs-built_in">title</span>(<span class="hljs-string">'Event Counts'</span>)
plt.show()
</code></pre>
</li>
<li><p><strong>Key Considerations:</strong></p>
<ul>
<li><strong>Choose the right chart type:</strong> The type of chart you use will depend on the type of data you are visualizing and the message you want to convey.</li>
<li><strong>Keep it simple:</strong> Avoid using too many colors or labels.</li>
<li><strong>Use clear and concise labels:</strong> Make sure your labels are easy to understand.</li>
<li><strong>Tell a story:</strong> Use your visualizations to tell a story about the data.</li>
</ul>
</li>
</ul>
<p><strong>3.2.2 Analytical Thinking: Developing Hypotheses and Testing Them Against Data</strong></p>
<ul>
<li><p><strong>Why it&#39;s important:</strong> Threat hunting is an iterative process of developing hypotheses and testing them against data.  Analytical thinking is the key to formulating effective hypotheses and interpreting the results.</p>
</li>
<li><p><strong>Deep Dive:</strong></p>
<ul>
<li><strong>The Scientific Method:</strong><ol>
<li><strong>Observation:</strong> Observe something unusual or suspicious in your data.</li>
<li><strong>Hypothesis:</strong> Formulate a hypothesis about the cause of the observation.</li>
<li><strong>Prediction:</strong> Make a prediction based on your hypothesis.</li>
<li><strong>Experiment:</strong> Design and conduct an experiment to test your prediction.</li>
<li><strong>Analysis:</strong> Analyze the results of your experiment.</li>
<li><strong>Conclusion:</strong> Draw a conclusion about whether your hypothesis is supported by the data.</li>
</ol>
</li>
<li><strong>Example:</strong><ol>
<li><strong>Observation:</strong> You notice a spike in network traffic to a specific IP address.</li>
<li><strong>Hypothesis:</strong> The spike in network traffic is caused by malware communicating with a command-and-control server.</li>
<li><strong>Prediction:</strong> If the hypothesis is true, you should be able to find evidence of malware on the system that is communicating with the IP address.</li>
<li><strong>Experiment:</strong> Analyze the system that is communicating with the IP address. Look for suspicious processes, files, and registry entries.</li>
<li><strong>Analysis:</strong> You find a suspicious process that is making network connections to the IP address. The process is running from a temporary directory and has a random name.</li>
<li><strong>Conclusion:</strong> The data supports the hypothesis that the spike in network traffic is caused by malware communicating with a command-and-control server.</li>
</ol>
</li>
<li><strong>Key Skills:</strong><ul>
<li><strong>Critical Thinking:</strong>  Question assumptions and evaluate evidence.</li>
<li><strong>Problem Solving:</strong>  Identify and solve problems effectively.</li>
<li><strong>Attention to Detail:</strong>  Pay close attention to detail when analyzing data.</li>
<li><strong>Communication:</strong>  Communicate your findings clearly and concisely.</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>3.3 Scripting and Task Automation</strong></p>
<p><strong>3.3.1 Python for Security: Automating Tasks, Parsing Data, Interacting with APIs</strong></p>
<ul>
<li><p><strong>Why it&#39;s important:</strong> Python is a versatile scripting language that can be used to automate many security tasks, such as log analysis, network scanning, and malware analysis.</p>
</li>
<li><p><strong>Deep Dive:</strong></p>
<ul>
<li><strong>Basic Python Syntax:</strong><ul>
<li><strong>Variables:</strong> Store data in named containers.</li>
<li><strong>Data Types:</strong> Integers, floats, strings, booleans, lists, dictionaries.</li>
<li><strong>Operators:</strong> Arithmetic, comparison, logical.</li>
<li><strong>Control Flow:</strong> <code>if</code>, <code>else</code>, <code>for</code>, <code>while</code>.</li>
<li><strong>Functions:</strong> Define reusable blocks of code.</li>
<li><strong>Modules:</strong> Import pre-written code to extend functionality.</li>
</ul>
</li>
<li><strong>Key Python Modules for Security:</strong><ul>
<li><strong><code>os</code>:</strong> Interact with the operating system.</li>
<li><strong><code>re</code>:</strong> Regular expressions for pattern matching.</li>
<li><strong><code>socket</code>:</strong> Network programming.</li>
<li><strong><code>requests</code>:</strong> Make HTTP requests.</li>
<li><strong><code>json</code>:</strong> Parse JSON data.</li>
<li><strong><code>csv</code>:</strong> Read and write CSV files.</li>
<li><strong><code>datetime</code>:</strong> Work with dates and times.</li>
<li><strong><code>hashlib</code>:</strong> Calculate file hashes.</li>
<li><strong><code>scapy</code>:</strong> Packet manipulation and network sniffing.</li>
</ul>
</li>
<li><p><strong>Example: Python Script to Calculate File Hashes:</strong></p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> hashlib

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_hash</span><span class="hljs-params">(filename, hash_type)</span>:</span>
    hasher = hashlib.new(hash_type)
    <span class="hljs-keyword">with</span> open(filename, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> f:
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
            chunk = f.read(<span class="hljs-number">4096</span>)
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> chunk:
                <span class="hljs-keyword">break</span>
            hasher.update(chunk)
    <span class="hljs-keyword">return</span> hasher.hexdigest()

filename = <span class="hljs-string">'malware.exe'</span>
md5_hash = calculate_hash(filename, <span class="hljs-string">'md5'</span>)
sha256_hash = calculate_hash(filename, <span class="hljs-string">'sha256'</span>)

print(f<span class="hljs-string">'MD5 Hash: {md5_hash}'</span>)
print(f<span class="hljs-string">'SHA256 Hash: {sha256_hash}'</span>)
</code></pre>
</li>
<li><p><strong>Example: Python Script to Make an API Request to VirusTotal:</strong></p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> json

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_virus_total_report</span><span class="hljs-params">(api_key, file_hash)</span>:</span>
    url = f<span class="hljs-string">'https://www.virustotal.com/vtapi/v2/file/report?apikey={api_key}&amp;resource={file_hash}'</span>
    response = requests.get(url)
    <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
        <span class="hljs-keyword">return</span> response.json()
    <span class="hljs-keyword">else</span>:
        print(f<span class="hljs-string">'Error: {response.status_code}'</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>

api_key = <span class="hljs-string">'YOUR_VIRUSTOTAL_API_KEY'</span>  <span class="hljs-comment"># Replace with your VirusTotal API key</span>
file_hash = <span class="hljs-string">'e90928894786c98f80e9b4f1716545d2'</span>
report = get_virus_total_report(api_key, file_hash)

<span class="hljs-keyword">if</span> report:
    print(json.dumps(report, indent=<span class="hljs-number">4</span>))
</code></pre>
</li>
</ul>
</li>
</ul>
<p><strong>3.3.2 Shell Scripting: Automating Command-Line Tasks</strong></p>
<ul>
<li><p><strong>Why it&#39;s important:</strong> Shell scripting allows you to automate repetitive command-line tasks, such as log analysis, file manipulation, and system administration.</p>
</li>
<li><p><strong>Deep Dive:</strong></p>
<ul>
<li><strong>Basic Shell Scripting Syntax (Bash):</strong><ul>
<li><strong>Variables:</strong> Store data in named containers.</li>
<li><strong>Operators:</strong> Arithmetic, comparison, logical.</li>
<li><strong>Control Flow:</strong> <code>if</code>, <code>else</code>, <code>for</code>, <code>while</code>.</li>
<li><strong>Functions:</strong> Define reusable blocks of code.</li>
<li><strong>Command Substitution:</strong> Execute commands and store the output in a variable.</li>
<li><strong>Piping:</strong> Chain commands together using the <code>|</code> operator.</li>
<li><strong>Redirection:</strong> Redirect input and output using the <code>&gt;</code>, <code>&lt;</code>, and <code>&gt;&gt;</code> operators.</li>
</ul>
</li>
<li><strong>Common Shell Commands for Security:</strong><ul>
<li><code>grep</code>: Search for patterns in files.</li>
<li><code>sed</code>: Edit text files.</li>
<li><code>awk</code>: Process data in columns.</li>
<li><code>cut</code>: Extract columns from data.</li>
<li><code>sort</code>: Sort data.</li>
<li><code>uniq</code>: Remove duplicate lines.</li>
<li><code>find</code>: Find files based on various criteria.</li>
<li><code>xargs</code>: Execute commands with arguments from standard input.</li>
</ul>
</li>
<li><p><strong>Example: Shell Script to Analyze Apache Web Server Logs for 404 Errors:</strong></p>
<pre><code class="lang-bash"><span class="hljs-meta">#!/bin/bash
</span>
LOG_FILE=<span class="hljs-string">"/var/log/apache2/access.log"</span>
ERROR_COUNT=$(grep <span class="hljs-string">"404"</span> <span class="hljs-string">"<span class="hljs-variable">$LOG_FILE</span>"</span> | wc <span class="hljs-_">-l</span>)

<span class="hljs-built_in">echo</span> <span class="hljs-string">"Number of 404 errors in <span class="hljs-variable">$LOG_FILE</span>: <span class="hljs-variable">$ERROR_COUNT</span>"</span>
</code></pre>
</li>
<li><p><strong>Example: Shell Script to Find Large Files on a System:</strong></p>
<pre><code class="lang-bash"><span class="hljs-meta">#!/bin/bash
</span>
find / -type f -size +100M -print0 | xargs -0 ls -lh | sort -k5 -n -r | head -n 10
</code></pre>
<p>This script finds all files larger than 100MB, lists them in human-readable format, sorts them by size in descending order, and displays the top 10 largest files.</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>3.4 Understanding of Operating Systems: Windows and Linux Internals</strong></p>
<ul>
<li><p><strong>Why it&#39;s important:</strong> Understanding how operating systems work allows you to identify vulnerabilities, understand malware behavior, and develop effective defenses.</p>
</li>
<li><p><strong>Deep Dive:</strong></p>
<ul>
<li><strong>Windows Internals:</strong><ul>
<li><strong>Architecture:</strong> Kernel mode vs. user mode, processes and threads, memory management, file system, registry.</li>
<li><strong>Processes and Threads:</strong> Understanding process creation, process memory layout, and thread scheduling.</li>
<li><strong>Memory Management:</strong> Understanding virtual memory, memory allocation, and memory protection.</li>
<li><strong>File System:</strong> Understanding the NTFS file system and its structure.</li>
<li><strong>Registry:</strong> Understanding the registry structure and how it is used to store system configuration information.</li>
<li><strong>Security Features:</strong> User Account Control (UAC), Windows Defender, Windows Firewall.</li>
</ul>
</li>
<li><strong>Linux Internals:</strong><ul>
<li><strong>Architecture:</strong> Kernel, shell, file system, processes and threads, memory management.</li>
<li><strong>Processes and Threads:</strong> Understanding process creation, process memory layout, and thread scheduling.</li>
<li><strong>Memory Management:</strong> Understanding virtual memory, memory allocation, and memory protection.</li>
<li><strong>File System:</strong> Understanding the ext4 file system and its structure.</li>
<li><strong>Security Features:</strong> SELinux, AppArmor, iptables.</li>
</ul>
</li>
<li><strong>Key Concepts:</strong><ul>
<li><strong>System Calls:</strong> The interface between user-mode applications and the kernel.</li>
<li><strong>Kernel Modules:</strong> Loadable code that extends the functionality of the kernel.</li>
<li><strong>Device Drivers:</strong> Software that allows the operating system to communicate with hardware devices.</li>
<li><strong>Boot Process:</strong> The sequence of events that occurs when the operating system starts up.</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Resources:</strong></p>
<ul>
<li><strong>&quot;Windows Internals&quot; by Mark Russinovich and David Solomon:</strong> A comprehensive guide to Windows internals.</li>
<li><strong>&quot;Understanding the Linux Kernel&quot; by Daniel P. Bovet and Marco Cesati:</strong> A comprehensive guide to Linux internals.</li>
<li><strong>Online documentation for Windows and Linux:</strong> Microsoft Docs and the Linux man pages.</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Module 3 Project/Exercise:</strong></p>
<ul>
<li><strong>Log Analysis Challenge:</strong> Students will be given a set of security logs (e.g., web server logs, firewall logs) and asked to identify suspicious activity.</li>
<li><strong>Scripting Exercise:</strong> Students will write a Python script to automate the analysis of a specific type of security log.</li>
</ul>
<p><strong>Capstone Project Contribution:</strong> Students will include a section on the essential skills for threat hunters, explaining why each skill is important.</p>
<p>This detailed breakdown provides a comprehensive overview of Module 3. It&#39;s packed with information, examples, and exercises to help you develop the essential cybersecurity skills you need to become an effective threat hunter. Remember to practice these skills regularly to solidify your understanding. Good luck!</p>
<h2 id="file-5-module_4-md">File 5: module_4.md</h2>
<p>Okay, let&#39;s dive deep into Module 4: Threat Hunting Tools and Techniques (Part 1: Network). This module will be heavily hands-on, focusing on practical skills using industry-standard tools.</p>
<p><strong>Module 4: Threat Hunting Tools and Techniques (Part 1: Network)</strong></p>
<p><strong>Module Objective:</strong> Learn to leverage network-based tools and techniques for detecting malicious activity.</p>
<p><strong>Module Duration:</strong> Approximately 8 hours (including lecture, hands-on labs, and exercises).</p>
<p><strong>Prerequisites:</strong></p>
<ul>
<li>Basic understanding of TCP/IP networking.</li>
<li>Familiarity with the Linux command line.</li>
<li>A virtual machine with Kali Linux installed (or another security-focused distribution).</li>
<li>Basic understanding of packet capture and analysis principles.</li>
</ul>
<p><strong>Module Structure:</strong></p>
<ol>
<li><strong>Introduction to Network Threat Hunting (30 minutes)</strong></li>
<li><strong>Network Intrusion Detection Systems (NIDS) with Snort/Suricata (2 hours)</strong></li>
<li><strong>Network Traffic Analysis (NTA) with Wireshark (2 hours)</strong></li>
<li><strong>Network Traffic Analysis (NTA) with Zeek (Bro) (2 hours)</strong></li>
<li><strong>NetFlow Analysis (1 hour)</strong></li>
<li><strong>DNS Analysis (1 hour)</strong></li>
<li><strong>Module Project/Exercise: Network Forensics Challenge (30 minutes)</strong></li>
</ol>
<hr>
<p><strong>1. Introduction to Network Threat Hunting (30 minutes)</strong></p>
<ul>
<li><p><strong>What is Network Threat Hunting?</strong></p>
<ul>
<li>Proactive searching for malicious activity on a network that has evaded existing security controls.</li>
<li>Focus on anomalies, unusual patterns, and indicators of compromise (IoCs) in network traffic.</li>
<li>Driven by hypotheses, threat intelligence, and a deep understanding of network protocols and behavior.</li>
</ul>
</li>
<li><p><strong>Why Network Threat Hunting?</strong></p>
<ul>
<li>Traditional security tools are reactive (signature-based).</li>
<li>Advanced attackers use stealthy techniques to bypass defenses.</li>
<li>Network traffic provides a rich source of data for detecting malicious activity.</li>
</ul>
</li>
<li><p><strong>Key Data Sources for Network Threat Hunting:</strong></p>
<ul>
<li>Packet captures (PCAP files)</li>
<li>Network flow data (NetFlow, sFlow, IPFIX)</li>
<li>Network intrusion detection system (NIDS) alerts</li>
<li>DNS logs</li>
<li>Proxy logs</li>
</ul>
</li>
<li><p><strong>Common Network Threat Hunting Scenarios:</strong></p>
<ul>
<li>Detecting command-and-control (C&amp;C) traffic.</li>
<li>Identifying data exfiltration.</li>
<li>Finding lateral movement within the network.</li>
<li>Detecting malware infections.</li>
<li>Identifying rogue devices.</li>
</ul>
</li>
</ul>
<hr>
<p><strong>2. Network Intrusion Detection Systems (NIDS) with Snort/Suricata (2 hours)</strong></p>
<ul>
<li><p><strong>Introduction to NIDS:</strong></p>
<ul>
<li>Monitors network traffic for malicious activity based on predefined rules.</li>
<li>Generates alerts when suspicious traffic is detected.</li>
<li>Can be signature-based or anomaly-based.</li>
<li>Examples: Snort, Suricata.</li>
</ul>
</li>
<li><p><strong>Snort vs. Suricata:</strong></p>
<ul>
<li>Similar functionality, but Suricata offers better performance and multi-threading support.</li>
<li>Both use similar rule syntax.</li>
</ul>
</li>
<li><p><strong>Installing Snort/Suricata (Kali Linux):</strong></p>
<ul>
<li><strong>Snort:</strong> <code>sudo apt update &amp;&amp; sudo apt install snort</code></li>
<li><strong>Suricata:</strong> <code>sudo apt update &amp;&amp; sudo apt install suricata</code></li>
</ul>
</li>
<li><p><strong>Configuring Snort/Suricata:</strong></p>
<ul>
<li>Configuration files are located in <code>/etc/snort</code> or <code>/etc/suricata</code>.</li>
<li>Key configuration options:<ul>
<li><code>HOME_NET</code>: Defines the network(s) to be monitored.</li>
<li><code>EXTERNAL_NET</code>: Defines the external network (usually the internet).</li>
<li><code>RULE_PATH</code>: Specifies the directory containing the Snort/Suricata rules.</li>
<li><code>INTERFACE</code>: Specifies the network interface to monitor.</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Snort/Suricata Rule Syntax:</strong></p>
<ul>
<li>A Snort/Suricata rule consists of a header and options.</li>
<li><strong>Header:</strong> <code>action protocol src_ip src_port -&gt; dest_ip dest_port (options)</code><ul>
<li><code>action</code>: What to do when the rule matches (e.g., <code>alert</code>, <code>log</code>, <code>pass</code>, <code>drop</code>, <code>reject</code>).</li>
<li><code>protocol</code>: Network protocol (e.g., <code>tcp</code>, <code>udp</code>, <code>icmp</code>, <code>ip</code>).</li>
<li><code>src_ip</code>: Source IP address.</li>
<li><code>src_port</code>: Source port.</li>
<li><code>-&gt;</code>: Direction of traffic.</li>
<li><code>dest_ip</code>: Destination IP address.</li>
<li><code>dest_port</code>: Destination port.</li>
</ul>
</li>
<li><strong>Options:</strong> Keywords that specify additional criteria for matching traffic.<ul>
<li><code>msg</code>: Alert message.</li>
<li><code>content</code>: Matches specific content within the packet.</li>
<li><code>sid</code>: Snort ID (unique identifier for the rule).</li>
<li><code>rev</code>: Revision number.</li>
<li><code>classtype</code>: Classifies the type of attack.</li>
<li><code>flags</code>: TCP flags.</li>
<li><code>dsize</code>: Packet data size.</li>
<li><code>ttl</code>: Time to live</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Writing Snort/Suricata Rules (Examples):</strong></p>
<ul>
<li><p><strong>Detecting ICMP traffic:</strong></p>
<pre><code>alert icmp <span class="hljs-keyword">any</span> <span class="hljs-keyword">any</span> -&gt; <span class="hljs-keyword">any</span> <span class="hljs-keyword">any</span> (msg:<span class="hljs-string">"ICMP Traffic Detected"</span>; sid:<span class="hljs-number">1000001</span>; rev:<span class="hljs-number">1</span>;)
</code></pre></li>
<li><p><strong>Detecting HTTP traffic containing the string &quot;malware.exe&quot;:</strong></p>
<pre><code><span class="hljs-selector-tag">alert</span> <span class="hljs-selector-tag">tcp</span> <span class="hljs-selector-tag">any</span> <span class="hljs-selector-tag">any</span> <span class="hljs-selector-tag">-</span>&gt; <span class="hljs-selector-tag">any</span> <span class="hljs-selector-tag">80</span> (<span class="hljs-attribute">msg</span>:<span class="hljs-string">"HTTP Traffic with malware.exe"</span>; <span class="hljs-attribute">content</span>:<span class="hljs-string">"malware.exe"</span>; http_uri; <span class="hljs-attribute">sid</span>:<span class="hljs-number">1000002</span>; <span class="hljs-attribute">rev</span>:<span class="hljs-number">1</span>;)
</code></pre></li>
<li><p><strong>Detecting a specific User-Agent:</strong></p>
<pre><code><span class="hljs-selector-tag">alert</span> <span class="hljs-selector-tag">tcp</span> <span class="hljs-selector-tag">any</span> <span class="hljs-selector-tag">any</span> <span class="hljs-selector-tag">-</span>&gt; <span class="hljs-selector-tag">any</span> <span class="hljs-selector-tag">80</span> (<span class="hljs-attribute">msg</span>:<span class="hljs-string">"Suspicious User-Agent"</span>; <span class="hljs-attribute">content</span>:<span class="hljs-string">"BadBot/1.0"</span>; http_header; <span class="hljs-attribute">sid</span>:<span class="hljs-number">1000003</span>; <span class="hljs-attribute">rev</span>:<span class="hljs-number">1</span>;)
</code></pre></li>
</ul>
</li>
<li><p><strong>Testing Snort/Suricata Rules:</strong></p>
<ol>
<li>Create a rule file (e.g., <code>local.rules</code>) in the rules directory (<code>/etc/snort/rules</code> or <code>/etc/suricata/rules</code>).</li>
<li>Add your rules to the file.</li>
<li><p>Run Snort/Suricata in test mode:</p>
<ul>
<li><strong>Snort:</strong> <code>sudo snort -c /etc/snort/snort.conf -T -i eth0</code> (replace <code>eth0</code> with your network interface)</li>
<li><strong>Suricata:</strong> <code>sudo suricata -c /etc/suricata/suricata.yaml -T -i eth0</code></li>
</ul>
</li>
<li><p>Generate traffic that matches your rule (e.g., using <code>curl</code> or <code>ping</code>).</p>
</li>
<li>Verify that Snort/Suricata generates an alert.</li>
</ol>
</li>
<li><p><strong>Running Snort/Suricata in Production Mode:</strong></p>
<ul>
<li><strong>Snort:</strong> <code>sudo snort -c /etc/snort/snort.conf -i eth0 -A console</code> (outputs alerts to the console)</li>
<li><strong>Suricata:</strong> <code>sudo suricata -c /etc/suricata/suricata.yaml -i eth0</code> (logs alerts to a file)</li>
</ul>
</li>
<li><p><strong>Analyzing Snort/Suricata Alerts:</strong></p>
<ul>
<li>Alerts are typically logged to a file (e.g., <code>/var/log/snort/alert</code> or <code>/var/log/suricata/fast.log</code>).</li>
<li>Alerts contain information about the event, including:<ul>
<li>Timestamp</li>
<li>Source and destination IP addresses and ports</li>
<li>Rule ID</li>
<li>Alert message</li>
<li>Packet data (optional)</li>
</ul>
</li>
<li>Use tools like <code>grep</code>, <code>awk</code>, or specialized SIEM solutions to analyze alerts.</li>
</ul>
</li>
<li><p><strong>Hands-on Exercise:</strong></p>
<ol>
<li>Install Snort/Suricata on your Kali Linux VM.</li>
<li>Create a custom rule to detect a specific type of traffic (e.g., traffic to a known malicious IP address).</li>
<li>Test the rule by generating the traffic and verifying that Snort/Suricata generates an alert.</li>
<li>Analyze the alert and extract relevant information.</li>
</ol>
</li>
</ul>
<hr>
<p><strong>3. Network Traffic Analysis (NTA) with Wireshark (2 hours)</strong></p>
<ul>
<li><p><strong>Introduction to Wireshark:</strong></p>
<ul>
<li>A powerful network packet analyzer.</li>
<li>Captures and analyzes network traffic in real-time.</li>
<li>Provides detailed information about each packet, including protocol headers, data, and timestamps.</li>
<li>Essential tool for network troubleshooting, security analysis, and threat hunting.</li>
</ul>
</li>
<li><p><strong>Installing Wireshark (Kali Linux):</strong></p>
<ul>
<li><code>sudo apt update &amp;&amp; sudo apt install wireshark</code></li>
</ul>
</li>
<li><p><strong>Capturing Network Traffic:</strong></p>
<ul>
<li>Run Wireshark as root: <code>sudo wireshark</code></li>
<li>Select the network interface to capture traffic on.</li>
<li>Start the capture.</li>
<li>Stop the capture when you have collected enough data.</li>
</ul>
</li>
<li><p><strong>Wireshark Interface:</strong></p>
<ul>
<li><strong>Packet List Pane:</strong> Displays a summary of each captured packet.</li>
<li><strong>Packet Details Pane:</strong> Displays detailed information about the selected packet.</li>
<li><strong>Packet Bytes Pane:</strong> Displays the raw bytes of the selected packet.</li>
<li><strong>Filter Bar:</strong> Allows you to filter the captured traffic based on various criteria.</li>
</ul>
</li>
<li><p><strong>Wireshark Filters:</strong></p>
<ul>
<li><strong>Capture Filters:</strong> Filter traffic <em>before</em> it is captured. Useful for reducing the amount of data captured.<ul>
<li>Example: <code>tcp port 80</code> (captures only HTTP traffic).</li>
<li>Example: <code>host 192.168.1.100</code> (captures traffic to/from the IP address 192.168.1.100).</li>
</ul>
</li>
<li><strong>Display Filters:</strong> Filter traffic <em>after</em> it has been captured. More flexible than capture filters.<ul>
<li>Example: <code>http.request.method == &quot;GET&quot;</code> (displays only HTTP GET requests).</li>
<li>Example: <code>ip.src == 10.0.0.1 &amp;&amp; tcp.port == 443</code> (displays TCP traffic from 10.0.0.1 to port 443).</li>
<li>Example: <code>http contains &quot;password&quot;</code> (displays HTTP traffic containing the string &quot;password&quot;).</li>
<li>Example: <code>tcp.flags.syn == 1 &amp;&amp; tcp.flags.ack == 0</code> (displays TCP SYN packets).</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Analyzing Network Traffic with Wireshark:</strong></p>
<ul>
<li><strong>Following TCP Streams:</strong> Allows you to view the entire conversation between two hosts.<ul>
<li>Right-click on a packet and select &quot;Follow&quot; -&gt; &quot;TCP Stream&quot;.</li>
</ul>
</li>
<li><strong>Examining Protocol Headers:</strong> Provides information about the protocol being used, source and destination addresses, and other relevant details.</li>
<li><strong>Extracting Files:</strong> Allows you to extract files that have been transmitted over the network (e.g., images, documents, executables).<ul>
<li>&quot;File&quot; -&gt; &quot;Export Objects&quot; -&gt; &quot;HTTP&quot;.</li>
</ul>
</li>
<li><strong>Statistical Analysis:</strong> Wireshark provides various statistical tools for analyzing network traffic.<ul>
<li>&quot;Statistics&quot; -&gt; &quot;Summary&quot;</li>
<li>&quot;Statistics&quot; -&gt; &quot;Conversations&quot;</li>
<li>&quot;Statistics&quot; -&gt; &quot;Endpoints&quot;</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Wireshark for Threat Hunting (Examples):</strong></p>
<ul>
<li><strong>Detecting C&amp;C Traffic:</strong> Look for unusual connection patterns, long-lived connections, or traffic to known malicious IP addresses or domains.</li>
<li><strong>Identifying Data Exfiltration:</strong> Look for large amounts of data being transferred to external hosts, or traffic to unusual ports or protocols.</li>
<li><strong>Detecting Malware Infections:</strong> Look for suspicious DNS queries, HTTP requests to malicious websites, or traffic containing malware signatures.</li>
<li><strong>Analyzing Encrypted Traffic (HTTPS):</strong> While you can&#39;t see the content, you can still analyze the TLS/SSL handshake to identify potential issues.</li>
</ul>
</li>
<li><p><strong>Hands-on Exercise:</strong></p>
<ol>
<li>Capture network traffic while browsing a website or using a specific application.</li>
<li>Use Wireshark filters to isolate specific types of traffic.</li>
<li>Follow a TCP stream to view the entire conversation between two hosts.</li>
<li>Examine the protocol headers of different packets.</li>
<li>Extract files that have been transmitted over the network.</li>
<li>Analyze the captured traffic for suspicious activity.</li>
</ol>
</li>
</ul>
<hr>
<p><strong>4. Network Traffic Analysis (NTA) with Zeek (Bro) (2 hours)</strong></p>
<ul>
<li><p><strong>Introduction to Zeek (Bro):</strong></p>
<ul>
<li>A powerful network security monitoring framework.</li>
<li>Analyzes network traffic and generates detailed logs of events.</li>
<li>Provides a high-level view of network activity, making it easier to identify anomalies and suspicious behavior.</li>
<li>Scriptable and extensible, allowing you to customize its behavior.</li>
<li>Focuses on creating context-rich logs, not just alerting.</li>
</ul>
</li>
<li><p><strong>Installing Zeek (Bro) (Kali Linux):</strong></p>
<pre><code class="lang-bash">sudo apt <span class="hljs-keyword">update</span>
sudo apt <span class="hljs-keyword">install</span> zeek
</code></pre>
</li>
<li><p><strong>Configuring Zeek (Bro):</strong></p>
<ul>
<li>Configuration files are located in <code>/opt/zeek/etc</code>.</li>
<li>Key configuration options:<ul>
<li><code>node.cfg</code>: Defines the Zeek nodes in your deployment.</li>
<li><code>networks.cfg</code>: Defines the networks that Zeek should monitor.</li>
<li><code>zeekctl.cfg</code>: Zeek Control Framework configuration.</li>
</ul>
</li>
<li><p>To configure Zeek for a single-machine setup, edit <code>node.cfg</code> and ensure the interface is correctly set.  For example:</p>
<pre><code><span class="hljs-section">[zeek]</span>
<span class="hljs-attr">type</span>=standalone
<span class="hljs-attr">host</span>=localhost
<span class="hljs-attr">interface</span>=eth0  # Change this to your actual interface
<span class="hljs-attr">lb_method</span>=pf_ring
</code></pre></li>
</ul>
</li>
<li><p><strong>Starting and Stopping Zeek (Bro):</strong></p>
<ul>
<li>Use the <code>zeekctl</code> command-line tool to manage Zeek.</li>
<li><code>sudo zeekctl deploy</code> (starts Zeek and deploys the configuration).</li>
<li><code>sudo zeekctl status</code> (checks the status of Zeek).</li>
<li><code>sudo zeekctl stop</code> (stops Zeek).</li>
<li><code>sudo zeekctl cron</code> (processes logs).</li>
</ul>
</li>
<li><p><strong>Zeek (Bro) Log Files:</strong></p>
<ul>
<li>Zeek generates a variety of log files, located in <code>/opt/zeek/spool/zeek/</code>.</li>
<li>Key log files:<ul>
<li><code>conn.log</code>: Contains information about network connections.</li>
<li><code>dns.log</code>: Contains information about DNS queries.</li>
<li><code>http.log</code>: Contains information about HTTP requests.</li>
<li><code>ssl.log</code>: Contains information about SSL/TLS connections.</li>
<li><code>files.log</code>: Contains information about extracted files.</li>
<li><code>notice.log</code>: Contains notices generated by Zeek scripts.</li>
<li><code>software.log</code>: Contains information about detected software versions.</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Analyzing Zeek (Bro) Logs:</strong></p>
<ul>
<li>Zeek logs are typically stored in tab-separated value (TSV) format.</li>
<li>Use command-line tools like <code>grep</code>, <code>awk</code>, <code>cut</code>, and <code>sort</code> to analyze the logs.</li>
<li>Consider using specialized log analysis tools or SIEM solutions to process and visualize Zeek logs.</li>
</ul>
</li>
<li><p><strong>Zeek (Bro) Scripting:</strong></p>
<ul>
<li>Zeek uses its own scripting language for customizing its behavior.</li>
<li>Scripts can be used to:<ul>
<li>Detect specific types of traffic.</li>
<li>Generate alerts.</li>
<li>Modify the behavior of Zeek.</li>
<li>Integrate with other security tools.</li>
</ul>
</li>
<li>Zeek scripts are located in <code>/opt/zeek/share/zeek/site</code>.</li>
</ul>
</li>
<li><p><strong>Zeek (Bro) for Threat Hunting (Examples):</strong></p>
<ul>
<li><strong>Detecting C&amp;C Traffic:</strong> Use Zeek scripts to identify unusual connection patterns or traffic to known malicious IP addresses or domains.</li>
<li><strong>Identifying Data Exfiltration:</strong> Use Zeek scripts to detect large amounts of data being transferred to external hosts.</li>
<li><strong>Detecting Malware Infections:</strong> Use Zeek scripts to identify suspicious DNS queries, HTTP requests to malicious websites, or traffic containing malware signatures.</li>
<li><strong>Analyzing Software Versions:</strong> Use the <code>software.log</code> file to identify outdated or vulnerable software on the network.</li>
</ul>
</li>
<li><p><strong>Hands-on Exercise:</strong></p>
<ol>
<li>Install Zeek on your Kali Linux VM.</li>
<li>Start Zeek and generate some network traffic.</li>
<li>Examine the Zeek log files and identify relevant information.</li>
<li>Write a simple Zeek script to detect a specific type of traffic or generate an alert.</li>
<li>Test the script and verify that it works as expected.</li>
</ol>
<p><strong>Example Zeek script (detecting connections to a specific IP):</strong></p>
<pre><code class="lang-zeek">@load base/frameworks/notice

event connection_established(<span class="hljs-symbol">c:</span> connection)
  {
  <span class="hljs-keyword">if</span> (c?$id &amp;&amp; c$id$resp_h == <span class="hljs-number">1.2</span>.<span class="hljs-number">3.4</span>)  <span class="hljs-comment"># Replace with a suspicious IP</span>
    {
    Notice::create([
        $note = Notice::NOTE_SUSPICIOUS,
        $ts = Time::now(),
        $conn = c,
        $msg = fmt(<span class="hljs-string">"Connection established to suspicious IP: %s"</span>, c$id$resp_h),
        $sub = <span class="hljs-string">"Suspicious Connection"</span>
    ]);
    }
  }
</code></pre>
<p>Save this script as <code>suspicious_ip.zeek</code> in <code>/opt/zeek/share/zeek/site/</code>, then run <code>sudo zeekctl deploy</code></p>
</li>
</ul>
<hr>
<p><strong>5. NetFlow Analysis (1 hour)</strong></p>
<ul>
<li><p><strong>Introduction to NetFlow:</strong></p>
<ul>
<li>A network protocol developed by Cisco for collecting network flow data.</li>
<li>Provides information about network traffic flows, including:<ul>
<li>Source and destination IP addresses and ports.</li>
<li>Protocol.</li>
<li>Number of packets and bytes transferred.</li>
<li>Start and end times.</li>
</ul>
</li>
<li>Less detailed than packet captures, but more scalable and efficient for large networks.</li>
</ul>
</li>
<li><p><strong>NetFlow vs. Packet Capture:</strong></p>
<p>| Feature          | NetFlow                  | Packet Capture              |
| ---------------- | ------------------------ | ---------------------------- |
| Data Captured    | Flow information         | Full packet content        |
| Scalability      | High                     | Low                         |
| Storage Required | Low                      | High                        |
| Processing Power | Low                      | High                        |
| Detail           | Less detailed            | Very detailed              |</p>
</li>
<li><p><strong>NetFlow Architecture:</strong></p>
<ul>
<li><strong>NetFlow Exporter:</strong> A device (e.g., router, switch, firewall) that generates NetFlow data.</li>
<li><strong>NetFlow Collector:</strong> A server that receives and stores NetFlow data.</li>
<li><strong>NetFlow Analyzer:</strong> A tool that analyzes NetFlow data to identify trends, anomalies, and security threats.</li>
</ul>
</li>
<li><p><strong>Tools for NetFlow Collection and Analysis:</strong></p>
<ul>
<li><strong>ntopng:</strong> A network traffic monitoring tool that supports NetFlow.</li>
<li><strong>SolarWinds NetFlow Traffic Analyzer:</strong> A commercial NetFlow analyzer.</li>
<li><strong>Wireshark:</strong> Can be used to capture and analyze NetFlow data (but not a collector).</li>
<li><strong>Softflowd:</strong> A software-based NetFlow exporter.</li>
</ul>
</li>
<li><p><strong>Analyzing NetFlow Data for Threat Hunting (Examples):</strong></p>
<ul>
<li><strong>Detecting C&amp;C Traffic:</strong> Look for unusual connection patterns, long-lived connections, or traffic to known malicious IP addresses or domains.</li>
<li><strong>Identifying Data Exfiltration:</strong> Look for large amounts of data being transferred to external hosts, or traffic to unusual ports or protocols.</li>
<li><strong>Detecting DDoS Attacks:</strong> Look for a sudden increase in traffic to a specific host or network.</li>
<li><strong>Identifying Rogue Devices:</strong> Look for devices that are not authorized to be on the network.</li>
</ul>
</li>
<li><p><strong>Hands-on Exercise:</strong></p>
<ol>
<li>Install a NetFlow collector and analyzer (e.g., ntopng) on your Kali Linux VM.</li>
<li>Configure a device (e.g., a router or switch) to export NetFlow data to the collector.  If you don&#39;t have a physical device, use <code>softflowd</code> on a virtual machine to generate NetFlow from captured traffic.</li>
<li>Analyze the NetFlow data and identify relevant information.</li>
<li>Use the NetFlow analyzer to identify suspicious activity.</li>
</ol>
</li>
</ul>
<hr>
<p><strong>6. DNS Analysis (1 hour)</strong></p>
<ul>
<li><p><strong>Introduction to DNS Analysis:</strong></p>
<ul>
<li>The Domain Name System (DNS) is used to translate domain names into IP addresses.</li>
<li>DNS traffic can be a valuable source of information for threat hunting.</li>
<li>Malicious actors often use DNS for command-and-control, data exfiltration, and other malicious activities.</li>
</ul>
</li>
<li><p><strong>Key DNS Records:</strong></p>
<ul>
<li><strong>A Record:</strong> Maps a domain name to an IPv4 address.</li>
<li><strong>AAAA Record:</strong> Maps a domain name to an IPv6 address.</li>
<li><strong>CNAME Record:</strong> Creates an alias for a domain name.</li>
<li><strong>MX Record:</strong> Specifies the mail server for a domain.</li>
<li><strong>TXT Record:</strong> Contains arbitrary text data.</li>
</ul>
</li>
<li><p><strong>Tools for DNS Analysis:</strong></p>
<ul>
<li><strong>nslookup:</strong> A command-line tool for querying DNS servers.</li>
<li><strong>dig:</strong> A more advanced command-line tool for querying DNS servers.</li>
<li><strong>Wireshark:</strong> Can be used to capture and analyze DNS traffic.</li>
<li><strong>Zeek (Bro):</strong> Generates detailed logs of DNS queries.</li>
<li><strong>Passive DNS:</strong> A database of historical DNS records.</li>
</ul>
</li>
<li><p><strong>Analyzing DNS Traffic for Threat Hunting (Examples):</strong></p>
<ul>
<li><strong>Detecting Domain Generation Algorithms (DGAs):</strong> DGAs are used by malware to generate a large number of random domain names, making it difficult to block them. Look for DNS queries to domains with unusual character patterns or high entropy.</li>
<li><strong>Identifying Fast Flux DNS:</strong> Fast flux DNS is a technique used by malware to rapidly change the IP addresses associated with a domain name, making it difficult to track down the malware. Look for domains with a very short TTL (Time To Live) and a large number of associated IP addresses.</li>
<li><strong>Detecting DNS Tunneling:</strong> DNS tunneling is a technique used to exfiltrate data over the DNS protocol. Look for DNS queries with unusually large payloads or traffic to unusual domains.</li>
<li><strong>Identifying DNS Hijacking:</strong> DNS hijacking is a technique used to redirect DNS queries to malicious servers. Look for DNS queries that return unexpected results.</li>
</ul>
</li>
<li><p><strong>Hands-on Exercise:</strong></p>
<ol>
<li>Use <code>nslookup</code> or <code>dig</code> to query DNS servers for various domain names.</li>
<li>Capture DNS traffic using Wireshark and analyze the packets.</li>
<li>Examine the Zeek (Bro) <code>dns.log</code> file and identify relevant information.</li>
<li>Use passive DNS to research the history of a domain name.</li>
<li>Analyze DNS traffic for suspicious activity.</li>
</ol>
</li>
</ul>
<hr>
<p><strong>7. Module Project/Exercise: Network Forensics Challenge (30 minutes)</strong></p>
<ul>
<li><p><strong>Objective:</strong> Apply the knowledge and skills learned in this module to analyze a PCAP file and identify malicious activity.</p>
</li>
<li><p><strong>Scenario:</strong> You are a threat hunter investigating a potential security incident. You have been provided with a PCAP file containing network traffic from the affected system. Your task is to analyze the PCAP file and identify any malicious activity.</p>
</li>
<li><p><strong>Steps:</strong></p>
<ol>
<li>Download the PCAP file from a provided source (e.g., a link to a capture on Malware-Traffic-Analysis.net).</li>
<li>Use Wireshark, Zeek, Snort/Suricata (if applicable), and any other relevant tools to analyze the PCAP file.</li>
<li>Look for suspicious traffic patterns, malicious domains, malware signatures, and other indicators of compromise.</li>
<li>Document your findings in a report, including:<ul>
<li>A summary of the incident.</li>
<li>A list of the tools and techniques you used.</li>
<li>A description of the malicious activity you identified.</li>
<li>Recommendations for remediation.</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>Example PCAP Resources:</strong></p>
<ul>
<li>Malware-Traffic-Analysis.net: A great resource for PCAP files and malware analysis exercises.</li>
<li>The Zoo: A collection of malware samples and PCAP files.</li>
</ul>
</li>
</ul>
<hr>
<p>This detailed outline and content should provide a solid foundation for understanding and applying network-based threat hunting techniques. Remember to emphasize the hands-on exercises, as practical experience is crucial for developing these skills. Good luck!</p>
<h2 id="file-6-module_5-md">File 6: module_5.md</h2>
<p>Okay, let&#39;s dive deep into <strong>Module 5: Threat Hunting Tools and Techniques (Part 2: Endpoint &amp; Logs)</strong>. This module is crucial because endpoints are often the first point of entry for attackers, and logs provide a treasure trove of information about their activities. We&#39;ll cover how to effectively use tools and techniques to hunt for threats on endpoints and within logs.  I&#39;ll try to break it down in a way that&#39;s both comprehensive and easy to follow.</p>
<p><strong>Module 5: Threat Hunting Tools and Techniques (Part 2: Endpoint &amp; Logs)</strong></p>
<p><strong>Module Objective:</strong> Learn to leverage endpoint-based tools and techniques for detecting malicious activity.</p>
<p><strong>Subtopics:</strong></p>
<ol>
<li><strong>Endpoint Detection and Response (EDR) Solutions:</strong><ul>
<li>Overview of EDR capabilities.</li>
<li>Using EDR tools for threat hunting.</li>
</ul>
</li>
<li><strong>Sysmon:</strong><ul>
<li>Configuring Sysmon for detailed logging.</li>
<li>Analyzing Sysmon logs for suspicious activity.</li>
</ul>
</li>
<li><strong>Windows Event Logs:</strong><ul>
<li>Understanding Windows Event Log structure.</li>
<li>Using PowerShell for Event Log analysis.</li>
</ul>
</li>
<li><strong>Linux Audit Logs:</strong><ul>
<li>Configuring auditd.</li>
<li>Analyzing audit logs for suspicious activity.</li>
</ul>
</li>
<li><strong>SIEM (Security Information and Event Management) Systems:</strong><ul>
<li>Overview of SIEM architecture.</li>
<li>Using SIEM for threat hunting.</li>
</ul>
</li>
<li><strong>Practical Exercises:</strong><ul>
<li>Analyzing Sysmon logs to detect malware execution.</li>
<li>Using PowerShell to query Windows Event Logs.</li>
</ul>
</li>
</ol>
<p><strong>1. Endpoint Detection and Response (EDR) Solutions</strong></p>
<ul>
<li><p><strong>Overview of EDR Capabilities:</strong></p>
<ul>
<li><strong>What is EDR?</strong>  EDR solutions are advanced security tools designed to detect and respond to threats on endpoints. They go beyond traditional antivirus by providing real-time monitoring, behavioral analysis, and automated response capabilities.</li>
<li><strong>Key Features:</strong><ul>
<li><strong>Real-time Monitoring:</strong> Continuously monitors endpoint activity (processes, network connections, file changes, registry modifications).</li>
<li><strong>Behavioral Analysis:</strong>  Identifies suspicious behavior based on predefined rules and machine learning algorithms.  This helps detect anomalies that traditional signature-based AV might miss.</li>
<li><strong>Threat Intelligence Integration:</strong> Correlates endpoint activity with known threat intelligence to identify potential threats.</li>
<li><strong>Automated Response:</strong>  Automatically isolates infected endpoints, terminates malicious processes, and removes malicious files.</li>
<li><strong>Forensic Analysis:</strong>  Provides tools for investigating security incidents and understanding the root cause of attacks.</li>
<li><strong>Endpoint Isolation:</strong> Ability to quickly isolate a compromised endpoint from the network to prevent further spread.</li>
</ul>
</li>
<li><strong>Popular EDR Solutions:</strong> CrowdStrike Falcon, SentinelOne, Carbon Black, Microsoft Defender for Endpoint.  (Note: Access to a full EDR solution requires licensing. We&#39;ll focus on techniques applicable even without a full EDR deployment.)</li>
</ul>
</li>
<li><p><strong>Using EDR Tools for Threat Hunting:</strong></p>
<ul>
<li><strong>Searching for Indicators of Compromise (IoCs):</strong>  EDR tools allow you to search for specific IoCs (IP addresses, domain names, file hashes, registry keys) across all endpoints.</li>
<li><strong>Behavioral Hunting:</strong>  Identify suspicious behavior by searching for specific events or sequences of events.  For example, you might look for processes that are creating child processes with suspicious names or network connections.</li>
<li><strong>Threat Intelligence Integration:</strong>  Leverage the EDR&#39;s threat intelligence feeds to identify potential threats that are targeting your organization.</li>
<li><strong>Example Scenarios:</strong><ul>
<li><strong>Hunting for Lateral Movement:</strong> Look for processes that are accessing network shares or attempting to authenticate to other systems.</li>
<li><strong>Hunting for Malware Execution:</strong>  Look for processes that are creating or modifying files in suspicious locations (e.g., the Startup folder) or that are injecting code into other processes.</li>
<li><strong>Hunting for Command and Control (C2) Activity:</strong>  Look for processes that are communicating with known C2 servers.</li>
</ul>
</li>
<li><strong>Limitations:</strong>  EDR solutions can be expensive and require significant expertise to configure and manage. They also rely on accurate threat intelligence and behavioral analysis rules.</li>
</ul>
</li>
</ul>
<p><strong>2. Sysmon</strong></p>
<ul>
<li><p><strong>Configuring Sysmon for Detailed Logging:</strong></p>
<ul>
<li><strong>What is Sysmon?</strong> Sysmon (System Monitor) is a free Windows system service that logs detailed information about system activity to the Windows Event Log.  It&#39;s a powerful tool for threat hunting and incident response.</li>
<li><strong>Download and Installation:</strong> Download Sysmon from the Microsoft Sysinternals website (<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon">https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon</a>).</li>
<li><strong>Configuration File:</strong> Sysmon is configured using an XML configuration file.  This file specifies which events to log and how to filter them.</li>
<li><strong>Sample Configuration File (sysmonconfig.xml):</strong>  This is a basic example.  You&#39;ll need to customize it for your specific needs.</li>
</ul>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Sysmon</span> <span class="hljs-attr">schemaversion</span>=<span class="hljs-string">"4.82"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">EventFiltering</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">RuleGroup</span> <span class="hljs-attr">name</span>=<span class="hljs-string">""</span> <span class="hljs-attr">groupRelation</span>=<span class="hljs-string">"or"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ProcessCreate</span> <span class="hljs-attr">onmatch</span>=<span class="hljs-string">"include"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">condition</span>=<span class="hljs-string">"end with"</span>&gt;</span>powershell.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Image</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ProcessCreate</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FileCreateTime</span> <span class="hljs-attr">onmatch</span>=<span class="hljs-string">"include"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">condition</span>=<span class="hljs-string">"end with"</span>&gt;</span>powershell.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Image</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">FileCreateTime</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NetworkConnect</span> <span class="hljs-attr">onmatch</span>=<span class="hljs-string">"include"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">condition</span>=<span class="hljs-string">"end with"</span>&gt;</span>powershell.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Image</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">SourcePort</span> <span class="hljs-attr">condition</span>=<span class="hljs-string">"is"</span>&gt;</span>443<span class="hljs-tag">&lt;/<span class="hljs-name">SourcePort</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">NetworkConnect</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">RuleGroup</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">EventFiltering</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Sysmon</span>&gt;</span>
</code></pre>
<ul>
<li><p><strong>Explanation:</strong></p>
<ul>
<li><code>schemaversion</code>: Specifies the Sysmon schema version.</li>
<li><code>EventFiltering</code>:  Defines the rules for filtering events.</li>
<li><code>RuleGroup</code>:  Groups related rules together.  <code>groupRelation=&quot;or&quot;</code> means that any rule in the group can trigger a match.</li>
<li><code>ProcessCreate</code>:  Logs when a new process is created.</li>
<li><code>FileCreateTime</code>: Logs when a file create time is changed. This can be useful for detecting malware that&#39;s trying to hide its presence.</li>
<li><code>NetworkConnect</code>:  Logs when a process makes a network connection.</li>
<li><code>Image</code>:  Specifies the process image name.  <code>condition=&quot;end with&quot;</code> means that the rule will match if the image name ends with the specified value.</li>
<li><code>SourcePort</code>: Specifies the source port of the network connection.</li>
</ul>
</li>
<li><p><strong>Installing Sysmon with the Configuration File:</strong></p>
</li>
</ul>
<pre><code class="lang-powershell">Sysmon64<span class="hljs-selector-class">.exe</span> -<span class="hljs-selector-tag">i</span> sysmonconfig<span class="hljs-selector-class">.xml</span> -accepteula
</code></pre>
<ul>
<li><strong>Key Event Types to Log:</strong><ul>
<li><strong>Event ID 1 (Process Create):</strong>  Logs when a new process is created.  This is essential for tracking process execution and identifying suspicious processes.</li>
<li><strong>Event ID 3 (Network Connection):</strong>  Logs when a process makes a network connection.  This is essential for tracking network communication and identifying C2 activity.</li>
<li><strong>Event ID 5 (Process Terminate):</strong> Logs when a process terminates.  Useful for correlating process creation and termination events.</li>
<li><strong>Event ID 7 (Image Load):</strong> Logs when a driver or DLL is loaded. Useful for detecting malware that is injecting code into other processes.</li>
<li><strong>Event ID 8 (CreateRemoteThread):</strong> Logs when a process creates a thread in another process.  This is often used by malware for code injection.</li>
<li><strong>Event ID 9 (RawAccessRead):</strong> Logs when a process reads directly from the drive. Useful for detecting data exfiltration.</li>
<li><strong>Event ID 10 (ProcessAccess):</strong> Logs when a process access another process.</li>
<li><strong>Event ID 11 (FileCreate):</strong> Logs when a file is created.</li>
<li><strong>Event ID 12, 13, 14 (Registry Events):</strong> Logs registry modifications.  Useful for detecting malware that is modifying registry keys to achieve persistence.</li>
<li><strong>Event ID 15 (FileCreateStreamHash):</strong> Logs the hash of files created.</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Analyzing Sysmon Logs for Suspicious Activity:</strong></p>
<ul>
<li><strong>Location of Sysmon Logs:</strong>  Sysmon logs are stored in the Windows Event Log under <code>Applications and Services Logs\Microsoft\Windows\Sysmon\Operational</code>.</li>
<li><strong>Tools for Analyzing Sysmon Logs:</strong><ul>
<li><strong>Event Viewer:</strong>  The built-in Windows Event Viewer can be used to view and filter Sysmon logs.</li>
<li><strong>PowerShell:</strong>  PowerShell can be used to query and analyze Sysmon logs.</li>
<li><strong>SIEM Systems:</strong>  Sysmon logs can be forwarded to a SIEM system for centralized analysis.</li>
<li><strong>Elasticsearch/Kibana:</strong>  Sysmon logs can be ingested into Elasticsearch and visualized using Kibana.</li>
</ul>
</li>
<li><strong>Example Threat Hunting Scenarios:</strong><ul>
<li><strong>Detecting PowerShell Obfuscation:</strong>  Look for PowerShell processes that are executing commands with unusual characters or that are using the <code>-EncodedCommand</code> parameter.</li>
<li><strong>Detecting Process Injection:</strong>  Look for processes that are creating remote threads in other processes.</li>
<li><strong>Detecting Lateral Movement:</strong>  Look for processes that are accessing network shares or attempting to authenticate to other systems.</li>
<li><strong>Detecting Malware Persistence:</strong>  Look for processes that are creating or modifying registry keys in the <code>Run</code> or <code>RunOnce</code> keys.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>3. Windows Event Logs</strong></p>
<ul>
<li><p><strong>Understanding Windows Event Log Structure:</strong></p>
<ul>
<li><strong>What are Windows Event Logs?</strong> Windows Event Logs are a record of system events, including application errors, security events, and system events. They are a valuable source of information for troubleshooting, auditing, and security monitoring.</li>
<li><strong>Key Event Logs:</strong><ul>
<li><strong>Application:</strong>  Logs events related to applications.</li>
<li><strong>Security:</strong>  Logs security-related events, such as logon attempts, account management events, and object access events.  This is the <em>most</em> relevant log for threat hunting.</li>
<li><strong>System:</strong>  Logs events related to the operating system.</li>
</ul>
</li>
<li><strong>Event Log Structure:</strong> Each event log entry contains the following information:<ul>
<li><strong>Event ID:</strong>  A unique identifier for the event.</li>
<li><strong>Source:</strong>  The component that generated the event.</li>
<li><strong>Time Generated:</strong>  The date and time when the event occurred.</li>
<li><strong>User:</strong>  The user account that was associated with the event.</li>
<li><strong>Computer:</strong>  The computer on which the event occurred.</li>
<li><strong>Description:</strong>  A detailed description of the event.</li>
<li><strong>EventData:</strong>  Structured data associated with the event (e.g., user account names, file paths, IP addresses).</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Using PowerShell for Event Log Analysis:</strong></p>
<ul>
<li><p><strong><code>Get-WinEvent</code> Cmdlet:</strong>  The <code>Get-WinEvent</code> cmdlet is used to query Windows Event Logs.</p>
</li>
<li><p><strong>Example: Get Security Events:</strong></p>
</li>
</ul>
<pre><code class="lang-powershell">Get-W<span class="hljs-keyword">in</span>Event -LogName Security -MaxEvents 10
</code></pre>
<ul>
<li><strong>Example: Filter by Event ID:</strong></li>
</ul>
<pre><code class="lang-powershell">Get-W<span class="hljs-keyword">in</span>Event -LogName Security -FilterXPath <span class="hljs-string">"//Event[System[EventID=4624]]"</span> -MaxEvents 10
</code></pre>
<ul>
<li><p><strong>Explanation:</strong></p>
<ul>
<li><code>-LogName</code>: Specifies the name of the event log to query.</li>
<li><code>-FilterXPath</code>: Specifies an XPath query to filter the events.</li>
<li><code>//Event[System[EventID=4624]]</code>:  An XPath query that selects all events with Event ID 4624 (an account successfully logged on).</li>
<li><code>-MaxEvents</code>: Specifies the maximum number of events to retrieve.</li>
</ul>
</li>
<li><p><strong>Example: Extract Specific Data:</strong></p>
</li>
</ul>
<pre><code class="lang-powershell"><span class="hljs-built_in">Get-WinEvent</span> -LogName Security -FilterXPath <span class="hljs-string">"//Event[System[EventID=4624]]"</span> -MaxEvents <span class="hljs-number">10</span> | <span class="hljs-built_in">ForEach-Object</span> {
    [PSCustomObject]@{
        TimeCreated = <span class="hljs-variable">$_</span>.TimeCreated
        AccountName = <span class="hljs-variable">$_</span>.Properties[<span class="hljs-number">5</span>].Value
        SourceNetworkAddress = <span class="hljs-variable">$_</span>.Properties[<span class="hljs-number">8</span>].Value
    }
}
</code></pre>
<ul>
<li><p><strong>Explanation:</strong></p>
<ul>
<li><code>ForEach-Object</code>: Iterates over each event.</li>
<li><code>[PSCustomObject]</code>:  Creates a custom object with the specified properties.</li>
<li><code>$_.TimeCreated</code>:  Gets the time the event was created.</li>
<li><code>$_.Properties[5].Value</code>:  Gets the value of the 6th property (Account Name).  <strong>Important:</strong> The property index may vary depending on the Event ID.  Inspect the raw event data to determine the correct index.</li>
<li><code>$_.Properties[8].Value</code>: Gets the value of the 9th property (Source Network Address).</li>
</ul>
</li>
<li><p><strong>Common Event IDs for Threat Hunting:</strong></p>
<ul>
<li><strong>4624:</strong>  An account was successfully logged on. (Success Audit)</li>
<li><strong>4625:</strong>  An account failed to log on. (Failure Audit)  Monitor for repeated failed logon attempts, which could indicate a brute-force attack.</li>
<li><strong>4672:</strong>  Special privileges assigned to new logon. (Success Audit)</li>
<li><strong>4688:</strong>  A new process has been created. (Success Audit)  (Similar to Sysmon&#39;s Event ID 1, but less detailed).</li>
<li><strong>4776:</strong>  The domain controller attempted to validate the credentials for an account. (Success Audit) (Kerberos authentication).</li>
<li><strong>4769:</strong>  A Kerberos service ticket was requested. (Success Audit)</li>
</ul>
</li>
<li><p><strong>Example Threat Hunting Scenarios:</strong></p>
<ul>
<li><strong>Detecting Brute-Force Attacks:</strong>  Look for a large number of failed logon attempts (Event ID 4625) from the same source IP address.</li>
<li><strong>Detecting Lateral Movement:</strong>  Look for successful logon events (Event ID 4624) where the logon type is &quot;Network&quot; (LogonType = 3) and the source IP address is different from the user&#39;s usual IP address.</li>
<li><strong>Detecting Account Impersonation:</strong>  Look for successful logon events (Event ID 4624) where the &quot;Logon ID&quot; is the same as a previous failed logon event (Event ID 4625).</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>4. Linux Audit Logs</strong></p>
<ul>
<li><p><strong>Configuring <code>auditd</code>:</strong></p>
<ul>
<li><strong>What is <code>auditd</code>?</strong>  <code>auditd</code> (Audit Daemon) is a Linux subsystem that logs system calls and other security-related events.  It&#39;s the primary source of audit information on Linux systems.</li>
<li><strong>Installation:</strong>  <code>auditd</code> is usually installed by default on most Linux distributions. If not, install it using your distribution&#39;s package manager (e.g., <code>apt-get install auditd</code> on Debian/Ubuntu, <code>yum install auditd</code> on CentOS/RHEL).</li>
<li><strong>Configuration File:</strong> The main configuration file for <code>auditd</code> is <code>/etc/audit/auditd.conf</code>.</li>
<li><strong>Audit Rules:</strong>  Audit rules are defined in <code>/etc/audit/rules.d/audit.rules</code> (or similar location, depending on the distribution).  These rules specify which events to log and how to filter them.</li>
<li><strong>Basic Audit Rule Syntax:</strong></li>
</ul>
<pre><code>-w <span class="hljs-tag">&lt;<span class="hljs-name">path</span>&gt;</span> -p <span class="hljs-tag">&lt;<span class="hljs-name">permissions</span>&gt;</span> -k <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>
</code></pre><ul>
<li><code>-w &lt;path&gt;</code>:  Specifies the path to the file or directory to monitor.</li>
<li><code>-p &lt;permissions&gt;</code>:  Specifies the permissions to monitor (e.g., <code>r</code> for read, <code>w</code> for write, <code>x</code> for execute, <code>a</code> for attribute changes).</li>
<li><p><code>-k &lt;key&gt;</code>:  Specifies a keyword to associate with the rule.  This makes it easier to filter audit logs.</p>
</li>
<li><p><strong>Example: Monitor <code>/etc/passwd</code> for Write Access:</strong></p>
</li>
</ul>
<pre><code>-w /etc/passwd -<span class="hljs-selector-tag">p</span> wa -k passwd_changes
</code></pre><ul>
<li><strong>Example: Monitor Executions of <code>ssh</code>:</strong></li>
</ul>
<pre><code>-a always,<span class="hljs-keyword">exit</span> -F arch=b64 -S execve -F path=<span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/ssh -k ssh_exec</span>
</code></pre><ul>
<li><p><strong>Explanation:</strong></p>
<ul>
<li><code>-a always,exit</code>:  Log the event on every execution and on exit.</li>
<li><code>-F arch=b64</code>:  Specifies the architecture (64-bit).</li>
<li><code>-S execve</code>:  Specifies the system call (execve is used to execute programs).</li>
<li><code>-F path=/usr/bin/ssh</code>:  Specifies the path to the executable.</li>
<li><code>-k ssh_exec</code>:  Specifies the keyword.</li>
</ul>
</li>
<li><p><strong>Reloading Audit Rules:</strong> After modifying the audit rules, reload them using the following command:</p>
</li>
</ul>
<pre><code>auditctl -R <span class="hljs-regexp">/etc/</span>audit<span class="hljs-regexp">/rules.d/</span>audit.rules
</code></pre></li>
<li><p><strong>Analyzing Audit Logs for Suspicious Activity:</strong></p>
<ul>
<li><strong>Location of Audit Logs:</strong>  Audit logs are typically stored in <code>/var/log/audit/audit.log</code>.</li>
<li><strong><code>ausearch</code> Utility:</strong> The <code>ausearch</code> utility is used to query and analyze audit logs.</li>
<li><strong>Example: Search for Events with a Specific Keyword:</strong></li>
</ul>
<pre><code><span class="hljs-attribute">ausearch</span> -k passwd_changes
</code></pre><ul>
<li><strong>Example: Search for Failed Login Attempts:</strong></li>
</ul>
<pre><code>ausearch -m auid!=<span class="hljs-number">4294967295</span> -m user_login,user_auth,user_acct -sc auth
</code></pre><ul>
<li><strong>Example: Search for Executions of <code>ssh</code>:</strong></li>
</ul>
<pre><code><span class="hljs-attribute">ausearch</span> -k ssh_exec
</code></pre><ul>
<li><p><strong>Example Threat Hunting Scenarios:</strong></p>
<ul>
<li><strong>Detecting Unauthorized File Modifications:</strong>  Look for events that indicate that a critical system file (e.g., <code>/etc/passwd</code>, <code>/etc/shadow</code>) has been modified.</li>
<li><strong>Detecting Suspicious Process Executions:</strong>  Look for events that indicate that a suspicious process has been executed (e.g., a process that is not normally run by a particular user).</li>
<li><strong>Detecting Privilege Escalation Attempts:</strong>  Look for events that indicate that a user has attempted to use the <code>sudo</code> command or has changed their user ID.</li>
<li><strong>Detecting SSH Brute-Force Attacks:</strong>  Analyze the logs for failed SSH login attempts.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>5. SIEM (Security Information and Event Management) Systems</strong></p>
<ul>
<li><p><strong>Overview of SIEM Architecture:</strong></p>
<ul>
<li><strong>What is a SIEM?</strong>  A SIEM system is a centralized platform for collecting, analyzing, and managing security logs and events from various sources across an organization.  It provides real-time threat detection, incident response, and compliance reporting.</li>
<li><strong>Key Components:</strong><ul>
<li><strong>Log Collection:</strong>  Collects logs from various sources (e.g., firewalls, intrusion detection systems, servers, endpoints).</li>
<li><strong>Log Parsing and Normalization:</strong>  Parses logs and normalizes the data into a consistent format.</li>
<li><strong>Correlation Engine:</strong>  Analyzes logs and events to identify potential threats.</li>
<li><strong>Alerting:</strong>  Generates alerts when suspicious activity is detected.</li>
<li><strong>Incident Management:</strong>  Provides tools for managing security incidents.</li>
<li><strong>Reporting:</strong>  Generates reports for compliance and security monitoring.</li>
</ul>
</li>
<li><strong>Popular SIEM Solutions:</strong> Splunk, QRadar, ArcSight, Microsoft Sentinel, Sumo Logic.</li>
</ul>
</li>
<li><p><strong>Using SIEM for Threat Hunting:</strong></p>
<ul>
<li><strong>Centralized Log Management:</strong>  SIEM systems provide a centralized repository for all security logs, making it easier to search for and analyze data.</li>
<li><strong>Correlation Rules:</strong>  SIEM systems allow you to create correlation rules that identify suspicious activity based on patterns of events.</li>
<li><strong>Threat Intelligence Integration:</strong>  SIEM systems integrate with threat intelligence feeds to identify potential threats that are targeting your organization.</li>
<li><strong>Behavioral Analysis:</strong>  Some SIEM systems provide behavioral analysis capabilities that can identify anomalies in user and system behavior.</li>
<li><strong>Example Threat Hunting Scenarios:</strong><ul>
<li><strong>Detecting Lateral Movement:</strong>  Look for users who are logging in to multiple systems in a short period of time.</li>
<li><strong>Detecting Data Exfiltration:</strong>  Look for large amounts of data being transferred to external IP addresses.</li>
<li><strong>Detecting Malware Infections:</strong>  Look for processes that are communicating with known C2 servers.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>6. Practical Exercises</strong></p>
<ul>
<li><p><strong>Analyzing Sysmon Logs to Detect Malware Execution:</strong></p>
<ul>
<li><strong>Scenario:</strong> A user has reported that their computer is behaving strangely. You suspect that it may be infected with malware.</li>
<li><strong>Steps:</strong><ol>
<li><strong>Examine Sysmon Event ID 1 (Process Create):</strong>  Look for processes that are being created from unusual locations (e.g., the Temp folder) or that have suspicious names.</li>
<li><strong>Examine Sysmon Event ID 7 (Image Load):</strong> Look for processes loading DLLs from unusual locations.</li>
<li><strong>Examine Sysmon Event ID 3 (Network Connection):</strong>  Look for processes that are making network connections to suspicious IP addresses or domain names.</li>
<li><strong>Correlate Events:</strong>  Correlate events to identify patterns of activity that may indicate malware execution. For example, look for a process that is created from the Temp folder, loads a DLL from a suspicious location, and then makes a network connection to a known C2 server.</li>
<li><strong>Investigate:</strong> If you find suspicious activity, investigate the process further to determine if it is malicious. You can use tools like VirusTotal to check the file hash of the process.</li>
</ol>
</li>
</ul>
</li>
<li><p><strong>Using PowerShell to Query Windows Event Logs:</strong></p>
<ul>
<li><strong>Scenario:</strong> You want to identify all users who have logged in to a specific computer in the last 24 hours.</li>
<li><p><strong>Steps:</strong></p>
<pre><code class="lang-powershell"><span class="hljs-variable">$StartTime</span> = (<span class="hljs-built_in">Get-Date</span>).AddDays(-<span class="hljs-number">1</span>)
<span class="hljs-built_in">Get-WinEvent</span> -LogName Security -FilterXPath <span class="hljs-string">"//Event[System[EventID=4624 and TimeCreated &gt;= '$(<span class="hljs-variable">$StartTime</span>.ToString('yyyy-MM-ddTHH:mm:ss'))']]"</span> | <span class="hljs-built_in">ForEach-Object</span> {
    [PSCustomObject]@{
        TimeCreated = <span class="hljs-variable">$_</span>.TimeCreated
        AccountName = <span class="hljs-variable">$_</span>.Properties[<span class="hljs-number">5</span>].Value
    }
}
</code></pre>
</li>
<li><p><strong>Explanation:</strong></p>
<ol>
<li><code>$StartTime = (Get-Date).AddDays(-1)</code>:  Calculates the start time (24 hours ago).</li>
<li><code>Get-WinEvent -LogName Security -FilterXPath &quot;//Event[System[EventID=4624 and TimeCreated &gt;= &#39;$($StartTime.ToString(&#39;yyyy-MM-ddTHH:mm:ss&#39;))&#39;]]&quot;</code>:  Queries the Security event log for successful logon events (Event ID 4624) that occurred within the last 24 hours.  The <code>TimeCreated</code> comparison in the XPath query is crucial for filtering by time.</li>
<li><code>ForEach-Object { ... }</code>: Iterates through the results and creates a custom object for each event, displaying the TimeCreated and AccountName.</li>
</ol>
</li>
</ul>
</li>
</ul>
<p><strong>Key Takeaways for Module 5:</strong></p>
<ul>
<li>Endpoints and logs are crucial sources of information for threat hunting.</li>
<li>EDR solutions provide advanced capabilities for detecting and responding to threats on endpoints.</li>
<li>Sysmon is a powerful tool for logging detailed system activity on Windows systems.</li>
<li>Windows Event Logs and Linux Audit Logs provide a wealth of information about system events.</li>
<li>SIEM systems provide a centralized platform for collecting, analyzing, and managing security logs and events.</li>
<li>PowerShell and <code>ausearch</code> are valuable tools for querying and analyzing event logs.</li>
<li>Understanding common threat hunting scenarios and techniques is essential for effective threat hunting.</li>
</ul>
<p>This detailed breakdown should give you a solid understanding of Module 5. Remember to practice these techniques in a lab environment to gain hands-on experience. Good luck, and happy hunting! Let me know if you want more details on any of these topics.</p>
<h2 id="file-7-module_6-md">File 7: module_6.md</h2>
<p>Okay, let&#39;s dive deep into Module 6: Data Analysis Techniques for Threat Hunting. We&#39;ll cover each subtopic with detailed explanations, practical examples, and code snippets.</p>
<p><strong>Module 6: Data Analysis Techniques for Threat Hunting</strong></p>
<p><strong>Module Objective:</strong> Master essential data analysis techniques for identifying and understanding threats.</p>
<p><strong>Introduction:</strong></p>
<p>Data analysis is the backbone of effective threat hunting. It&#39;s about sifting through massive amounts of data to find subtle anomalies that indicate malicious activity. This module will provide you with the tools and techniques to do just that. We&#39;ll focus on practical application using common tools and methodologies.  Think of it as learning to &quot;speak data&quot; so you can understand what your logs and network traffic are <em>really</em> telling you.</p>
<p><strong>Subtopic 1: Basic Search and Filtering</strong></p>
<ul>
<li><p><strong>Concept:</strong> The foundation of any analysis is the ability to quickly find relevant data.  Knowing how to efficiently search and filter allows you to narrow down your focus and avoid being overwhelmed by noise.</p>
</li>
<li><p><strong>Explanation:</strong> This involves using search operators (AND, OR, NOT), wildcards, and filters to isolate specific events or patterns within your data.  The specific syntax will vary depending on the tool you&#39;re using.</p>
</li>
<li><p><strong>Examples:</strong></p>
<ul>
<li><p><strong>Linux (Command Line - <code>grep</code>):</strong></p>
<pre><code class="lang-bash"># Find <span class="hljs-keyword">all</span> lines in auth.<span class="hljs-built_in">log</span> containing <span class="hljs-string">"failed password"</span>
<span class="hljs-keyword">grep</span> <span class="hljs-string">"failed password"</span> /var/<span class="hljs-built_in">log</span>/auth.<span class="hljs-built_in">log</span>

# Find <span class="hljs-keyword">all</span> lines containing <span class="hljs-string">"failed password"</span> from <span class="hljs-keyword">a</span> specific IP address (<span class="hljs-keyword">e</span>.g., <span class="hljs-number">192.168</span>.<span class="hljs-number">1.100</span>)
<span class="hljs-keyword">grep</span> <span class="hljs-string">"failed password"</span> /var/<span class="hljs-built_in">log</span>/auth.<span class="hljs-built_in">log</span> | <span class="hljs-keyword">grep</span> <span class="hljs-string">"192.168.1.100"</span>

# Find <span class="hljs-keyword">all</span> lines containing <span class="hljs-string">"failed password"</span> but NOT containing <span class="hljs-string">"invalid user"</span>
<span class="hljs-keyword">grep</span> <span class="hljs-string">"failed password"</span> /var/<span class="hljs-built_in">log</span>/auth.<span class="hljs-built_in">log</span> | <span class="hljs-keyword">grep</span> -v <span class="hljs-string">"invalid user"</span> # -v inverts the <span class="hljs-keyword">match</span>
</code></pre>
</li>
<li><p><strong>Windows (PowerShell - <code>Select-String</code>):</strong></p>
<pre><code class="lang-powershell"># Find <span class="hljs-keyword">all</span> lines in the <span class="hljs-keyword">System</span> event <span class="hljs-built-in">log</span> containing <span class="hljs-string">"error"</span>
Get-WinEvent -LogName <span class="hljs-keyword">System</span> | Where-Object {<span class="hljs-symbol">$</span>_.Message -like <span class="hljs-string">"*error*"</span>}

# Find <span class="hljs-keyword">all</span> lines in the <span class="hljs-keyword">System</span> event <span class="hljs-built-in">log</span> containing <span class="hljs-string">"error"</span> from a specific source (e.g., <span class="hljs-string">"Application Error"</span>)
Get-WinEvent -LogName <span class="hljs-keyword">System</span> | Where-Object {<span class="hljs-symbol">$</span>_.Message -like <span class="hljs-string">"*error*"</span> -<span class="hljs-keyword">and</span> <span class="hljs-symbol">$</span>_.ProviderName -like <span class="hljs-string">"*Application Error*"</span>}
</code></pre>
</li>
<li><p><strong>Splunk (SPL):</strong></p>
<pre><code class="lang-splunk"># Find all events <span class="hljs-keyword">in</span> the <span class="hljs-string">"index=main"</span> containing <span class="hljs-string">"failed password"</span>
index=main <span class="hljs-string">"failed password"</span>

# Find all events <span class="hljs-keyword">in</span> the <span class="hljs-string">"index=main"</span> containing <span class="hljs-string">"failed password"</span> from a specific <span class="hljs-built_in">IP</span> address (e.g., <span class="hljs-number">192.168</span><span class="hljs-meta">.1</span><span class="hljs-meta">.100</span>)
index=main <span class="hljs-string">"failed password"</span> <span class="hljs-number">192.168</span><span class="hljs-meta">.1</span><span class="hljs-meta">.100</span>

#Find all events <span class="hljs-keyword">in</span> the <span class="hljs-string">"index=main"</span> containing <span class="hljs-string">"failed password"</span> but <span class="hljs-keyword">not</span> <span class="hljs-string">"invalid user"</span>
index=main <span class="hljs-string">"failed password"</span> <span class="hljs-keyword">NOT</span> <span class="hljs-string">"invalid user"</span>
</code></pre>
</li>
<li><p><strong>Azure Sentinel (KQL):</strong></p>
<pre><code class="lang-kql"><span class="hljs-comment">// Find all events in the SecurityEvent table containing EventID 4625 (failed login)</span>
SecurityEvent
| <span class="hljs-built_in">where</span> EventID == <span class="hljs-number">4625</span>

<span class="hljs-comment">// Find all events in the SecurityEvent table containing EventID 4625 from a specific source IP (e.g., 192.168.1.100)</span>
SecurityEvent
| <span class="hljs-built_in">where</span> EventID == <span class="hljs-number">4625</span> <span class="hljs-keyword">and</span> IpAddress == <span class="hljs-string">"192.168.1.100"</span>

<span class="hljs-comment">// Find all events in the SecurityEvent table containing EventID 4625 but not involving a specific user (e.g., "Administrator")</span>
SecurityEvent
| <span class="hljs-built_in">where</span> EventID == <span class="hljs-number">4625</span> <span class="hljs-keyword">and</span> AccountName != <span class="hljs-string">"Administrator"</span>
</code></pre>
</li>
</ul>
</li>
<li><p><strong>Key Takeaways:</strong></p>
<ul>
<li>Master your tool&#39;s specific syntax for search operators and filters.</li>
<li>Use specific keywords and field names to narrow your search.</li>
<li>Don&#39;t be afraid to chain multiple filters together to refine your results.</li>
</ul>
</li>
</ul>
<p><strong>Subtopic 2: Grouping and Counting</strong></p>
<ul>
<li><p><strong>Concept:</strong>  Grouping and counting allows you to identify patterns and trends by summarizing data.  Instead of looking at individual events, you look at aggregate data to find anomalies.</p>
</li>
<li><p><strong>Explanation:</strong> This involves grouping data based on a specific field (e.g., IP address, user account, event type) and then counting the occurrences within each group.  This can reveal unusual activity that might be missed when looking at individual events.</p>
</li>
<li><p><strong>Examples:</strong></p>
<ul>
<li><p><strong>Linux (Command Line - <code>awk</code> and <code>sort</code>):</strong></p>
<pre><code class="lang-bash"># <span class="hljs-keyword">Count</span> the number of failed login attempts per IP address <span class="hljs-keyword">in</span> auth.<span class="hljs-built_in">log</span>
awk '/Failed password/ {<span class="hljs-keyword">print</span> <span class="hljs-variable">$11}</span>' /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/auth.<span class="hljs-keyword">log</span> | <span class="hljs-keyword">sort</span> | uniq -c | <span class="hljs-keyword">sort</span> -nr

# Explanation:
#   awk '/Failed password/ {<span class="hljs-keyword">print</span> <span class="hljs-variable">$11}</span>' /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/auth.<span class="hljs-keyword">log</span>:  Finds lines containing <span class="hljs-string">"Failed password"</span> and prints the 11th field (typically the IP address).
#   <span class="hljs-keyword">sort</span>: Sorts the IP addresses.
#   uniq -c: Counts the number of unique occurrences of each IP address.
#   <span class="hljs-keyword">sort</span> -nr: Sorts the results numerically <span class="hljs-keyword">in</span> reverse <span class="hljs-keyword">order</span> (highest <span class="hljs-keyword">count</span> first).
</code></pre>
</li>
<li><p><strong>Windows (PowerShell - <code>Group-Object</code>):</strong></p>
<pre><code class="lang-powershell"><span class="hljs-comment"># Count the number of events per EventID in the System event log</span>
Get-WinEvent -LogName System | Group-Object -<span class="hljs-keyword">Property</span><span class="hljs-title"> </span>ID | Sort-Object -<span class="hljs-keyword">Property</span><span class="hljs-title"> </span>Count -Descending
</code></pre>
</li>
<li><p><strong>Splunk (SPL):</strong></p>
<pre><code class="lang-splunk"><span class="hljs-comment"># Count the number of events per source IP address</span>
index=main | stats <span class="hljs-built_in">count</span> <span class="hljs-keyword">by</span> src_ip

<span class="hljs-comment"># Count the number of failed login attempts per user</span>
index=main <span class="hljs-string">"failed password"</span> | stats <span class="hljs-built_in">count</span> <span class="hljs-keyword">by</span> user
</code></pre>
</li>
<li><p><strong>Azure Sentinel (KQL):</strong></p>
<pre><code class="lang-kql"><span class="hljs-comment">// Count the number of events per EventID in the SecurityEvent table</span>
SecurityEvent
| <span class="hljs-keyword">summarize</span> <span class="hljs-keyword">count</span>() <span class="hljs-keyword">by</span> EventID
| <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> count_ <span class="hljs-keyword">desc</span>

<span class="hljs-comment">// Count the number of failed login attempts per account</span>
SigninLogs
| where ResultType == <span class="hljs-string">"50057"</span> <span class="hljs-comment">// Failure code for invalid username</span>
| <span class="hljs-keyword">summarize</span> <span class="hljs-keyword">count</span>() <span class="hljs-keyword">by</span> UserPrincipalName
| <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> count_ <span class="hljs-keyword">desc</span>
</code></pre>
</li>
</ul>
</li>
<li><p><strong>Key Takeaways:</strong></p>
<ul>
<li>Identify fields that are relevant for grouping (e.g., IP address, username, event ID).</li>
<li>Use grouping and counting to find outliers and unusual patterns.</li>
<li>Sort the results to easily identify the most frequent or least frequent occurrences.</li>
</ul>
</li>
</ul>
<p><strong>Subtopic 3: Link Analysis</strong></p>
<ul>
<li><p><strong>Concept:</strong>  Link analysis helps visualize relationships between different entities in your data.  This can reveal hidden connections and dependencies that are not immediately obvious.</p>
</li>
<li><p><strong>Explanation:</strong> This involves creating a graph or network diagram where nodes represent entities (e.g., IP addresses, users, files) and edges represent relationships between them (e.g., connection, file access, process execution).</p>
</li>
<li><p><strong>Tools:</strong></p>
<ul>
<li><strong>Maltego:</strong> A powerful commercial tool for link analysis.  It allows you to gather information from various sources and visualize relationships in a graph. (Requires a paid license for full functionality, but a community edition exists with limitations.)</li>
<li><strong>Neo4j:</strong> A graph database that can be used for storing and analyzing relationships between entities. (Requires some setup and knowledge of the Cypher query language.)</li>
<li><strong>Open Source Alternatives:</strong>  There are Python libraries like <code>NetworkX</code> that can be used for building and visualizing graphs, but they require more coding.</li>
</ul>
</li>
<li><p><strong>Example (Conceptual - Maltego):</strong></p>
<ol>
<li><strong>Start with a known IP address (e.g., a suspicious C&amp;C server).</strong></li>
<li><strong>Use Maltego transforms to:</strong><ul>
<li>Find other IP addresses that have communicated with the initial IP.</li>
<li>Identify domain names associated with the IP.</li>
<li>Find email addresses or user accounts that have interacted with those domains.</li>
</ul>
</li>
<li><strong>Visualize the relationships:</strong> Maltego will create a graph showing the connections between these entities.  You might discover a cluster of infected hosts communicating with the same C&amp;C server.</li>
</ol>
</li>
<li><p><strong>Example (Conceptual - Neo4j):</strong></p>
<ol>
<li><p><strong>Import your data into Neo4j:</strong> This might involve parsing logs and creating nodes and relationships in the database.  For example:</p>
<pre><code class="lang-cypher">// Create a <span class="hljs-keyword">node</span> <span class="hljs-title">for</span> an IP address
CREATE (ip:IP {address: <span class="hljs-string">"192.168.1.100"</span>})

// Create a <span class="hljs-keyword">node</span> <span class="hljs-title">for</span> a <span class="hljs-keyword">user</span> <span class="hljs-title">account</span>
CREATE (user:<span class="hljs-keyword">User</span> <span class="hljs-title">{username</span>: <span class="hljs-string">"john.doe"</span>})

// Create a relationship between the IP address <span class="hljs-keyword">and</span> the <span class="hljs-keyword">user</span> <span class="hljs-title">(e</span>.g., the <span class="hljs-keyword">user</span> <span class="hljs-title">logged</span> <span class="hljs-keyword">in</span> from that IP)
CREATE (user)-[:LOGGED_IN_FROM]-&gt;(ip)
</code></pre>
</li>
<li><p><strong>Query the graph to find relationships:</strong></p>
<pre><code class="lang-cypher">// Find all IP addresses that a specific <span class="hljs-keyword">user</span> <span class="hljs-title">has</span> logged <span class="hljs-keyword">in</span> from
MATCH (user:<span class="hljs-keyword">User</span> <span class="hljs-title">{username</span>: <span class="hljs-string">"john.doe"</span>})-[:LOGGED_IN_FROM]-&gt;(ip:IP)
RETURN ip.address
</code></pre>
</li>
</ol>
</li>
<li><p><strong>Key Takeaways:</strong></p>
<ul>
<li>Link analysis is powerful for uncovering hidden relationships.</li>
<li>Consider using tools like Maltego or Neo4j for more complex analysis.</li>
<li>Start with a known entity (e.g., a suspicious IP) and explore its connections.</li>
</ul>
</li>
</ul>
<p><strong>Subtopic 4: Hunting and Query Languages (e.g., KQL in Azure Sentinel, SPL in Splunk)</strong></p>
<ul>
<li><p><strong>Concept:</strong> Learn to write efficient queries to search for specific patterns and anomalies within your data.</p>
</li>
<li><p><strong>Explanation:</strong> Each SIEM or log management platform has its own query language.  Mastering these languages is crucial for effective threat hunting.  We&#39;ll focus on KQL (Azure Sentinel) and SPL (Splunk) as examples.</p>
</li>
<li><p><strong>Examples:</strong></p>
<ul>
<li><p><strong>Splunk (SPL):</strong></p>
<pre><code class="lang-splunk"># Find all events <span class="hljs-keyword">where</span> a user logged <span class="hljs-built_in">in</span> from a different country than usual
index=main eventtype=authentication
| <span class="hljs-type">geoip</span> src_ip <span class="hljs-built_in">field</span>=src_ip
| <span class="hljs-type">stats</span> mode(country) <span class="hljs-built_in">as</span> usual_country <span class="hljs-built_in">by</span> user
| <span class="hljs-type">where</span> country != usual_country
</code></pre>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>index=main eventtype=authentication</code>:  Searches for authentication events in the main index.</li>
<li><code>geoip src_ip field=src_ip</code>:  Adds geographic information based on the source IP address.</li>
<li><code>stats mode(country) as usual_country by user</code>:  Calculates the most frequent country for each user.</li>
<li><code>where country != usual_country</code>:  Filters for events where the current country is different from the user&#39;s usual country.</li>
</ul>
</li>
<li><p><strong>Azure Sentinel (KQL):</strong></p>
<pre><code class="lang-kql"><span class="hljs-comment">// Find all events where a user logged in from a different country than usual</span>
SigninLogs
| evaluate bag_unpack(LocationDetails) <span class="hljs-comment">// Unpack the LocationDetails column</span>
| <span class="hljs-keyword">summarize</span> arg_max(TimeGenerated, *) <span class="hljs-keyword">by</span> UserPrincipalName
| extend Country = <span class="hljs-keyword">tostring</span>(parse_json(<span class="hljs-keyword">tostring</span>(LocationDetails)).countryOrRegion)
| <span class="hljs-keyword">summarize</span> make_set(Country) <span class="hljs-keyword">by</span> UserPrincipalName
| where arraylength(set_Country) &gt; 1
</code></pre>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>SigninLogs</code>:  Specifies the SigninLogs table.</li>
<li><code>evaluate bag_unpack(LocationDetails)</code>:  Unpacks the JSON in the <code>LocationDetails</code> column into individual columns.</li>
<li><code>summarize arg_max(TimeGenerated, *) by UserPrincipalName</code>:  Gets the most recent sign-in event for each user.</li>
<li><code>extend Country = tostring(parse_json(tostring(LocationDetails)).countryOrRegion)</code>: Extracts the country from the LocationDetails JSON.</li>
<li><code>summarize make_set(Country) by UserPrincipalName</code>:  Creates a set of countries for each user.</li>
<li><code>where arraylength(set_Country) &gt; 1</code>:  Filters for users who have logged in from more than one country.</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Key Takeaways:</strong></p>
<ul>
<li>Learn the specific syntax and functions of your chosen query language.</li>
<li>Break down complex queries into smaller, more manageable steps.</li>
<li>Use functions like <code>geoip</code>, <code>stats</code>, <code>summarize</code>, and <code>where</code> to filter and aggregate data.</li>
</ul>
</li>
</ul>
<p><strong>Subtopic 5: Pattern Matching</strong></p>
<ul>
<li><p><strong>Concept:</strong> Using regular expressions (regex) to identify malicious patterns in your data.</p>
</li>
<li><p><strong>Explanation:</strong> Regular expressions are a powerful way to search for complex patterns in text. They are essential for identifying things like malicious URLs, file paths, or command-line arguments.</p>
</li>
<li><p><strong>Examples:</strong></p>
<ul>
<li><p><strong>Linux (Command Line - <code>grep -E</code>):</strong></p>
<pre><code class="lang-bash"><span class="hljs-comment"># Find all URLs in a log file</span>
grep -E <span class="hljs-string">"https?://[a-zA-Z0-9.-]+.[a-zA-Z]{2,}/?"</span> /var/<span class="hljs-built_in">log</span>/apache2/access.<span class="hljs-built_in">log</span>

<span class="hljs-comment">#Explanation:</span>
<span class="hljs-comment">#   -E: Enables extended regular expressions</span>
<span class="hljs-comment">#   https?://: Matches "http://" or "https://"</span>
<span class="hljs-comment">#   [a-zA-Z0-9.-]+: Matches one or more alphanumeric characters, dots, or hyphens (the domain name)</span>
<span class="hljs-comment">#   .[a-zA-Z]{2,}: Matches a dot followed by a top-level domain (e.g., .com, .org)</span>
<span class="hljs-comment">#   /? :  Optionally matches a trailing slash.</span>
</code></pre>
</li>
<li><p><strong>Windows (PowerShell - <code>Select-String -Pattern</code>):</strong></p>
<pre><code class="lang-powershell"># Find all email addresses in a text file
Get-Content C:<span class="hljs-tag">\<span class="hljs-name">data</span></span><span class="hljs-tag">\<span class="hljs-name">emails</span></span>.txt | Select-String -Pattern "<span class="hljs-tag">\<span class="hljs-name">b</span><span class="hljs-string">[A-Za-z0-9._%+-]</span></span>+@[A-Za-z0-9.-]+<span class="hljs-tag">\<span class="hljs-name">.</span><span class="hljs-string">[A-Z|a-z]</span><span class="hljs-string">{2,}</span></span><span class="hljs-tag">\<span class="hljs-name">b</span></span>"
</code></pre>
</li>
<li><p><strong>Splunk (SPL):</strong></p>
<pre><code class="lang-splunk"># Find all events containing a suspicious file path (e.g., in the Temp directory)
index=main | regex _raw=<span class="hljs-string">"C:<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>Users<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>.*<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>AppData<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>Local<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>Temp<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>.*\.exe"</span>
</code></pre>
</li>
<li><p><strong>Azure Sentinel (KQL):</strong></p>
<pre><code class="lang-kql"><span class="hljs-comment">// Find all events containing a suspicious file path (e.g., in the Temp directory)</span>
SecurityEvent
| where CommandLine has regex <span class="hljs-string">"C:<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>Users<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>.*<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>AppData<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>Local<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>Temp<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>.*<span class="hljs-subst">\\</span>.exe"</span>
</code></pre>
</li>
</ul>
</li>
<li><p><strong>Key Takeaways:</strong></p>
<ul>
<li>Learn the basics of regular expression syntax (characters, quantifiers, character classes).</li>
<li>Use online regex testers to experiment and refine your patterns.</li>
<li>Start with simple patterns and gradually increase complexity.</li>
<li>Escape special characters properly in your regex.</li>
</ul>
</li>
</ul>
<p><strong>Subtopic 6: Timelines</strong></p>
<ul>
<li><p><strong>Concept:</strong> Creating a chronological sequence of events to understand the progression of an attack.</p>
</li>
<li><p><strong>Explanation:</strong>  Timelines help you visualize the order in which events occurred, making it easier to identify the root cause of an incident and understand the attacker&#39;s actions.</p>
</li>
<li><p><strong>Tools:</strong></p>
<ul>
<li><strong>Timeline Explorer (Windows):</strong> A free tool from Microsoft for visualizing event logs as timelines.</li>
<li><strong>Plaso (log2timeline):</strong> A powerful open-source tool for creating timelines from various data sources.</li>
<li><strong>SIEM Dashboards:</strong> Many SIEMs have built-in timeline visualization capabilities.</li>
</ul>
</li>
<li><p><strong>Example (Conceptual - Using Timeline Explorer):</strong></p>
<ol>
<li><strong>Load a Windows Event Log (.evtx file) into Timeline Explorer.</strong></li>
<li><strong>Filter the events to focus on specific Event IDs or keywords (e.g., Event ID 4624 - Successful Logon).</strong></li>
<li><strong>Sort the events by time.</strong></li>
<li><strong>Analyze the sequence of events:</strong> Look for patterns or anomalies, such as:<ul>
<li>A series of failed login attempts followed by a successful login.</li>
<li>A user account logging in from multiple locations in a short period of time.</li>
<li>The execution of a suspicious process shortly after a successful login.</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>Example (Conceptual - Using Plaso):</strong></p>
<ol>
<li><p><strong>Run Plaso to create a timeline from multiple data sources (e.g., Windows Event Logs, web server logs, file system metadata):</strong></p>
<pre><code class="lang-bash">log2timeline<span class="hljs-selector-class">.py</span> --storage-file timeline<span class="hljs-selector-class">.plaso</span> /path/to/data
</code></pre>
</li>
<li><p><strong>Analyze the timeline using psort.py:</strong></p>
<pre><code class="lang-bash">psort<span class="hljs-selector-class">.py</span> -o l2tcsv -w output<span class="hljs-selector-class">.csv</span> timeline.plaso
</code></pre>
</li>
<li><p><strong>Open the output.csv file in a spreadsheet program and analyze the events by time.</strong></p>
</li>
</ol>
</li>
<li><p><strong>Key Takeaways:</strong></p>
<ul>
<li>Timelines are crucial for understanding the sequence of events in an attack.</li>
<li>Use tools like Timeline Explorer or Plaso to create timelines from various data sources.</li>
<li>Look for patterns and anomalies in the timeline to identify suspicious activity.</li>
</ul>
</li>
</ul>
<p><strong>Subtopic 7: Statistical Metrics</strong></p>
<ul>
<li><p><strong>Concept:</strong> Applying statistical analysis to identify anomalies and outliers in your data.</p>
</li>
<li><p><strong>Explanation:</strong>  This involves calculating metrics like averages, standard deviations, and percentiles to identify data points that deviate significantly from the norm.</p>
</li>
<li><p><strong>Examples:</strong></p>
<ul>
<li><p><strong>Splunk (SPL):</strong></p>
<pre><code class="lang-splunk"><span class="hljs-comment"># Calculate the average number of bytes sent per host</span>
index=main | stats <span class="hljs-built_in">avg</span>(bytes_sent) <span class="hljs-keyword">as</span> avg_bytes <span class="hljs-keyword">by</span> host

<span class="hljs-comment"># Identify hosts that sent significantly more bytes than average (e.g., more than 2 standard deviations above the mean)</span>
index=main | stats <span class="hljs-built_in">avg</span>(bytes_sent) <span class="hljs-keyword">as</span> avg_bytes, stdev(bytes_sent) <span class="hljs-keyword">as</span> stdev_bytes <span class="hljs-keyword">by</span> host
| where bytes_sent &gt; (avg_bytes + <span class="hljs-number">2</span>*stdev_bytes)
</code></pre>
</li>
<li><p><strong>Azure Sentinel (KQL):</strong></p>
<pre><code class="lang-kql"><span class="hljs-comment">// Calculate the average number of bytes sent per host</span>
NetworkTraffic
| summarize avg(<span class="hljs-built_in">Bytes</span>) <span class="hljs-keyword">by</span> SrcIP

<span class="hljs-comment">// Identify hosts that sent significantly more bytes than average (e.g., more than 2 standard deviations above the mean)</span>
<span class="hljs-keyword">let</span> avgBytes = NetworkTraffic | summarize avg(<span class="hljs-built_in">Bytes</span>);
<span class="hljs-keyword">let</span> stdevBytes = NetworkTraffic | summarize stdev(<span class="hljs-built_in">Bytes</span>);
NetworkTraffic
| <span class="hljs-keyword">where</span> <span class="hljs-built_in">Bytes</span> &gt; (tolong(avgBytes) + <span class="hljs-number">2</span>*tolong(stdevBytes))
</code></pre>
</li>
</ul>
</li>
<li><p><strong>Key Takeaways:</strong></p>
<ul>
<li>Identify metrics that are relevant to your analysis (e.g., bytes sent, login attempts, CPU usage).</li>
<li>Calculate averages, standard deviations, and other statistical measures.</li>
<li>Use these metrics to identify outliers and anomalies.</li>
</ul>
</li>
</ul>
<p><strong>Subtopic 8: Data Aggregation</strong></p>
<ul>
<li><p><strong>Concept:</strong> Combining data from multiple sources to gain a more complete and contextual understanding of an event.</p>
</li>
<li><p><strong>Explanation:</strong>  Threat hunting often requires correlating information from different logs, network traffic, and endpoint data. Data aggregation allows you to bring these disparate sources together to create a more holistic view.</p>
</li>
<li><p><strong>Examples:</strong></p>
<ul>
<li><p><strong>Scenario:</strong> Investigating a suspicious login event.</p>
</li>
<li><p><strong>Data Sources:</strong></p>
<ul>
<li>Authentication logs (e.g., Windows Event Logs, Linux auth.log)</li>
<li>Network traffic logs (e.g., NetFlow, Zeek logs)</li>
<li>Endpoint logs (e.g., Sysmon logs)</li>
</ul>
</li>
<li><p><strong>Aggregation Steps:</strong></p>
<ol>
<li><strong>Identify the user account and timestamp of the suspicious login event from the authentication logs.</strong></li>
<li><strong>Search the network traffic logs for connections originating from the IP address associated with the login event around the same time.</strong></li>
<li><strong>Search the endpoint logs on the host associated with the login event for any process executions or file modifications that occurred shortly after the login.</strong></li>
</ol>
</li>
<li><p><strong>Tools:</strong> SIEMs are specifically designed for data aggregation and correlation.</p>
</li>
</ul>
</li>
<li><p><strong>Key Takeaways:</strong></p>
<ul>
<li>Identify the different data sources that are relevant to your investigation.</li>
<li>Correlate events based on common fields (e.g., IP address, username, timestamp).</li>
<li>Use a SIEM or other data aggregation tool to automate the process.</li>
</ul>
</li>
</ul>
<p><strong>Subtopic 9: Frequency Analysis</strong></p>
<ul>
<li><p><strong>Concept:</strong> Determining the number of times a specific event occurs within a certain timeframe.</p>
</li>
<li><p><strong>Explanation:</strong> It helps in identifying unusual spikes or dips in event occurrences that may indicate malicious activity. For example, a sudden increase in failed login attempts or a surge in network traffic to a specific IP address.</p>
</li>
<li><p><strong>Examples:</strong></p>
<ul>
<li><p><strong>Linux (Command Line):</strong></p>
<pre><code class="lang-bash"># <span class="hljs-keyword">Count</span> the number of SSH login attempts per minute
<span class="hljs-keyword">cat</span> /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/auth.<span class="hljs-keyword">log</span> | grep <span class="hljs-string">"Accepted publickey"</span> | awk '{<span class="hljs-keyword">print</span> <span class="hljs-built_in">substr</span>(<span class="hljs-variable">$1</span>,1,16)}' | <span class="hljs-keyword">sort</span> | uniq -c | <span class="hljs-keyword">sort</span> -nr
</code></pre>
</li>
<li><p><strong>Splunk (SPL):</strong></p>
<pre><code class="lang-splunk"># <span class="hljs-built_in">Count</span> the <span class="hljs-keyword">number</span> of events by <span class="hljs-keyword">type</span> <span class="hljs-keyword">in</span> the last <span class="hljs-number">24</span> hours
<span class="hljs-built_in">index</span>=main | timechart <span class="hljs-built_in">count</span> by eventtype
</code></pre>
</li>
<li><p><strong>Azure Sentinel (KQL):</strong></p>
<pre><code class="lang-kql">// Count <span class="hljs-keyword">the</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> events <span class="hljs-keyword">by</span> type over <span class="hljs-built_in">time</span>
SecurityEvent
| summarize count() <span class="hljs-keyword">by</span> EventID, bin(TimeGenerated, <span class="hljs-number">1</span>h)
| render timechart
</code></pre>
</li>
</ul>
</li>
<li><p><strong>Key Takeaways:</strong></p>
<ul>
<li>Useful for identifying sudden spikes or dips in event occurrences.</li>
<li>Can be combined with other analysis techniques for more accurate threat detection.</li>
</ul>
</li>
</ul>
<p><strong>Subtopic 10: Distribution Analysis</strong></p>
<ul>
<li><p><strong>Concept:</strong> Analyzing how data is distributed to identify outliers or anomalies.</p>
</li>
<li><p><strong>Explanation:</strong> It is based on the principle that normal data follows a predictable distribution. By analyzing the distribution, you can identify data points that deviate significantly from the norm, which may indicate malicious activity.</p>
</li>
<li><p><strong>Examples:</strong></p>
<ul>
<li><p><strong>Splunk (SPL):</strong></p>
<pre><code class="lang-splunk"><span class="hljs-comment"># Analyze the distribution of request sizes in web server logs</span>
index=web sourcetype=access_combined | stats count, <span class="hljs-built_in">min</span>(<span class="hljs-keyword">bytes</span>), <span class="hljs-built_in">max</span>(<span class="hljs-keyword">bytes</span>), <span class="hljs-built_in">avg</span>(<span class="hljs-keyword">bytes</span>), stdev(<span class="hljs-keyword">bytes</span>) <span class="hljs-keyword">by</span> clientip
</code></pre>
</li>
<li><p><strong>Azure Sentinel (KQL):</strong></p>
<pre><code class="lang-kql">// <span class="hljs-keyword">Analyze</span> the distribution <span class="hljs-keyword">of</span> <span class="hljs-keyword">bytes</span> transferred
NetworkTraffic
| summarize <span class="hljs-keyword">count</span>(), <span class="hljs-keyword">min</span>(<span class="hljs-keyword">Bytes</span>), <span class="hljs-keyword">max</span>(<span class="hljs-keyword">Bytes</span>), <span class="hljs-keyword">avg</span>(<span class="hljs-keyword">Bytes</span>), <span class="hljs-keyword">stdev</span>(<span class="hljs-keyword">Bytes</span>)
</code></pre>
</li>
</ul>
</li>
<li><p><strong>Key Takeaways:</strong></p>
<ul>
<li>Helps in identifying data points that deviate significantly from the norm.</li>
<li>Useful for detecting anomalies in network traffic, user behavior, and system activity.</li>
</ul>
</li>
</ul>
<p><strong>Module Project/Exercise:</strong></p>
<p><strong>Data Analysis Challenge:</strong></p>
<p>You are given a sample dataset of web server logs. Your task is to use the data analysis techniques you&#39;ve learned in this module to identify any suspicious activity.</p>
<p><strong>Dataset:</strong> (Example - Replace with a larger, more realistic dataset)</p>
<pre><code><span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:01 192</span>.<span class="hljs-number">168.1.100</span> GET /index.html <span class="hljs-number">200 1024</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:02 192</span>.<span class="hljs-number">168.1.101</span> GET /style.css <span class="hljs-number">200 512</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:03 192</span>.<span class="hljs-number">168.1.100</span> GET /image.jpg <span class="hljs-number">200 2048</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:04 192</span>.<span class="hljs-number">168.1.102</span> GET /script.js <span class="hljs-number">200 1536</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:05 192</span>.<span class="hljs-number">168.1.100</span> POST /login.php <span class="hljs-number">200 256</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:06 192</span>.<span class="hljs-number">168.1.103</span> GET /index.html <span class="hljs-number">200 1024</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:07 192</span>.<span class="hljs-number">168.1.100</span> GET /admin.php <span class="hljs-number">403 128</span>  &lt;-- Potential Suspicious activity
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:08 192</span>.<span class="hljs-number">168.1.101</span> GET /style.css <span class="hljs-number">200 512</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:09 192</span>.<span class="hljs-number">168.1.100</span> GET /image.jpg <span class="hljs-number">200 2048</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:10 192</span>.<span class="hljs-number">168.1.104</span> GET /script.js <span class="hljs-number">200 1536</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:11 192</span>.<span class="hljs-number">168.1.100</span> POST /login.php <span class="hljs-number">200 256</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:12 192</span>.<span class="hljs-number">168.1.105</span> GET /index.html <span class="hljs-number">200 1024</span>
<span class="hljs-number">2023-10-27</span> <span class="hljs-number">00:00:13 192</span>.<span class="hljs-number">168.1.100</span> GET /config.php <span class="hljs-number">404 128</span>  &lt;-- Potential Suspicious activity
</code></pre><p><strong>Tasks:</strong></p>
<ol>
<li><strong>Basic Search and Filtering:</strong>  Find all requests for <code>/admin.php</code> and <code>/config.php</code>.</li>
<li><strong>Grouping and Counting:</strong> Count the number of requests per IP address. Which IP address made the most requests?</li>
<li><strong>Pattern Matching:</strong> Use regular expressions to identify any requests with suspicious file extensions (e.g., <code>.exe</code>, <code>.bat</code>, <code>.sh</code>).</li>
<li><strong>Timelines:</strong> (If you have a larger dataset with more events over time) Create a timeline of events for a specific IP address.</li>
<li><strong>Statistical Metrics:</strong> (If you have a dataset with request sizes) Calculate the average request size and identify any requests that are significantly larger than average.</li>
</ol>
<p><strong>Deliverables:</strong></p>
<ul>
<li>A report summarizing your findings, including the specific commands or queries you used.</li>
<li>A description of any suspicious activity you identified and why you consider it suspicious.</li>
</ul>
<p><strong>Capstone Project Contribution:</strong></p>
<p>Write a section for your capstone project documenting how you can use data analysis techniques for threat hunting.  Include examples of how you would apply these techniques to detect specific types of threats.</p>
<p><strong>Conclusion:</strong></p>
<p>This module has provided you with a foundation in data analysis techniques for threat hunting.  By mastering these techniques, you can become a more effective threat hunter and protect your organization from cyberattacks. Remember that the key is to practice and experiment with different tools and techniques to find what works best for you. Keep learning, keep hunting, and keep sharing your knowledge!</p>
<h2 id="file-8-module_7-md">File 8: module_7.md</h2>
<p>Okay, let&#39;s dive deep into Module 7: Building Threat Hunting Scenarios and Hypotheses. This is where the rubber meets the road, turning theoretical knowledge into actionable hunting strategies. We&#39;ll explore how to leverage threat intelligence, analyze internal data, and formulate testable hypotheses to uncover hidden threats.</p>
<p><strong>Module 7: Building Threat Hunting Scenarios and Hypotheses</strong></p>
<ul>
<li><strong>Module Objective:</strong> Learn to develop and test threat hunting scenarios based on threat intelligence and internal data.</li>
</ul>
<p><strong>7.1 Understanding Threat Actors and Their TTPs</strong></p>
<ul>
<li><p><strong>Objective:</strong> Identify and analyze the tactics, techniques, and procedures (TTPs) used by various threat actors.</p>
<ul>
<li><p><strong>What are TTPs?</strong>  TTPs describe <em>how</em> an adversary operates. They provide a detailed picture of their methods, tools, and behaviors. Think of it this way:</p>
<ul>
<li><strong>Tactics:</strong>  The high-level strategic goal (e.g., &quot;Initial Access,&quot; &quot;Privilege Escalation&quot;).  Mapped to the MITRE ATT&amp;CK framework.</li>
<li><strong>Techniques:</strong>  The specific method used to achieve a tactic (e.g., &quot;Spearphishing Attachment,&quot; &quot;Exploitation for Privilege Escalation&quot;). Also mapped to MITRE ATT&amp;CK.</li>
<li><strong>Procedures:</strong> The <em>specific</em> steps taken to execute a technique.  This is where you get into the nitty-gritty details that are unique to a particular threat actor or campaign.</li>
</ul>
</li>
<li><p><strong>Why are TTPs important for Threat Hunting?</strong>  TTPs are <em>more durable</em> than Indicators of Compromise (IoCs) like IP addresses or file hashes.  Threat actors frequently change their infrastructure, but their underlying TTPs often remain consistent.  By focusing on TTPs, you can detect and respond to threats even when the specific IoCs are unknown or have been changed.</p>
</li>
<li><p><strong>Leveraging the MITRE ATT&amp;CK Framework:</strong> The MITRE ATT&amp;CK framework is a knowledge base of adversary tactics and techniques based on real-world observations.  It provides a common language for describing adversary behavior and helps you understand how different techniques fit together in an attack chain.</p>
<ul>
<li><p><strong>Accessing the MITRE ATT&amp;CK Framework:</strong></p>
<ul>
<li>Online:  Go to <a href="https://attack.mitre.org/">https://attack.mitre.org/</a></li>
<li>Downloadable:  MITRE provides downloadable versions of the framework in various formats (e.g., JSON, Excel).</li>
</ul>
</li>
<li><p><strong>Using ATT&amp;CK for Threat Hunting:</strong></p>
<ol>
<li><strong>Identify Relevant Threat Actors:</strong>  Based on your organization&#39;s threat model, identify the threat actors most likely to target your organization.</li>
<li><strong>Research Their TTPs:</strong>  Use the MITRE ATT&amp;CK framework to research the TTPs used by these threat actors.</li>
<li><strong>Map TTPs to Your Environment:</strong>  Identify which TTPs are relevant to your environment and which data sources you can use to detect them.</li>
<li><strong>Develop Threat Hunting Scenarios:</strong>  Create scenarios based on the TTPs that you want to detect.</li>
</ol>
</li>
</ul>
</li>
<li><p><strong>Example:</strong>  Let&#39;s say you&#39;re concerned about APT29 (Cozy Bear), a Russian-linked threat actor known for targeting government and critical infrastructure.</p>
<ol>
<li><strong>Identify Relevant Threat Actor:</strong> APT29.</li>
<li><strong>Research Their TTPs:</strong>  Using the MITRE ATT&amp;CK framework, we find that APT29 uses techniques like:<ul>
<li>Spearphishing Attachment (T1566.001)</li>
<li>Credential Dumping (T1003)</li>
<li>Lateral Movement (T1021)</li>
</ul>
</li>
<li><strong>Map TTPs to Your Environment:</strong>  We can use email logs to detect spearphishing attachments, endpoint logs to detect credential dumping, and network logs to detect lateral movement.</li>
<li><strong>Develop Threat Hunting Scenarios:</strong>  We can create scenarios to look for suspicious email attachments, unusual process activity on endpoints, and unusual network connections.</li>
</ol>
</li>
<li><p><strong>Practical Exercise:</strong>  Choose a known threat actor (e.g., APT41, Lazarus Group, FIN7) and research their TTPs using the MITRE ATT&amp;CK framework.  Identify at least three TTPs and explain how you could detect them in your environment.</p>
</li>
</ul>
</li>
</ul>
<p><strong>7.2 Developing Threat Hunting Hypotheses</strong></p>
<ul>
<li><p><strong>Objective:</strong> Formulate testable hypotheses based on threat intelligence and internal data.</p>
<ul>
<li><p><strong>What is a Threat Hunting Hypothesis?</strong>  A threat hunting hypothesis is an educated guess about where malicious activity might be occurring in your environment.  It&#39;s a statement that you can test using data analysis.</p>
</li>
<li><p><strong>Characteristics of a Good Hypothesis:</strong></p>
<ul>
<li><strong>Testable:</strong>  You should be able to test the hypothesis using available data.</li>
<li><strong>Specific:</strong>  The hypothesis should be specific enough to guide your investigation.</li>
<li><strong>Relevant:</strong>  The hypothesis should be relevant to your organization&#39;s threat model.</li>
</ul>
</li>
<li><p><strong>Sources for Developing Hypotheses:</strong></p>
<ul>
<li><strong>Threat Intelligence:</strong>  Threat intelligence feeds, reports, and advisories can provide valuable information about emerging threats, attacker TTPs, and vulnerable systems.</li>
<li><strong>Internal Data:</strong>  Your own security logs, network traffic data, and endpoint data can reveal suspicious activity and potential vulnerabilities.</li>
<li><strong>Vulnerability Assessments:</strong>  Vulnerability assessments can identify weaknesses in your systems that attackers could exploit.</li>
<li><strong>Incident Response Reports:</strong>  Past incident response reports can provide insights into how attackers have targeted your organization in the past.</li>
</ul>
</li>
<li><p><strong>Types of Hypotheses:</strong></p>
<ul>
<li><strong>Intelligence-Driven Hypotheses:</strong>  Based on threat intelligence reports or advisories.  Example:  &quot;We believe that APT29 is targeting our organization using spearphishing attachments.  We will look for suspicious email attachments with specific file types or subject lines.&quot;</li>
<li><strong>Anomaly-Driven Hypotheses:</strong>  Based on unusual patterns or anomalies in your data.  Example:  &quot;We have noticed a spike in outbound network traffic to a specific country.  We will investigate the source and destination of this traffic to determine if it is malicious.&quot;</li>
<li><strong>Vulnerability-Driven Hypotheses:</strong>  Based on known vulnerabilities in your systems.  Example:  &quot;We have a vulnerable web server that is susceptible to SQL injection attacks.  We will look for evidence of SQL injection attempts in our web server logs.&quot;</li>
<li><strong>Behavior-Driven Hypotheses:</strong> Based on known malicious behaviors. Example: &quot;We will look for PowerShell scripts downloading and executing code from the internet&quot;</li>
</ul>
</li>
<li><p><strong>Formulating a Hypothesis:</strong>  A good hypothesis typically follows this structure:</p>
<ul>
<li><strong>IF</strong> (condition):  Describe the condition you are looking for.</li>
<li><strong>THEN</strong> (expected outcome):  Describe the expected outcome if the condition is true.</li>
<li><strong>BECAUSE</strong> (rationale):  Explain why you expect this outcome based on threat intelligence or internal data.</li>
</ul>
</li>
<li><p><strong>Example:</strong></p>
<ul>
<li><strong>IF</strong> we see a user account logging in from multiple geographically distant locations within a short period of time,</li>
<li><strong>THEN</strong> it may indicate a compromised account,</li>
<li><strong>BECAUSE</strong> attackers often use compromised accounts to gain access to internal systems.</li>
</ul>
</li>
<li><p><strong>Practical Exercise:</strong>  Based on the threat actor you researched in the previous exercise, develop at least three threat hunting hypotheses.  For each hypothesis, explain the condition, expected outcome, and rationale.</p>
</li>
</ul>
</li>
</ul>
<p><strong>7.3 Testing Hypotheses</strong></p>
<ul>
<li><p><strong>Objective:</strong>  Use data analysis techniques to validate or reject threat hunting hypotheses.</p>
<ul>
<li><p><strong>Data Sources:</strong>  The data sources you need to test your hypotheses will depend on the specific hypothesis and the TTPs you are investigating.  Common data sources include:</p>
<ul>
<li><strong>Security Logs:</strong>  Windows Event Logs, Linux Syslog, firewall logs, web server logs, etc.</li>
<li><strong>Network Traffic Data:</strong>  PCAP files, NetFlow data, Zeek logs.</li>
<li><strong>Endpoint Data:</strong>  Process activity, file system changes, registry modifications.</li>
<li><strong>Threat Intelligence Feeds:</strong>  IoCs, TTPs, and other threat intelligence data.</li>
</ul>
</li>
<li><p><strong>Data Analysis Techniques:</strong>  You will need to use a variety of data analysis techniques to test your hypotheses.  Some common techniques include:</p>
<ul>
<li><strong>Searching and Filtering:</strong>  Using search operators and filters to identify specific events or patterns in your data.</li>
<li><strong>Aggregation and Grouping:</strong>  Grouping data by specific attributes to identify trends and anomalies.</li>
<li><strong>Correlation:</strong>  Combining data from multiple sources to identify relationships between events.</li>
<li><strong>Visualization:</strong>  Using charts and graphs to visualize data and identify patterns.</li>
<li><strong>Statistical Analysis:</strong>  Using statistical methods to identify outliers and anomalies.</li>
</ul>
</li>
<li><p><strong>Tools for Testing Hypotheses:</strong>  There are many tools available for testing threat hunting hypotheses.  Some popular tools include:</p>
<ul>
<li><strong>SIEM (Security Information and Event Management) Systems:</strong>  Splunk, QRadar, Sentinel.</li>
<li><strong>Endpoint Detection and Response (EDR) Solutions:</strong>  CrowdStrike, SentinelOne, Carbon Black.</li>
<li><strong>Network Traffic Analysis (NTA) Tools:</strong>  Wireshark, Zeek, Suricata.</li>
<li><strong>Log Analysis Tools:</strong>  Graylog, ELK Stack (Elasticsearch, Logstash, Kibana).</li>
<li><strong>Scripting Languages:</strong>  Python, PowerShell.</li>
</ul>
</li>
<li><p><strong>Example (Testing the Compromised Account Hypothesis):</strong></p>
<ol>
<li><strong>Hypothesis:</strong>  IF we see a user account logging in from multiple geographically distant locations within a short period of time, THEN it may indicate a compromised account, BECAUSE attackers often use compromised accounts to gain access to internal systems.</li>
<li><strong>Data Source:</strong>  Security logs (e.g., Windows Event Logs, authentication logs).</li>
<li><strong>Tools:</strong>  SIEM (e.g., Splunk, Sentinel) or scripting language (e.g., Python).</li>
<li><p><strong>Analysis Steps (using Splunk):</strong></p>
<pre><code class="lang-splunk"><span class="hljs-built_in">index</span>=security sourcetype=WinEventLog EventCode=<span class="hljs-number">4624</span>  // Windows Event ID <span class="hljs-keyword">for</span> successful login
| stats <span class="hljs-built_in">count</span> by Account_Name, src_ip
| <span class="hljs-built_in">search</span> <span class="hljs-built_in">count</span> &gt; <span class="hljs-number">1</span>
| iplocation src_ip   //  Get geolocation information <span class="hljs-keyword">for</span> the <span class="hljs-keyword">source</span> IP addresses
| stats <span class="hljs-built_in">values</span>(City), <span class="hljs-built_in">values</span>(Country) by Account_Name
| <span class="hljs-built_in">search</span> <span class="hljs-built_in">count</span> &gt; <span class="hljs-number">1</span>  // Filter <span class="hljs-keyword">for</span> accounts with logins from multiple locations
</code></pre>
</li>
<li><p><strong>Interpretation:</strong>  If the query returns accounts that have logged in from multiple geographically distant locations, it supports the hypothesis that the account may be compromised.  Further investigation is needed to confirm the compromise.</p>
</li>
</ol>
</li>
<li><p><strong>Example (Testing the PowerShell Download Hypothesis):</strong></p>
<ol>
<li><strong>Hypothesis:</strong> IF we see powershell executing a command that downloads code from an external source, THEN it may indicate a malicious PowerShell script, BECAUSE attackers often use PowerShell to download and execute malicious code.</li>
<li><strong>Data Source:</strong> Endpoint Detection and Response (EDR) logs, Sysmon logs</li>
<li><strong>Tools:</strong> EDR Solution, SIEM</li>
<li><strong>Analysis Steps (using Sysmon and PowerShell - this would be done on the endpoint during the hunt):</strong></li>
</ol>
<p>First, ensure Sysmon is configured to log PowerShell events (Event ID 7, 8, 4103, 4104). A sample Sysmon configuration might look like this:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Sysmon</span> <span class="hljs-attr">schemaversion</span>=<span class="hljs-string">"4.82"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">EventFiltering</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">RuleGroup</span> <span class="hljs-attr">name</span>=<span class="hljs-string">""</span> <span class="hljs-attr">groupRelation</span>=<span class="hljs-string">"or"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">PowerShell</span> <span class="hljs-attr">EventID</span>=<span class="hljs-string">"1"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ScriptBlockText</span> <span class="hljs-attr">condition</span>=<span class="hljs-string">"contains"</span>&gt;</span>Invoke-WebRequest<span class="hljs-tag">&lt;/<span class="hljs-name">ScriptBlockText</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">PowerShell</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">PowerShell</span> <span class="hljs-attr">EventID</span>=<span class="hljs-string">"1"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ScriptBlockText</span> <span class="hljs-attr">condition</span>=<span class="hljs-string">"contains"</span>&gt;</span>WebClient.DownloadString<span class="hljs-tag">&lt;/<span class="hljs-name">ScriptBlockText</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">PowerShell</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">RuleGroup</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">EventFiltering</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Sysmon</span>&gt;</span>
</code></pre>
<p>Now, query the Event Logs for the relevant events:</p>
<pre><code class="lang-powershell"><span class="hljs-built_in">Get-WinEvent</span> -Logname <span class="hljs-string">"Microsoft-Windows-Sysmon/Operational"</span> |
<span class="hljs-built_in">Where-Object</span> {<span class="hljs-variable">$_</span>.ID <span class="hljs-nomarkup">-in</span> (<span class="hljs-number">1</span>)} | <span class="hljs-comment"># PowerShell Script Block</span>
<span class="hljs-built_in">ForEach-Object</span> {
    <span class="hljs-variable">$eventData</span> = <span class="hljs-variable">$_</span>.Properties | <span class="hljs-built_in">ForEach-Object</span> {<span class="hljs-variable">$_</span>.Value}
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$eventData</span> <span class="hljs-nomarkup">-like</span> <span class="hljs-string">"*Invoke-WebRequest*"</span> -or <span class="hljs-variable">$eventData</span> <span class="hljs-nomarkup">-like</span> <span class="hljs-string">"*WebClient.DownloadString*"</span>) {
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Possible malicious script block found in event ID $(<span class="hljs-variable">$_</span>.ID) from $(<span class="hljs-variable">$_</span>.TimeCreated):"</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$eventData</span>
    }
}
</code></pre>
<p>This PowerShell script looks through the Sysmon logs for Event ID 1 (PowerShell script block).  It filters the logs for instances where the script contains <code>Invoke-WebRequest</code> or <code>WebClient.DownloadString</code>.</p>
</li>
<li><p><strong>Interpreting Results:</strong>  Based on the results of your data analysis, you can either:</p>
<ul>
<li><strong>Validate the Hypothesis:</strong>  If you find evidence that supports the hypothesis, you can conclude that malicious activity is likely occurring.</li>
<li><strong>Reject the Hypothesis:</strong>  If you do not find evidence that supports the hypothesis, you can reject it and move on to a different hypothesis.</li>
<li><strong>Refine the Hypothesis:</strong>  If you find some evidence that supports the hypothesis, but it is not conclusive, you can refine the hypothesis and try again.</li>
</ul>
</li>
<li><p><strong>Practical Exercise:</strong>  Choose one of the hypotheses you developed in the previous exercise and use data analysis techniques to test it.  Document your data sources, tools, analysis steps, and results.</p>
</li>
</ul>
</li>
</ul>
<p><strong>7.4 Documenting Threat Hunting Scenarios</strong></p>
<ul>
<li><p><strong>Objective:</strong>  Create clear and concise documentation for your threat hunting scenarios.</p>
<ul>
<li><p><strong>Why Documentation is Important:</strong>  Documentation is essential for:</p>
<ul>
<li><strong>Knowledge Sharing:</strong>  Sharing your knowledge with other members of your security team.</li>
<li><strong>Reproducibility:</strong>  Allowing you to repeat the threat hunt in the future.</li>
<li><strong>Training:</strong>  Training new members of your security team.</li>
<li><strong>Continuous Improvement:</strong>  Identifying areas for improvement in your threat hunting process.</li>
</ul>
</li>
<li><p><strong>Elements of a Threat Hunting Scenario Document:</strong></p>
<ul>
<li><strong>Title:</strong>  A clear and concise title that describes the scenario.</li>
<li><strong>Description:</strong>  A brief description of the scenario and its purpose.</li>
<li><strong>Threat Actor:</strong>  The threat actor that the scenario is designed to detect.</li>
<li><strong>TTPs:</strong>  The TTPs that the scenario is designed to detect.</li>
<li><strong>Hypothesis:</strong>  The threat hunting hypothesis that the scenario is based on.</li>
<li><strong>Data Sources:</strong>  The data sources that are needed to test the hypothesis.</li>
<li><strong>Tools:</strong>  The tools that are needed to test the hypothesis.</li>
<li><strong>Analysis Steps:</strong>  The step-by-step instructions for testing the hypothesis.</li>
<li><strong>Expected Results:</strong>  The expected results if the hypothesis is true.</li>
<li><strong>False Positive Considerations:</strong>  Potential sources of false positives and how to mitigate them.</li>
<li><strong>Remediation Steps:</strong>  The steps to take if the hypothesis is validated (i.e., malicious activity is detected).</li>
<li><strong>References:</strong>  Links to relevant threat intelligence reports, advisories, and other resources.</li>
<li><strong>Version History:</strong>  A record of changes made to the document over time.</li>
</ul>
</li>
<li><p><strong>Example:</strong></p>
<p><strong>Title:</strong>  Detecting Spearphishing Attachments from APT29</p>
<p><strong>Description:</strong>  This scenario is designed to detect spearphishing attachments from APT29, a Russian-linked threat actor.</p>
<p><strong>Threat Actor:</strong>  APT29 (Cozy Bear)</p>
<p><strong>TTPs:</strong></p>
<pre><code>*   Spearphishing Attachment (<span class="hljs-name">T1566</span>.<span class="hljs-number">001</span>)
</code></pre><p><strong>Hypothesis:</strong></p>
<pre><code>*   IF we see <span class="hljs-keyword">an</span> email <span class="hljs-keyword">with</span> <span class="hljs-keyword">a</span> malicious attachment <span class="hljs-built_in">from</span> <span class="hljs-keyword">an</span> external sender,
*   THEN <span class="hljs-keyword">it</span> may indicate <span class="hljs-keyword">a</span> spearphishing attempt <span class="hljs-built_in">from</span> APT29,
*   BECAUSE APT29 is known <span class="hljs-built_in">to</span> use spearphishing attachments <span class="hljs-built_in">to</span> gain initial access <span class="hljs-built_in">to</span> victim networks.
</code></pre><p><strong>Data Sources:</strong></p>
<pre><code><span class="hljs-bullet">*   </span>Email logs
<span class="hljs-bullet">*   </span>Endpoint logs
</code></pre><p><strong>Tools:</strong></p>
<pre><code>*   SIEM (<span class="hljs-name">e</span>.g., Splunk, Sentinel)
*   Sandboxing tool (<span class="hljs-name">e</span>.g., VirusTotal, Hybrid Analysis)
</code></pre><p><strong>Analysis Steps:</strong></p>
<pre><code><span class="hljs-number">1.</span>  Search email logs <span class="hljs-keyword">for</span> emails <span class="hljs-keyword">with</span> attachments <span class="hljs-built_in">from</span> external senders.
<span class="hljs-number">2.</span>  Filter <span class="hljs-keyword">for</span> attachments <span class="hljs-keyword">with</span> suspicious <span class="hljs-built_in">file</span> types (e.g., .exe, .scr, .docm).
<span class="hljs-number">3.</span>  Analyze <span class="hljs-keyword">the</span> attachments <span class="hljs-keyword">in</span> <span class="hljs-keyword">a</span> sandboxing tool <span class="hljs-built_in">to</span> determine <span class="hljs-keyword">if</span> they are malicious.
<span class="hljs-number">4.</span>  If <span class="hljs-keyword">the</span> attachment is malicious, investigate <span class="hljs-keyword">the</span> sender <span class="hljs-keyword">and</span> recipient <span class="hljs-built_in">to</span> determine <span class="hljs-keyword">the</span> scope <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> attack.
</code></pre><p><strong>Expected Results:</strong></p>
<pre><code>*   Malicious attachments <span class="hljs-built_in">from</span> external senders.
*   Suspicious email subject <span class="hljs-keyword">lines</span> <span class="hljs-keyword">or</span> body content.
*   Evidence <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> attachment being executed <span class="hljs-keyword">on</span> <span class="hljs-title">the</span> <span class="hljs-title">recipient</span><span class="hljs-string">'s endpoint.</span>
</code></pre><p><strong>False Positive Considerations:</strong></p>
<pre><code>*   Legitimate emails <span class="hljs-keyword">with</span> attachments <span class="hljs-keyword">from</span> external senders.
*   Attachments <span class="hljs-keyword">that</span> are flagged <span class="hljs-keyword">as</span> malicious <span class="hljs-keyword">but</span> are actually <span class="hljs-literal">false</span> positives.
</code></pre><p><strong>Remediation Steps:</strong></p>
<pre><code>*   Quarantine the malicious email.
*   Block the sende<span class="hljs-string">r's email address.
*   Scan the recipient'</span>s endpoint <span class="hljs-keyword">for</span> malware.
*   Alert the recipient to the potential spearphishing attempt.
</code></pre><p><strong>References:</strong></p>
<pre><code><span class="hljs-bullet">*   </span>MITRE ATT&amp;CK: Spearphishing Attachment (T1566.001)
<span class="hljs-bullet">*   </span>CrowdStrike: APT29 Threat Profile
</code></pre><p><strong>Version History:</strong></p>
<pre><code>*   Version 1.0 (2023<span class="hljs-string">-10</span><span class="hljs-string">-27</span>): Initial draft
</code></pre></li>
<li><p><strong>Practical Exercise:</strong>  Document the threat hunting scenario that you developed and tested in the previous exercises.  Use the template above as a guide.</p>
</li>
</ul>
</li>
</ul>
<p><strong>7.5 Creating Threat Hunting Playbooks</strong></p>
<ul>
<li><p><strong>Objective:</strong>  Document the steps to take when a threat is detected.</p>
<ul>
<li><p><strong>What is a Threat Hunting Playbook?</strong>  A threat hunting playbook is a step-by-step guide that outlines the actions to take when a threat is detected during a threat hunt.  It provides a consistent and repeatable process for responding to threats.</p>
</li>
<li><p><strong>Elements of a Threat Hunting Playbook:</strong></p>
<ul>
<li><strong>Scenario:</strong>  The threat hunting scenario that the playbook applies to.</li>
<li><strong>Trigger:</strong>  The event that triggers the playbook (e.g., detection of a malicious attachment).</li>
<li><strong>Initial Response:</strong>  The first steps to take when the trigger event occurs (e.g., quarantine the email, alert the security team).</li>
<li><strong>Investigation:</strong>  The steps to take to investigate the incident and determine the scope of the attack (e.g., analyze the email header, scan the recipient&#39;s endpoint).</li>
<li><strong>Containment:</strong>  The steps to take to contain the incident and prevent further damage (e.g., block the attacker&#39;s IP address, disable the compromised account).</li>
<li><strong>Eradication:</strong>  The steps to take to remove the threat from the environment (e.g., remove malware from infected systems, reset passwords).</li>
<li><strong>Recovery:</strong>  The steps to take to restore systems to their normal state (e.g., restore data from backups, re-enable disabled accounts).</li>
<li><strong>Lessons Learned:</strong>  The lessons learned from the incident and how to improve the threat hunting process.</li>
</ul>
</li>
<li><p><strong>Example (Playbook for Spearphishing Attachment):</strong></p>
<p><strong>Scenario:</strong>  Detecting Spearphishing Attachments from APT29</p>
<p><strong>Trigger:</strong>  Detection of a malicious attachment in an email.</p>
<p><strong>Initial Response:</strong></p>
<pre><code><span class="hljs-number">1.</span>  Quarantine <span class="hljs-keyword">the</span> malicious email.
<span class="hljs-number">2.</span>  Alert <span class="hljs-keyword">the</span> security team.
<span class="hljs-number">3.</span>  Notify <span class="hljs-keyword">the</span> recipient <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> potential spearphishing attempt.
</code></pre><p><strong>Investigation:</strong></p>
<pre><code><span class="hljs-number">1.</span>  Analyze the email header to identify the sende<span class="hljs-string">r's IP address and other information.
2.  Scan the recipient'</span>s endpoint <span class="hljs-keyword">for</span> malware.
<span class="hljs-number">3.</span>  Analyze the attachment <span class="hljs-keyword">in</span> a sandboxing tool to determine its behavior.
<span class="hljs-number">4.</span>  Review security logs <span class="hljs-keyword">for</span> other suspicious activity associated <span class="hljs-keyword">with</span> the sender <span class="hljs-keyword">or</span> recipient.
</code></pre><p><strong>Containment:</strong></p>
<pre><code><span class="hljs-number">1.</span>  Block the sender's <span class="hljs-section">email</span> address.
<span class="hljs-number">2.</span>  Disable any compromised accounts.
<span class="hljs-number">3.</span>  Isolate any infected systems.
</code></pre><p><strong>Eradication:</strong></p>
<pre><code><span class="hljs-number">1.</span>  <span class="hljs-comment">Remove malware from infected systems.</span>
<span class="hljs-number">2.</span>  <span class="hljs-keyword">Reset</span> passwords <span class="hljs-keyword">for</span> compromised accounts.
<span class="hljs-number">3.</span>  Patch any vulnerable systems.
</code></pre><p><strong>Recovery:</strong></p>
<pre><code>1.  <span class="hljs-keyword">Restore</span> <span class="hljs-keyword">data</span> <span class="hljs-keyword">from</span> backups <span class="hljs-keyword">if</span> necessary.
<span class="hljs-number">2.</span>  Re-<span class="hljs-keyword">enable</span> disabled accounts.
<span class="hljs-number">3.</span>  Monitor systems <span class="hljs-keyword">for</span> <span class="hljs-keyword">any</span> further suspicious activity.
</code></pre><p><strong>Lessons Learned:</strong></p>
<pre><code><span class="hljs-number">1.</span>  Review <span class="hljs-keyword">the</span> effectiveness <span class="hljs-keyword">of</span> existing email security controls.
<span class="hljs-number">2.</span>  Provide additional training <span class="hljs-keyword">to</span> employees <span class="hljs-keyword">on</span> how <span class="hljs-keyword">to</span> identify <span class="hljs-keyword">and</span> avoid spearphishing attacks.
<span class="hljs-number">3.</span>  Improve <span class="hljs-keyword">the</span> threat hunting process based <span class="hljs-keyword">on</span> <span class="hljs-keyword">the</span> lessons learned <span class="hljs-keyword">from</span> <span class="hljs-keyword">the</span> incident.
</code></pre></li>
<li><p><strong>Practical Exercise:</strong>  Create a threat hunting playbook for the threat hunting scenario that you documented in the previous exercise.</p>
</li>
</ul>
</li>
</ul>
<p><strong>7.6 Real-World Threat Hunting Scenarios and Case Studies</strong></p>
<ul>
<li><p><strong>Objective:</strong>  Explore examples of common threat hunting scenarios and case studies of successful threat hunts.</p>
<ul>
<li><p><strong>Common Threat Hunting Scenarios:</strong></p>
<ul>
<li><strong>Compromised Accounts:</strong>  Detecting compromised accounts based on unusual login activity, suspicious behavior, or data exfiltration.</li>
<li><strong>Lateral Movement:</strong>  Detecting lateral movement by attackers within the network.</li>
<li><strong>Data Exfiltration:</strong>  Detecting data exfiltration by attackers.</li>
<li><strong>Malware Infections:</strong>  Detecting malware infections based on suspicious process activity, file system changes, or network traffic.</li>
<li><strong>Insider Threats:</strong>  Detecting insider threats based on unusual user behavior or access to sensitive data.</li>
<li><strong>Ransomware Activity:</strong>  Detecting early stages of ransomware attacks.</li>
</ul>
</li>
<li><p><strong>Case Studies:</strong></p>
<ul>
<li><strong>The Target Breach (2013):</strong>  Attackers gained access to Target&#39;s network through a third-party vendor and used a point-of-sale (POS) malware to steal credit card data from millions of customers.  A proactive threat hunt could have potentially detected the malware before it caused significant damage.</li>
<li><strong>The Equifax Breach (2017):</strong>  Attackers exploited a known vulnerability in Equifax&#39;s Apache Struts web server to gain access to sensitive data on millions of consumers.  A proactive vulnerability assessment and threat hunt could have prevented the breach.</li>
<li><strong>The SolarWinds Supply Chain Attack (2020):</strong>  Attackers compromised SolarWinds&#39; Orion software and used it to distribute malware to thousands of organizations.  This attack highlights the importance of supply chain security and the need for proactive threat hunting to detect sophisticated attacks.</li>
</ul>
</li>
<li><p><strong>Learning from Case Studies:</strong>  By studying real-world case studies, you can learn about the TTPs used by attackers, the vulnerabilities they exploit, and the mistakes that organizations make that allow them to be compromised.  You can then use this knowledge to improve your own threat hunting process and prevent similar attacks from happening to your organization.</p>
</li>
</ul>
</li>
</ul>
<p><strong>Module 7 Summary:</strong></p>
<p>In this module, we covered the essential steps for building threat hunting scenarios and hypotheses. We learned how to leverage threat intelligence, analyze internal data, formulate testable hypotheses, and document our findings. By mastering these skills, you can proactively hunt for threats in your environment and improve your organization&#39;s security posture.</p>
<p>This is a very detailed breakdown of Module 7. Remember to tailor these materials to your specific audience and environment. Good luck!</p>
<h2 id="file-9-module_8-md">File 9: module_8.md</h2>
<p>Okay, here&#39;s a hyper-detailed, step-by-step deep dive into Module 8, &quot;Capstone Project: Building Your Own Cyber Threat Hunting 101,&quot; based on the course outline. I&#39;ll aim to make this practical, engaging, and reflective of my teaching style, emphasizing open sharing and understanding.</p>
<p><strong>Module 8: Capstone Project: Building Your Own Cyber Threat Hunting 101</strong></p>
<p><strong>Module Objective:</strong> Integrate all learned knowledge and skills to create a functional clone of the course topic.</p>
<p><strong>Introduction:</strong></p>
<p>Congratulations! You&#39;ve reached the final module. This is where you put everything you&#39;ve learned into practice. The goal here isn&#39;t just to <em>understand</em> threat hunting, but to <em>demonstrate</em> that understanding by building something tangible.  Think of this as not just a project, but a portfolio piece  something you can show off to potential employers or use to further your career. This module also will focus on the best parts of teaching, so that you too will have the skills to teach others about the topic.</p>
<p><strong>Project Options:</strong></p>
<p>Before we dive into the steps, let&#39;s clarify the project options. You can choose <em>one</em> of the following:</p>
<ol>
<li><strong>Threat Hunting Dashboard:</strong>  A web-based dashboard visualizing key security metrics and potential threats, pulling data from various sources (logs, threat intelligence feeds, etc.).</li>
<li><strong>Threat Hunting Playbook Automation:</strong> A script (e.g., Python) that automates steps in a specific threat hunting playbook (e.g., detecting lateral movement).</li>
<li><strong>Threat Hunting Tool:</strong>  A command-line or GUI tool that performs a specific threat hunting task (e.g., a tool to identify DNS tunneling).</li>
<li><strong>Threat Hunting Report &amp; Presentation:</strong> A detailed report analyzing a specific real-world threat (e.g., a recent ransomware campaign) and presenting your findings, including indicators of compromise (IoCs) and mitigation strategies. This can be a great option if coding isn&#39;t your strongest suit, but you excel at analysis and communication.</li>
<li><strong>Cyber Threat Hunting 101 Teaching Assistant:</strong> A teaching assistant module that would include creating quizzes, grading them, creating new content for the course, or answering student questions.</li>
</ol>
<p><strong>Step-by-Step Guide:</strong></p>
<p><strong>Phase 1: Planning (Weeks 1-2)</strong></p>
<ol>
<li><p><strong>Project Selection (Day 1):</strong></p>
<ul>
<li><strong>Action:</strong> Carefully review the project options above.</li>
<li><strong>Considerations:</strong><ul>
<li>Your existing skillset: What are you already good at?</li>
<li>Your interests: What are you most excited to learn?</li>
<li>Time commitment: Which project can you realistically complete in the allotted time?</li>
</ul>
</li>
<li><strong>Deliverable:</strong> A one-paragraph description of your chosen project and why you chose it.</li>
</ul>
</li>
<li><p><strong>Scope Definition (Day 2-3):</strong></p>
<ul>
<li><strong>Action:</strong> Define the <em>specific</em> scope of your project.  Be realistic. It&#39;s better to do a small thing well than a big thing poorly.</li>
<li><strong>Example (Threat Hunting Dashboard):</strong> &quot;My dashboard will visualize failed login attempts, suspicious process executions (based on Sysmon logs), and connections to known malicious IP addresses (using a VirusTotal API integration). It will pull data from Windows Event Logs and Sysmon logs, stored in an Elasticsearch instance.&quot;</li>
<li><strong>Example (Threat Hunting Playbook Automation):</strong> &quot;I will automate the playbook for detecting PowerShell-based attacks, specifically those using obfuscation techniques. The script will parse Sysmon logs, identify PowerShell processes with suspicious command-line arguments (e.g., encoded commands), and generate alerts.&quot;</li>
<li><strong>Example (Threat Hunting Tool):</strong> &quot;My tool will analyze DNS traffic (from a PCAP file) and identify potential DNS tunneling attempts by looking for unusually long domain names and high query frequencies to specific domains.&quot;</li>
<li><strong>Example (Threat Hunting Report &amp; Presentation):</strong> &quot;I will analyze the recent &#39;LockBit 3.0&#39; ransomware campaign, focusing on their initial access vectors, encryption methods, and extortion tactics. My report will include IoCs and recommendations for preventing LockBit infections.&quot;</li>
<li><strong>Example (Cyber Threat Hunting 101 Teaching Assistant):</strong> &quot;I will create a new quiz for module 1, grade the quiz, and answer the top 5 most asked questions from the students.&quot;</li>
<li><strong>Deliverable:</strong> A detailed project scope document (1-2 pages) outlining the specific features, data sources, and functionality of your project.</li>
</ul>
</li>
<li><p><strong>Technology Stack Selection (Day 4-5):</strong></p>
<ul>
<li><strong>Action:</strong> Choose the specific tools, libraries, and technologies you&#39;ll use.</li>
<li><strong>Rationale:</strong> Explain <em>why</em> you&#39;re choosing these technologies.</li>
<li><strong>Example (Threat Hunting Dashboard):</strong><ul>
<li><strong>Data Source:</strong> Elasticsearch (for storing logs)</li>
<li><strong>Log Shipper:</strong> Filebeat (to send logs to Elasticsearch)</li>
<li><strong>Backend:</strong> Python (Flask or Django) for the API</li>
<li><strong>Frontend:</strong> HTML, CSS, JavaScript (with a framework like React or Vue.js) for the dashboard UI</li>
<li><strong>Threat Intelligence:</strong> VirusTotal API</li>
</ul>
</li>
<li><strong>Example (Threat Hunting Playbook Automation):</strong><ul>
<li><strong>Language:</strong> Python</li>
<li><strong>Log Parsing:</strong> <code>python-evtx</code> (for parsing Windows Event Logs) or <code>lxml</code> (for XML parsing)</li>
<li><strong>Regular Expressions:</strong> <code>re</code> module (for pattern matching)</li>
<li><strong>Alerting:</strong> Email (using <code>smtplib</code>) or a SIEM API (if available)</li>
</ul>
</li>
<li><strong>Example (Threat Hunting Tool):</strong><ul>
<li><strong>Language:</strong> Python</li>
<li><strong>PCAP Parsing:</strong> <code>scapy</code></li>
<li><strong>Data Analysis:</strong> <code>pandas</code> or <code>numpy</code></li>
</ul>
</li>
<li><strong>Example (Threat Hunting Report &amp; Presentation):</strong><ul>
<li><strong>Report:</strong> Markdown, LaTeX, or Microsoft Word</li>
<li><strong>Presentation:</strong> PowerPoint, Google Slides, or a similar tool</li>
<li><strong>Data Analysis:</strong>  Any relevant security blogs, reports, and tools (VirusTotal, etc.)</li>
</ul>
</li>
<li><strong>Example (Cyber Threat Hunting 101 Teaching Assistant):</strong><ul>
<li><strong>New quiz:</strong> Markdown, LaTeX, or Microsoft Word</li>
<li><strong>Quiz Grading:</strong> Python, Pandas, or Excel</li>
<li><strong>Answering Questions:</strong> Markdown, LaTeX, or Microsoft Word</li>
</ul>
</li>
<li><strong>Deliverable:</strong> A list of technologies, libraries, and tools, with a brief explanation of why you chose each one.</li>
</ul>
</li>
<li><p><strong>Design (Day 6-7):</strong></p>
<ul>
<li><strong>Action:</strong> Create a high-level design for your project.</li>
<li><strong>Threat Hunting Dashboard:</strong> Sketch out the dashboard layout. What information will be displayed? How will users interact with it?</li>
<li><strong>Threat Hunting Playbook Automation:</strong> Create a flowchart outlining the script&#39;s logic. What steps will it take? What data will it analyze?</li>
<li><strong>Threat Hunting Tool:</strong> Design the user interface (if any) and the overall workflow of the tool.</li>
<li><strong>Threat Hunting Report &amp; Presentation:</strong> Outline the structure of your report and presentation. What topics will you cover? What evidence will you present?</li>
<li><strong>Cyber Threat Hunting 101 Teaching Assistant:</strong> Create a high level design of the quiz questions, grading, and answering questions.</li>
<li><strong>Deliverable:</strong>  A visual representation of your project&#39;s design (e.g., a dashboard mockup, a flowchart, a report outline).</li>
</ul>
</li>
<li><p><strong>Task Breakdown and Timeline (Week 2):</strong></p>
<ul>
<li><strong>Action:</strong> Break down your project into smaller, manageable tasks. Estimate the time required for each task. Create a timeline with specific deadlines.  Be realistic!</li>
<li><strong>Example:</strong><ul>
<li>Task: Set up Elasticsearch and Filebeat (Estimated time: 4 hours)</li>
<li>Task: Write Python script to query Elasticsearch (Estimated time: 8 hours)</li>
<li>Task: Design dashboard UI (Estimated time: 6 hours)</li>
<li>Task: Integrate VirusTotal API (Estimated time: 4 hours)</li>
</ul>
</li>
<li><strong>Deliverable:</strong> A detailed task list and timeline (e.g., a Gantt chart or a simple table).</li>
</ul>
</li>
</ol>
<p><strong>Phase 2: Implementation (Weeks 3-6)</strong></p>
<p>This is where the real work begins! Focus on incremental progress. Don&#39;t try to build everything at once.  Test frequently.  Ask for help when you need it.</p>
<ol>
<li><p><strong>Setting up the Environment (Week 3):</strong></p>
<ul>
<li><strong>Action:</strong> Install and configure your chosen technologies.</li>
<li><strong>Example:</strong> Install Elasticsearch, Filebeat, Python, Flask, etc.</li>
<li><strong>Tip:</strong> Use virtual environments (e.g., <code>venv</code> in Python) to isolate your project&#39;s dependencies.</li>
<li><strong>Deliverable:</strong> A working development environment.</li>
</ul>
</li>
<li><p><strong>Data Ingestion (Week 3-4):</strong></p>
<ul>
<li><strong>Action:</strong>  Get data flowing into your project.</li>
<li><strong>Threat Hunting Dashboard:</strong> Configure Filebeat to send Windows Event Logs and Sysmon logs to Elasticsearch.</li>
<li><strong>Threat Hunting Playbook Automation:</strong>  Write a script to read Windows Event Logs (e.g., using <code>python-evtx</code>).</li>
<li><strong>Threat Hunting Tool:</strong>  Write a script to parse a PCAP file (e.g., using <code>scapy</code>).</li>
<li><strong>Threat Hunting Report &amp; Presentation:</strong> Start gathering data from security blogs, reports, and tools.</li>
<li><strong>Cyber Threat Hunting 101 Teaching Assistant:</strong> Gather the data from previous quizzes and student questions.</li>
<li><strong>Deliverable:</strong> Data successfully ingested into your project.</li>
</ul>
</li>
<li><p><strong>Core Functionality (Week 4-5):</strong></p>
<ul>
<li><strong>Action:</strong> Implement the core functionality of your project.</li>
<li><strong>Threat Hunting Dashboard:</strong> Write the Python API to query Elasticsearch and format the data for the dashboard.  Build the basic dashboard UI.</li>
<li><strong>Threat Hunting Playbook Automation:</strong> Write the script to parse logs, identify suspicious activity, and generate alerts.</li>
<li><strong>Threat Hunting Tool:</strong> Implement the core logic of the tool (e.g., DNS tunneling detection).</li>
<li><strong>Threat Hunting Report &amp; Presentation:</strong> Start writing the body of your report and creating your presentation slides.</li>
<li><strong>Cyber Threat Hunting 101 Teaching Assistant:</strong> Create the quiz questions, a grading system, and an answer system.</li>
<li><strong>Deliverable:</strong>  A functional (but potentially incomplete) version of your project.</li>
</ul>
</li>
<li><p><strong>Enhancements and Refinements (Week 5-6):</strong></p>
<ul>
<li><strong>Action:</strong> Add enhancements, refine the UI, fix bugs, and improve performance.</li>
<li><strong>Threat Hunting Dashboard:</strong> Add more visualizations, improve the UI, integrate the VirusTotal API.</li>
<li><strong>Threat Hunting Playbook Automation:</strong> Add more sophisticated detection logic, improve the alerting mechanism.</li>
<li><strong>Threat Hunting Tool:</strong> Add more features, improve the user interface, optimize performance.</li>
<li><strong>Threat Hunting Report &amp; Presentation:</strong> Add more details to your report and presentation, refine your arguments, and improve the visual appeal.</li>
<li><strong>Cyber Threat Hunting 101 Teaching Assistant:</strong> Refine the quiz questions, improve the grading system, and add additional answers.</li>
<li><strong>Deliverable:</strong>  A polished and functional version of your project.</li>
</ul>
</li>
</ol>
<p><strong>Code Examples (Illustrative):</strong></p>
<ul>
<li><strong>Python (Querying Elasticsearch):</strong></li>
</ul>
<pre><code class="lang-python">from elasticsearch <span class="hljs-keyword">import</span> Elasticsearch

es = Elasticsearch([{<span class="hljs-string">'host'</span>: <span class="hljs-string">'localhost'</span>, <span class="hljs-string">'port'</span>: <span class="hljs-number">9200</span>}])

query = {
    <span class="hljs-string">"query"</span>: {
        <span class="hljs-string">"bool"</span>: {
            <span class="hljs-string">"must"</span>: [
                {<span class="hljs-string">"match"</span>: {<span class="hljs-string">"event_id"</span>: <span class="hljs-string">"4625"</span>}} # Example: Failed login attempts
            ]
        }
    }
}

response = es.search(index=<span class="hljs-string">"windows-eventlog-*"</span>, body=query)

<span class="hljs-keyword">for</span> hit <span class="hljs-keyword">in</span> response[<span class="hljs-string">'hits'</span>][<span class="hljs-string">'hits'</span>]:
    print(hit[<span class="hljs-string">'_source'</span>])
</code></pre>
<ul>
<li><strong>Python (Parsing Windows Event Logs with <code>python-evtx</code>):</strong></li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> Evtx.Evtx <span class="hljs-keyword">import</span> Evtx
<span class="hljs-keyword">from</span> Evtx.Views <span class="hljs-keyword">import</span> evtx_file_xml_view

<span class="hljs-keyword">with</span> Evtx(<span class="hljs-string">"security.evtx"</span>) <span class="hljs-keyword">as</span> evtx:
    <span class="hljs-keyword">for</span> record <span class="hljs-keyword">in</span> evtx_file_xml_view(evtx):
        print(record.xml())
</code></pre>
<ul>
<li><strong>Python (Scapy - DNS Analysis):</strong></li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> scapy.all <span class="hljs-keyword">import</span> *

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">analyze_dns</span><span class="hljs-params">(pcap_file)</span>:</span>
    packets = rdpcap(pcap_file)
    <span class="hljs-keyword">for</span> packet <span class="hljs-keyword">in</span> packets:
        <span class="hljs-keyword">if</span> packet.haslayer(DNS):
            dns = packet[DNS]
            <span class="hljs-keyword">if</span> dns.qr == <span class="hljs-number">0</span>:  <span class="hljs-comment"># DNS Query</span>
                domain_name = dns.qd.qname.decode(<span class="hljs-string">'utf-8'</span>)
                print(f<span class="hljs-string">"DNS Query: {domain_name}"</span>)

analyze_dns(<span class="hljs-string">"dns_traffic.pcap"</span>)
</code></pre>
<p><strong>Phase 3: Testing and Documentation (Week 7)</strong></p>
<ol>
<li><p><strong>Testing:</strong></p>
<ul>
<li><strong>Action:</strong> Thoroughly test your project.  Create test cases to cover different scenarios.</li>
<li><strong>Example:</strong>  For the dashboard, test with different data volumes, different browsers, etc.  For the playbook automation, test with different types of malicious activity.  For the tool, test with different PCAP files.</li>
<li><strong>Deliverable:</strong> A list of test cases and their results.</li>
</ul>
</li>
<li><p><strong>Documentation:</strong></p>
<ul>
<li><strong>Action:</strong> Write comprehensive documentation for your project.  This is <em>crucial</em>.  Imagine someone else trying to use your project  what would they need to know?</li>
<li><strong>Include:</strong><ul>
<li>A description of the project and its purpose.</li>
<li>Instructions for installation and configuration.</li>
<li>Instructions for use.</li>
<li>A description of the architecture and design.</li>
<li>A list of dependencies.</li>
<li>Any known limitations or bugs.</li>
<li>Code comments (where applicable).</li>
</ul>
</li>
<li><strong>Deliverable:</strong> A well-written documentation document (e.g., a README file in Markdown).</li>
</ul>
</li>
</ol>
<p><strong>Phase 4: Peer Review and Presentation (Week 8)</strong></p>
<ol>
<li><p><strong>Peer Review (Days 1-3):</strong></p>
<ul>
<li><strong>Action:</strong> Exchange your project with a classmate for review.  Provide constructive feedback.  Be specific.  What did they do well?  What could they improve?</li>
<li><strong>Deliverable:</strong>  A peer review report (1-2 pages) outlining your feedback.</li>
</ul>
</li>
<li><p><strong>Final Revisions (Days 4-5):</strong></p>
<ul>
<li><strong>Action:</strong> Incorporate feedback from the peer review into your project.  Fix any remaining bugs.  Improve the documentation.</li>
<li><strong>Deliverable:</strong> A final, polished version of your project.</li>
</ul>
</li>
<li><p><strong>Presentation (Days 6-7):</strong></p>
<ul>
<li><strong>Action:</strong> Prepare a presentation to showcase your project.</li>
<li><strong>Include:</strong><ul>
<li>A brief overview of the problem you&#39;re solving.</li>
<li>A demonstration of your project.</li>
<li>A discussion of the technologies you used.</li>
<li>A discussion of the challenges you faced and how you overcame them.</li>
<li>A discussion of future improvements.</li>
</ul>
</li>
<li><strong>Deliverable:</strong> A presentation (PowerPoint, Google Slides, etc.).</li>
</ul>
</li>
</ol>
<p><strong>Grading Rubric:</strong></p>
<ul>
<li><strong>Planning (20%):</strong>  Scope definition, technology selection, design, task breakdown, timeline.</li>
<li><strong>Implementation (40%):</strong>  Functionality, code quality, data integration.</li>
<li><strong>Testing and Documentation (20%):</strong>  Thoroughness of testing, clarity of documentation.</li>
<li><strong>Presentation and Peer Review (20%):</strong>  Clarity of presentation, quality of peer review feedback.</li>
</ul>
<p><strong>Key Considerations:</strong></p>
<ul>
<li><strong>Time Management:</strong> Start early and work consistently. Don&#39;t procrastinate!</li>
<li><strong>Scope Creep:</strong> Avoid adding features that are outside the original scope of your project.</li>
<li><strong>Version Control:</strong> Use Git (or a similar version control system) to track your changes.</li>
<li><strong>Collaboration:</strong> If you&#39;re working in a team, communicate effectively and divide tasks fairly.</li>
<li><strong>Ask for Help:</strong> Don&#39;t be afraid to ask for help when you&#39;re stuck.</li>
</ul>
<p>This module is designed to be challenging, but also rewarding. By the end of this course, you&#39;ll have a tangible project that demonstrates your skills and knowledge in cyber threat hunting. Good luck! Let me know if you have any questions. This is an iterative process, so don&#39;t be afraid to experiment, learn, and adapt as you go along. Remember, the journey is just as important as the destination.</p>
<p>This detailed breakdown provides a solid foundation for Module 8. I&#39;ve tried to incorporate my teaching style by providing clear instructions, practical examples, and encouragement.  Remember, the goal is not just to complete the project, but to <em>learn</em> and <em>grow</em> as a threat hunter.</p>
